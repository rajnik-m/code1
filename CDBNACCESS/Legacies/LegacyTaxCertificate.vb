Namespace Access

  Public Class LegacyTaxCertificate
    Inherits CARERecord

#Region "AutoGenerated Code"

    '--------------------------------------------------
    'Enum defining all the fields in the table
    '--------------------------------------------------
    Private Enum LegacyTaxCertificateFields
      AllFields = 0
      LegacyNumber
      TaxYear
      DateReceived
      GrossAmount
      NetAmount
      TaxPercent
      TaxCertificateNumber
      Reference
      TaxClaimed
      TaxReceived
      AmendedBy
      AmendedOn
    End Enum

    '--------------------------------------------------
    'Required overrides for the class
    '--------------------------------------------------
    Protected Overrides Sub AddFields()
      With mvClassFields
        .Add("legacy_number", CDBField.FieldTypes.cftLong)
        .Add("tax_year", CDBField.FieldTypes.cftInteger)
        .Add("date_received", CDBField.FieldTypes.cftDate)
        .Add("gross_amount", CDBField.FieldTypes.cftNumeric)
        .Add("net_amount", CDBField.FieldTypes.cftNumeric)
        .Add("tax_percent", CDBField.FieldTypes.cftLong)
        .Add("tax_certificate_number", CDBField.FieldTypes.cftLong)
        .Add("reference")
        .Add("tax_claimed")
        .Add("tax_received")

        .Item(LegacyTaxCertificateFields.TaxCertificateNumber).PrimaryKey = True

        .SetControlNumberField(LegacyTaxCertificateFields.TaxCertificateNumber, "LT")
      End With
    End Sub

    Protected Overrides ReadOnly Property SupportsAmendedOnAndBy() As Boolean
      Get
        Return True
      End Get
    End Property
    Protected Overrides ReadOnly Property TableAlias() As String
      Get
        Return "ltc"
      End Get
    End Property
    Protected Overrides ReadOnly Property DatabaseTableName() As String
      Get
        Return "legacy_tax_certificates"
      End Get
    End Property

    '--------------------------------------------------
    'Default constructor
    '--------------------------------------------------
    Public Sub New(ByVal pEnv As CDBEnvironment)
      MyBase.New(pEnv)
    End Sub

    '--------------------------------------------------
    'Public property procedures
    '--------------------------------------------------
    Public ReadOnly Property LegacyNumber() As Integer
      Get
        Return mvClassFields(LegacyTaxCertificateFields.LegacyNumber).IntegerValue
      End Get
    End Property
    Public ReadOnly Property TaxYear() As Integer
      Get
        Return mvClassFields(LegacyTaxCertificateFields.TaxYear).IntegerValue
      End Get
    End Property
    Public ReadOnly Property DateReceived() As String
      Get
        Return mvClassFields(LegacyTaxCertificateFields.DateReceived).Value
      End Get
    End Property
    Public ReadOnly Property GrossAmount() As Double
      Get
        Return mvClassFields(LegacyTaxCertificateFields.GrossAmount).DoubleValue
      End Get
    End Property
    Public ReadOnly Property NetAmount() As Double
      Get
        Return mvClassFields(LegacyTaxCertificateFields.NetAmount).DoubleValue
      End Get
    End Property
    Public ReadOnly Property AmendedBy() As String
      Get
        Return mvClassFields(LegacyTaxCertificateFields.AmendedBy).Value
      End Get
    End Property
    Public ReadOnly Property AmendedOn() As String
      Get
        Return mvClassFields(LegacyTaxCertificateFields.AmendedOn).Value
      End Get
    End Property
    Public ReadOnly Property TaxPercent() As Integer
      Get
        Return mvClassFields(LegacyTaxCertificateFields.TaxPercent).IntegerValue
      End Get
    End Property
    Public ReadOnly Property TaxCertificateNumber() As Integer
      Get
        Return mvClassFields(LegacyTaxCertificateFields.TaxCertificateNumber).IntegerValue
      End Get
    End Property
    Public ReadOnly Property Reference() As String
      Get
        Return mvClassFields(LegacyTaxCertificateFields.Reference).Value
      End Get
    End Property
    Public ReadOnly Property TaxClaimed() As String
      Get
        Return mvClassFields(LegacyTaxCertificateFields.TaxClaimed).Value
      End Get
    End Property
    Public ReadOnly Property TaxReceived() As String
      Get
        Return mvClassFields(LegacyTaxCertificateFields.TaxReceived).Value
      End Get
    End Property
#End Region

#Region "Non-AutoGenerated Code"

    Protected Overrides Sub SetDefaults()
      MyBase.SetDefaults()
      mvClassFields(LegacyTaxCertificateFields.TaxClaimed).Value = "N"
      mvClassFields(LegacyTaxCertificateFields.TaxReceived).Value = "N"
    End Sub

    Public Overrides Function GetAddRecordMandatoryParameters() As String
      Return "LegacyNumber"
    End Function

#End Region

  End Class
End Namespace
