Namespace Access


  Public Class Product
    Inherits CARERecord

#Region "AutoGenerated Code"

    '--------------------------------------------------
    'Enum defining all the fields in the table
    '--------------------------------------------------
    Private Enum ProductFields
      AllFields = 0
      Product
      ProductDesc
      Company
      ProductVatCategory
      NominalAccount
      SubsequentNominalAccount
      SalesGroup
      SortGroup
      DespatchMethod
      ExtraKey
      SalesDescription
      SalesQuantity
      HistoryOnly
      Donation
      EligibleForGiftAid
      Subscription
      StockItem
      PackProduct
      Course
      Accommodation
      PostagePacking
      UsesProductNumbers
      SponsorshipEvent
      NextProductNumber
      MaxNumbersAllowed
      CostOfSale
      CostOfSaleAccount
      CostOfSaleAccrual
      Source
      Activity
      ActivityValue
      SecondaryGroup
      ProductCategory
      MinimumQuantity
      MaximumQuantity
      Warehouse
      BinNumber
      Weight
      StartDate
      OriginalCost
      LastStockCount
      WebPublish
      AccruesInterest
      ActivityDurationMonths
      AmendedBy
      AmendedOn
    End Enum

    '--------------------------------------------------
    'Required overrides for the class
    '--------------------------------------------------
    Protected Overrides Sub AddFields()
      With mvClassFields
        .Add("product")
        .Add("product_desc")
        .Add("company")
        .Add("product_vat_category")
        .Add("nominal_account")
        .Add("subsequent_nominal_account")
        .Add("sales_group")
        .Add("sort_group", CDBField.FieldTypes.cftInteger)
        .Add("despatch_method")
        .Add("extra_key")
        .Add("sales_description", CDBField.FieldTypes.cftMemo)
        .Add("sales_quantity", CDBField.FieldTypes.cftInteger)
        .Add("history_only")
        .Add("donation")
        .Add("eligible_for_gift_aid")
        .Add("subscription")
        .Add("stock_item")
        .Add("pack_product")
        .Add("course")
        .Add("accommodation")
        .Add("postage_packing")
        .Add("uses_product_numbers")
        .Add("sponsorship_event")
        .Add("next_product_number", CDBField.FieldTypes.cftLong)
        .Add("max_numbers_allowed", CDBField.FieldTypes.cftInteger)
        .Add("cost_of_sale", CDBField.FieldTypes.cftNumeric)
        .Add("cost_of_sale_account")
        .Add("cost_of_sale_accrual")
        .Add("source")
        .Add("activity")
        .Add("activity_value")
        .Add("secondary_group")
        .Add("product_category")
        .Add("minimum_quantity", CDBField.FieldTypes.cftInteger)
        .Add("maximum_quantity", CDBField.FieldTypes.cftInteger)
        .Add("warehouse")
        .Add("bin_number")
        .Add("weight", CDBField.FieldTypes.cftNumeric)
        .Add("start_date", CDBField.FieldTypes.cftDate)
        .Add("original_cost", CDBField.FieldTypes.cftNumeric)
        .Add("last_stock_count", CDBField.FieldTypes.cftLong)
        .Add("web_publish")
        .Add("accrues_interest").InDatabase = mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbLoans)
        .Add("activity_duration_months", CDBField.FieldTypes.cftInteger).InDatabase = mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbProductActivityDurationMonths)

        .Item(ProductFields.Product).PrimaryKey = True
        .Item(ProductFields.Product).PrefixRequired = True
        .Item(ProductFields.HistoryOnly).PrefixRequired = True
        .Item(ProductFields.EligibleForGiftAid).PrefixRequired = True
        .Item(ProductFields.WebPublish).PrefixRequired = True
        .Item(ProductFields.WebPublish).InDatabase = mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbProductWebPublish)
      End With
    End Sub
    Protected Overrides Sub SetDefaults()
      MyBase.SetDefaults()
      mvClassFields.Item(ProductFields.WebPublish).Value = "N"
    End Sub


    Protected Overrides ReadOnly Property SupportsAmendedOnAndBy() As Boolean
      Get
        Return True
      End Get
    End Property
    Protected Overrides ReadOnly Property TableAlias() As String
      Get
        Return "p"
      End Get
    End Property
    Protected Overrides ReadOnly Property DatabaseTableName() As String
      Get
        Return "products"
      End Get
    End Property
    '--------------------------------------------------
    'Default constructor
    '--------------------------------------------------
    Public Sub New(ByVal pEnv As CDBEnvironment)
      MyBase.New(pEnv)
    End Sub

    '--------------------------------------------------
    'Public property procedures
    '--------------------------------------------------
    Public ReadOnly Property ProductCode() As String
      Get
        Return mvClassFields(ProductFields.Product).Value
      End Get
    End Property
    Public ReadOnly Property ProductDesc() As String
      Get
        Return mvClassFields(ProductFields.ProductDesc).Value
      End Get
    End Property
    Public ReadOnly Property Company() As String
      Get
        Return mvClassFields(ProductFields.Company).Value
      End Get
    End Property
    Public ReadOnly Property ProductVatCategory() As String
      Get
        Return mvClassFields(ProductFields.ProductVatCategory).Value
      End Get
    End Property
    Public ReadOnly Property NominalAccount() As String
      Get
        Return mvClassFields(ProductFields.NominalAccount).Value
      End Get
    End Property
    Public ReadOnly Property SubsequentNominalAccount() As String
      Get
        Return mvClassFields(ProductFields.SubsequentNominalAccount).Value
      End Get
    End Property
    Public ReadOnly Property SalesGroup() As String
      Get
        Return mvClassFields(ProductFields.SalesGroup).Value
      End Get
    End Property
    Public ReadOnly Property SortGroup() As Integer
      Get
        Return mvClassFields(ProductFields.SortGroup).IntegerValue
      End Get
    End Property
    Public ReadOnly Property DespatchMethod() As String
      Get
        Return mvClassFields(ProductFields.DespatchMethod).Value
      End Get
    End Property
    Public ReadOnly Property ExtraKey() As String
      Get
        Return mvClassFields(ProductFields.ExtraKey).Value
      End Get
    End Property
    Public ReadOnly Property SalesDescription() As String
      Get
        Return mvClassFields(ProductFields.SalesDescription).Value
      End Get
    End Property
    Public ReadOnly Property SalesQuantity() As Integer
      Get
        Return mvClassFields(ProductFields.SalesQuantity).IntegerValue
      End Get
    End Property
    Public ReadOnly Property HistoryOnly() As Boolean
      Get
        Return mvClassFields(ProductFields.HistoryOnly).Bool
      End Get
    End Property
    Public ReadOnly Property Donation() As Boolean
      Get
        Return mvClassFields(ProductFields.Donation).Bool
      End Get
    End Property
    Public Property EligibleForGiftAid As Boolean
      Get
        Return Me.ClassFields(ProductFields.EligibleForGiftAid).Bool
      End Get
      Set(value As Boolean)
        Me.ClassFields(ProductFields.EligibleForGiftAid).Bool = value
      End Set
    End Property
    Public ReadOnly Property Subscription() As Boolean
      Get
        Return mvClassFields(ProductFields.Subscription).Bool
      End Get
    End Property
    Public ReadOnly Property StockItem() As Boolean
      Get
        Return mvClassFields(ProductFields.StockItem).Bool
      End Get
    End Property
    Public ReadOnly Property PackProduct() As Boolean
      Get
        Return mvClassFields(ProductFields.PackProduct).Bool
      End Get
    End Property
    Public ReadOnly Property Course() As Boolean
      Get
        Return mvClassFields(ProductFields.Course).Bool
      End Get
    End Property
    Public ReadOnly Property Accommodation() As Boolean
      Get
        Return mvClassFields(ProductFields.Accommodation).Bool
      End Get
    End Property
    Public ReadOnly Property PostagePacking() As Boolean
      Get
        Return mvClassFields(ProductFields.PostagePacking).Bool
      End Get
    End Property
    Public ReadOnly Property UsesProductNumbers() As Boolean
      Get
        Return mvClassFields(ProductFields.UsesProductNumbers).Bool
      End Get
    End Property
    Public ReadOnly Property SponsorshipEvent() As Boolean
      Get
        Return mvClassFields(ProductFields.SponsorshipEvent).Bool
      End Get
    End Property
    Public ReadOnly Property NextProductNumber() As Integer
      Get
        Return mvClassFields(ProductFields.NextProductNumber).IntegerValue
      End Get
    End Property
    Public ReadOnly Property MaxNumbersAllowed() As Integer
      Get
        Return mvClassFields(ProductFields.MaxNumbersAllowed).IntegerValue
      End Get
    End Property
    Public ReadOnly Property CostOfSale() As Double
      Get
        Return mvClassFields(ProductFields.CostOfSale).DoubleValue
      End Get
    End Property
    Public ReadOnly Property CostOfSaleAccount() As String
      Get
        Return mvClassFields(ProductFields.CostOfSaleAccount).Value
      End Get
    End Property
    Public ReadOnly Property CostOfSaleAccrual() As String
      Get
        Return mvClassFields(ProductFields.CostOfSaleAccrual).Value
      End Get
    End Property
    Public ReadOnly Property Source() As String
      Get
        Return mvClassFields(ProductFields.Source).Value
      End Get
    End Property
    Public ReadOnly Property Activity() As String
      Get
        Return mvClassFields(ProductFields.Activity).Value
      End Get
    End Property
    Public ReadOnly Property ActivityValue() As String
      Get
        Return mvClassFields(ProductFields.ActivityValue).Value
      End Get
    End Property
    Public ReadOnly Property SecondaryGroup() As String
      Get
        Return mvClassFields(ProductFields.SecondaryGroup).Value
      End Get
    End Property
    Public ReadOnly Property ProductCategory() As String
      Get
        Return mvClassFields(ProductFields.ProductCategory).Value
      End Get
    End Property
    Public ReadOnly Property MinimumQuantity() As Integer
      Get
        Return mvClassFields(ProductFields.MinimumQuantity).IntegerValue
      End Get
    End Property
    Public ReadOnly Property MaximumQuantity() As Integer
      Get
        Return mvClassFields(ProductFields.MaximumQuantity).IntegerValue
      End Get
    End Property
    Public ReadOnly Property Warehouse() As String
      Get
        Return mvClassFields(ProductFields.Warehouse).Value
      End Get
    End Property
    Public ReadOnly Property BinNumber() As String
      Get
        Return mvClassFields(ProductFields.BinNumber).Value
      End Get
    End Property
    Public ReadOnly Property Weight() As Double
      Get
        Return mvClassFields(ProductFields.Weight).DoubleValue
      End Get
    End Property
    Public ReadOnly Property StartDate() As String
      Get
        Return mvClassFields(ProductFields.StartDate).Value
      End Get
    End Property
    Public ReadOnly Property OriginalCost() As Double
      Get
        Return mvClassFields(ProductFields.OriginalCost).DoubleValue
      End Get
    End Property
    Public Property LastStockCount() As Integer
      Get
        Return mvClassFields(ProductFields.LastStockCount).IntegerValue
      End Get
      Set(ByVal value As Integer)
        mvClassFields(ProductFields.LastStockCount).IntegerValue = value
      End Set
    End Property
    Public ReadOnly Property WebPublish() As Boolean
      Get
        Return mvClassFields(ProductFields.WebPublish).Bool
      End Get
    End Property
    Public ReadOnly Property AccruesInterest() As Boolean
      Get
        Return mvClassFields(ProductFields.AccruesInterest).Bool
      End Get
    End Property
    Public ReadOnly Property AmendedBy() As String
      Get
        Return mvClassFields(ProductFields.AmendedBy).Value
      End Get
    End Property
    Public ReadOnly Property AmendedOn() As String
      Get
        Return mvClassFields(ProductFields.AmendedOn).Value
      End Get
    End Property
    Public ReadOnly Property ActivityDurationMonths() As Integer
      Get
        Return mvClassFields(ProductFields.ActivityDurationMonths).IntegerValue
      End Get
    End Property
   
#End Region

#Region "Non-AutoGenerated Code"

    Public Sub SetNextProductNumber()
      'This will update the NextProductNumbers by the SalesQuantity (or 1)
      Dim vQty As Integer = SalesQuantity
      If vQty < 1 Then vQty = 1
      mvClassFields.Item(ProductFields.NextProductNumber).IntegerValue = NextProductNumber + vQty
    End Sub

#End Region
  End Class
End Namespace
