Namespace Access

  Public Class WebPageUserControl
    Inherits CARERecord

#Region "AutoGenerated Code"

    '--------------------------------------------------
    'Enum defining all the fields in the table
    '--------------------------------------------------
    Private Enum WebPageUserControlFields
      AllFields = 0
      WebPageUserControl
      ControlPath
      ControlTitle
      InitialParameters
      DefaultParameters
      AmendedBy
      AmendedOn
    End Enum

    '--------------------------------------------------
    'Required overrides for the class
    '--------------------------------------------------
    Protected Overrides Sub AddFields()
      With mvClassFields
        .Add("web_page_user_control")
        .Add("control_path")
        .Add("control_title")
        .Add("initial_parameters")
        .Add("default_parameters")

        .Item(WebPageUserControlFields.WebPageUserControl).PrimaryKey = True
      End With
    End Sub

    Protected Overrides ReadOnly Property SupportsAmendedOnAndBy() As Boolean
      Get
        Return True
      End Get
    End Property
    Protected Overrides ReadOnly Property TableAlias() As String
      Get
        Return "wpuc"
      End Get
    End Property
    Protected Overrides ReadOnly Property DatabaseTableName() As String
      Get
        Return "web_page_user_controls"
      End Get
    End Property

    '--------------------------------------------------
    'Default constructor
    '--------------------------------------------------
    Public Sub New(ByVal pEnv As CDBEnvironment)
      MyBase.New(pEnv)
    End Sub

    '--------------------------------------------------
    'Public property procedures
    '--------------------------------------------------
    Public ReadOnly Property WebPageUserControlName() As String
      Get
        Return mvClassFields(WebPageUserControlFields.WebPageUserControl).Value
      End Get
    End Property
    Public ReadOnly Property ControlPath() As String
      Get
        Return mvClassFields(WebPageUserControlFields.ControlPath).Value
      End Get
    End Property
    Public ReadOnly Property ControlTitle() As String
      Get
        Return mvClassFields(WebPageUserControlFields.ControlTitle).Value
      End Get
    End Property
    Public ReadOnly Property InitialParameters() As String
      Get
        Return mvClassFields(WebPageUserControlFields.InitialParameters).Value
      End Get
    End Property
    Public ReadOnly Property DefaultParameters() As String
      Get
        Return mvClassFields(WebPageUserControlFields.DefaultParameters).Value
      End Get
    End Property
    Public ReadOnly Property AmendedBy() As String
      Get
        Return mvClassFields(WebPageUserControlFields.AmendedBy).Value
      End Get
    End Property
    Public ReadOnly Property AmendedOn() As String
      Get
        Return mvClassFields(WebPageUserControlFields.AmendedOn).Value
      End Get
    End Property
#End Region

#Region "Non-AutoGenerated Code"

    Public Enum WebControlTypes As Integer
      wctNone
      wctAddMemberDD
      wctAddNetworkContact
      wctAddNewDefaultAddress
      wctAddPaymentPlanDD
      wctAddSubscriptionDD
      wctBookEventCC
      wctFindLocalGroup
      wctMaintainActivityGroup
      wctMaintainNumbers
      wctMakeDonationCC
      wctModifyDD
      wctProductPurchaseCC
      wctRecordActivity
      wctRecordStandardEmail
      wctRenewMembershipCC
      wctRenewSubscriptionCC
      wctShowMyNetwork
      wctSubmitEnquiry
      wctAddMemberCC
      wctLogin
      wctRegister
      wctForgottenPassword
      wctDisplayAddress
      wctMaintainContact
      wctRapidProductPurchase
      wctAddContact
      wctAddRelatedContact
      wctAddCategory
      wctAddCategoryOptions
      wctAddCategoryCheckboxes
      wctAddCategoryValue
      wctAddSuppression
      wctSubmitAll
      wctContactSelection
      wctDisplayContactData
      wctAddCategoryNotes
      wctAddCommunicationNote
      wctAddAction
      wctFindFundraiser
      wctFundraiserPageInformation
      wctAddFundraisingPage
      wctFundraiserDonations
      wctUpdatePassword
      wctAddLink
      wctAddExternalReference
      wctContactSelectionExternalRef
      wctNavigateButton
      wctAddBankAccount
      wctUpdateContact
      wctUpdateAddress
      wctUpdatePhoneNumber
      wctUpdateEmailAddress
      wctSelectProducts
      wctEventSelectionCalendar
      wctSelectBookingOptions
      wctLogout
      wctSelectEvents
      wctViewTransaction
      wctSelectEventDelegates
      wctSelectOptionSessions
      wctProductPurchase
      wctSelectMembershipTypes
      wctEventDelegateActivities
      wctBookEvent
      wctProcessPayment
      wctShowEventBookings
      wctRegisterMember
      wctRegisterCorporateMember
      wctSelectSurveys
      wctSearchOrganisation
      wctAddOrganisation
      wctUpdatePosition
      wctUpdateOrganisation
      wctSearchDirectory
      wctRegisterCombined
      wctViewDirectoryDetails
      wctSurveyResponses
      wctCPDCycle
      wctDownloadSelection
      wctUpdateCpdPoints
      wctUpdateCpdObjectives
      wctRelatedContacts
      wctRelatedOrganisations
      wctDownloadDocument
      wctEmailSelectedContacts
      wctSearchContact
      wctAddPosition
      wctDisplayTransactions
      wctPrintReceipt
      wctDirectoryPreferences
      wctPayerSelection
      wctDeDupOrgForRegistration
      wctPayMultiplePaymentPlans
      wctAddEvent
      wctSelectExams
      wctBookExam
      wctShowExamBookings
      wctShowExamHistory
      wctSetUserOrganisation
      wctAddMemberCS
      wctSelecttPayPlanForDD
      wctConvertPayPlanToDD
      wctAddMemberCI
      wctInvoicePayment
      wctEventDelegateEntry      
      wctPrintButton
    End Enum

    Public Shared Function PageCodeFromName(ByVal pName As String) As String
      Return PageCodeFromType(ControlTypeFromName(pName))
    End Function

    Public Shared Function ControlTypeFromName(ByVal pName As String) As WebControlTypes
      Select Case pName
        Case "ADDACTION"
          Return WebControlTypes.wctAddAction
        Case "ADDBANKACCOUNT"
          Return WebControlTypes.wctAddBankAccount
        Case "ADDCATEGORY"
          Return WebControlTypes.wctAddCategory
        Case "ADDCATEGORYCHECKBOXES"
          Return WebControlTypes.wctAddCategoryCheckboxes
        Case "ADDCATEGORYNOTES"
          Return WebControlTypes.wctAddCategoryNotes
        Case "ADDCATEGORYOPTIONS"
          Return WebControlTypes.wctAddCategoryOptions
        Case "ADDCATEGORYVALUE"
          Return WebControlTypes.wctAddCategoryValue
        Case "ADDCOMMUNICATIONNOTE"
          Return WebControlTypes.wctAddCommunicationNote
        Case "ADDCONTACT"
          Return WebControlTypes.wctAddContact
        Case "ADDDEFAULTADDRESS"
          Return WebControlTypes.wctAddNewDefaultAddress
        Case "ADDEXTERNALREFERENCE"
          Return WebControlTypes.wctAddExternalReference
        Case "ADDFUNDRAISINGPAGE"
          Return WebControlTypes.wctAddFundraisingPage
        Case "ADDLINK"
          Return WebControlTypes.wctAddLink
        Case "ADDMEMBERDD"
          Return WebControlTypes.wctAddMemberDD
        Case "ADDMEMBERCC"
          Return WebControlTypes.wctAddMemberCC
        Case "ADDNETWORKCONTACT"
          Return WebControlTypes.wctAddNetworkContact
        Case "ADDPAYMENTPLANDD"
          Return WebControlTypes.wctAddPaymentPlanDD
        Case "ADDRELATEDCONTACT"
          Return WebControlTypes.wctAddRelatedContact
        Case "ADDSUBSCRIPTIONDD"
          Return WebControlTypes.wctAddSubscriptionDD
        Case "ADDSUPPRESSION"
          Return WebControlTypes.wctAddSuppression
        Case "BOOKEVENTCC"
          Return WebControlTypes.wctBookEventCC
        Case "CONFIRMREGISTRATION"
          Return WebControlTypes.wctNone
        Case "CONTACTSELECTION"
          Return WebControlTypes.wctContactSelection
        Case "CONTACTSELECTIONEXTERNALREF"
          Return WebControlTypes.wctContactSelectionExternalRef
        Case "DATADISPLAY"
          Return WebControlTypes.wctNone
        Case "DISPLAYCONTACTDATA"
          Return WebControlTypes.wctDisplayContactData
        Case "EMAILPASSWORD"
          Return WebControlTypes.wctForgottenPassword
        Case "EVENTDELEGATEACTIVITIES"
          Return WebControlTypes.wctEventDelegateActivities
        Case "EVENTSELECTION"
          Return WebControlTypes.wctSelectEvents
        Case "EVENTSELECTIONCALENDAR"
          Return WebControlTypes.wctEventSelectionCalendar
        Case "FINDFUNDRAISER"
          Return WebControlTypes.wctFindFundraiser
        Case "FINDLOCALGROUP"
          Return WebControlTypes.wctFindLocalGroup
        Case "FUNDRAISERDONATIONS"
          Return WebControlTypes.wctFundraiserDonations
        Case "FUNDRAISERPAGEINFO"
          Return WebControlTypes.wctFundraiserPageInformation
        Case "LOGIN"
          Return WebControlTypes.wctLogin
        Case "MAINTAINACTIVITYGROUP"
          Return WebControlTypes.wctMaintainActivityGroup
        Case "MAINTAINNUMBERS"
          Return WebControlTypes.wctMaintainNumbers
        Case "MAKEDONATIONCC"
          Return WebControlTypes.wctMakeDonationCC
        Case "MODIFYDD"
          Return WebControlTypes.wctModifyDD
        Case "NAVIGATEBUTTON"
          Return WebControlTypes.wctNavigateButton
        Case "PAYMEMBERSHIPCC"
          Return WebControlTypes.wctRenewMembershipCC
        Case "PAYSUBSCRIPTIONCC"
          Return WebControlTypes.wctRenewSubscriptionCC
        Case "PRODUCTPURCHASE"
          Return WebControlTypes.wctProductPurchase
        Case "PRODUCTPURCHASECC"
          Return WebControlTypes.wctProductPurchaseCC
        Case "RAPIDPRODUCTPURCHASE"
          Return WebControlTypes.wctRapidProductPurchase
        Case "RECORDACTIVITY"
          Return WebControlTypes.wctRecordActivity
        Case "RECORDSTANDARDEMAIL"
          Return WebControlTypes.wctRecordStandardEmail
        Case "REGISTER"
          Return WebControlTypes.wctRegister
        Case "SHOWDEFAULTADDRESS"
          Return WebControlTypes.wctDisplayAddress
        Case "SHOWNETWORK"
          Return WebControlTypes.wctShowMyNetwork
        Case "SUBMITALL"
          Return WebControlTypes.wctSubmitAll
        Case "SUBMITENQUIRY"
          Return WebControlTypes.wctSubmitEnquiry
        Case "UPDATECONTACT"
          Return WebControlTypes.wctUpdateContact
        Case "UPDATEADDRESS"
          Return WebControlTypes.wctUpdateAddress
        Case "UPDATEPASSWORD"
          Return WebControlTypes.wctUpdatePassword
        Case "UPDATEPHONENUMBER"
          Return WebControlTypes.wctUpdatePhoneNumber
        Case "UPDATEEMAILADDRESS"
          Return WebControlTypes.wctUpdateEmailAddress
        Case "PRODUCTSELECTION"
          Return WebControlTypes.wctSelectProducts
        Case "BOOKINGOPTIONSELECTION"
          Return WebControlTypes.wctSelectBookingOptions
        Case "LOGOUT"
          Return WebControlTypes.wctLogout
        Case "VIEWTRANSACTION"
          Return WebControlTypes.wctViewTransaction
        Case "EVENTDELEGATESELECTION"
          Return WebControlTypes.wctSelectEventDelegates
        Case "PICKSESSIONS"
          Return WebControlTypes.wctSelectOptionSessions
        Case "MEMBERSHIPTYPESELECTION"
          Return WebControlTypes.wctSelectMembershipTypes
        Case "BOOKEVENT"
          Return WebControlTypes.wctBookEvent
        Case "PROCESSPAYMENT"
          Return WebControlTypes.wctProcessPayment
        Case "SHOWEVENTBOOKINGS"
          Return WebControlTypes.wctShowEventBookings
        Case "REGISTERMEMBER"
          Return WebControlTypes.wctRegisterMember
        Case "REGISTERCORPORATEMEMBER"
          Return WebControlTypes.wctRegisterCorporateMember
        Case "REGISTERCOMBINED"
          Return WebControlTypes.wctRegisterCombined
        Case "SURVEYSELECTION"
          Return WebControlTypes.wctSelectSurveys
        Case "SEARCHORGANISATION"
          Return WebControlTypes.wctSearchOrganisation
        Case "ADDORGANISATION"
          Return WebControlTypes.wctAddOrganisation
        Case "UPDATEPOSITION"
          Return WebControlTypes.wctUpdatePosition
        Case "UPDATEORGANISATION"
          Return WebControlTypes.wctUpdateOrganisation
        Case "VIEWDIRECTORYDETAILS"
          Return WebControlTypes.wctViewDirectoryDetails
        Case "SEARCHDIRECTORY"
          Return WebControlTypes.wctSearchDirectory
        Case "SURVEYRESPONSES"
          Return WebControlTypes.wctSurveyResponses
        Case "CONTACTCPDCYCLE"
          Return WebControlTypes.wctCPDCycle
        Case "DOWNLOADSELECTION"
          Return WebControlTypes.wctDownloadSelection
        Case "UPDATECPDPOINTS"
          Return WebControlTypes.wctUpdateCpdPoints
        Case "UPDATECPDOBJECTIVES"
          Return WebControlTypes.wctUpdateCpdObjectives
        Case "DISPLAYRELATEDTEDCONTACTS"
          Return WebControlTypes.wctRelatedContacts
        Case "RELATEDORGANISATIONS"
          Return WebControlTypes.wctRelatedOrganisations
        Case "DOWNLOADDOCUMENT"
          Return WebControlTypes.wctDownloadDocument
        Case "EMAILSELECTEDCONTACTS"
          Return WebControlTypes.wctEmailSelectedContacts
        Case "SEARCHCONTACT"
          Return WebControlTypes.wctSearchContact
        Case "ADDPOSITION"
          Return WebControlTypes.wctAddPosition
        Case "DISPLAYTRANSACTIONS"
          Return WebControlTypes.wctDisplayTransactions
        Case "PRINTRECEIPT"
          Return WebControlTypes.wctPrintReceipt
        Case "DIRECTORYPREFERENCES"
          Return WebControlTypes.wctDirectoryPreferences
        Case "PAYERSELECTION"
          Return WebControlTypes.wctPayerSelection
        Case "DEDUPLICATEORGANISATIONS"
          Return WebControlTypes.wctDeDupOrgForRegistration
        Case "ADDEVENT"
          Return WebControlTypes.wctAddEvent
        Case "PAYMULTIPLEPAYMENTPLANS"
          Return WebControlTypes.wctPayMultiplePaymentPlans
        Case "EXAMSELECTION"
          Return WebControlTypes.wctSelectExams
        Case "BOOKEXAM"
          Return WebControlTypes.wctBookExam
        Case "SHOWEXAMBOOKINGS"
          Return WebControlTypes.wctShowExamBookings
        Case "SHOWEXAMHISTORY"
          Return WebControlTypes.wctShowExamHistory
        Case "SETUSERORGANISATION"
          Return WebControlTypes.wctSetUserOrganisation
        Case "ADDMEMBERCS"
          Return WebControlTypes.wctAddMemberCS
        Case "SELECTPAYPLANFORDD"
          Return WebControlTypes.wctSelecttPayPlanForDD
        Case "CONVERTPAYPLANTODD"
          Return WebControlTypes.wctConvertPayPlanToDD
        Case "ADDMEMBERCI"
          Return WebControlTypes.wctAddMemberCI
        Case "INVOICEPAYMENT"
          Return WebControlTypes.wctInvoicePayment
        Case "EVENTDELEGATEENTRY"
          Return WebControlTypes.wctEventDelegateEntry
        Case "PRINTBUTTON"
          Return WebControlTypes.wctPrintButton
        Case Else
          Return WebControlTypes.wctNone
      End Select
    End Function

    Public Shared Function PageCodeFromType(ByVal pType As WebControlTypes) As String
      Select Case pType
        Case WebControlTypes.wctAddAction
          Return "WAAC"
        Case WebControlTypes.wctAddBankAccount
          Return "WABA"
        Case WebControlTypes.wctAddContact
          Return "WADC"
        Case WebControlTypes.wctAddCategory
          Return "WACA"
        Case WebControlTypes.wctAddCategoryValue
          Return "WACV"
        Case WebControlTypes.wctAddCategoryCheckboxes
          Return "WACC"
        Case WebControlTypes.wctAddCategoryOptions
          Return "WACO"
        Case WebControlTypes.wctAddCategoryNotes
          Return "WACN"
        Case WebControlTypes.wctAddCommunicationNote
          Return "WADO"
        Case WebControlTypes.wctAddExternalReference
          Return "WAER"
        Case WebControlTypes.wctAddFundraisingPage
          Return "WFPA"
        Case WebControlTypes.wctAddLink
          Return "WALN"
        Case WebControlTypes.wctAddMemberCC
          Return "WMCC"
        Case WebControlTypes.wctAddMemberDD
          Return "WMDD"
        Case WebControlTypes.wctAddNetworkContact
          Return "WANC"
        Case WebControlTypes.wctAddNewDefaultAddress
          Return "WADA"
        Case WebControlTypes.wctAddPaymentPlanDD
          Return "WPDD"
        Case WebControlTypes.wctAddRelatedContact
          Return "WARC"
        Case WebControlTypes.wctAddSubscriptionDD
          Return "WSDD"
        Case WebControlTypes.wctAddSuppression
          Return "WAMS"
        Case WebControlTypes.wctBookEventCC
          Return "WECC"
        Case WebControlTypes.wctContactSelection
          Return "WCSE"
        Case WebControlTypes.wctContactSelectionExternalRef
          Return "WCSX"
        Case WebControlTypes.wctDisplayAddress
          Return "WDAD"
        Case WebControlTypes.wctDisplayContactData
          Return "WCDD"
        Case WebControlTypes.wctFindFundraiser
          Return "WFUN"
        Case WebControlTypes.wctFindLocalGroup
          Return "WFLG"
        Case WebControlTypes.wctForgottenPassword
          Return "WFPW"
        Case WebControlTypes.wctFundraiserDonations
          Return "WFFD"
        Case WebControlTypes.wctFundraiserPageInformation
          Return "WFPI"
        Case WebControlTypes.wctLogin
          Return "WLOG"
        Case WebControlTypes.wctLogout
          Return "WLGO"
        Case WebControlTypes.wctMaintainActivityGroup
          Return "WMAG"
        Case WebControlTypes.wctMaintainContact
          Return "WMCO"
        Case WebControlTypes.wctMaintainNumbers
          Return "WMNM"
        Case WebControlTypes.wctMakeDonationCC
          Return "WDCC"
        Case WebControlTypes.wctModifyDD
          Return "WUDD"
        Case WebControlTypes.wctNavigateButton
          Return "WNVB"
        Case WebControlTypes.wctProductPurchaseCC
          Return "WPCC"
        Case WebControlTypes.wctProductPurchase
          Return "WPPP"
        Case WebControlTypes.wctRapidProductPurchase
          Return "WRPP"
        Case WebControlTypes.wctRecordActivity
          Return "WRAC"
        Case WebControlTypes.wctRecordStandardEmail
          Return "WRSE"
        Case WebControlTypes.wctRegister
          Return "WREG"
        Case WebControlTypes.wctRenewMembershipCC
          Return "WRMC"
        Case WebControlTypes.wctRenewSubscriptionCC
          Return "WRSC"
        Case WebControlTypes.wctShowMyNetwork
          Return "WSMN"
        Case WebControlTypes.wctSubmitEnquiry
          Return "WENQ"
        Case WebControlTypes.wctSubmitAll
          Return "WSMA"
        Case WebControlTypes.wctUpdateAddress
          Return "WUAD"
        Case WebControlTypes.wctUpdateContact
          Return "WUCO"
        Case WebControlTypes.wctUpdatePassword
          Return "WFUP"
        Case WebControlTypes.wctUpdatePhoneNumber
          Return "WUPN"
        Case WebControlTypes.wctUpdateEmailAddress
          Return "WUEA"
        Case WebControlTypes.wctSelectProducts
          Return "WSPR"
        Case WebControlTypes.wctSelectBookingOptions
          Return "WSBO"
        Case WebControlTypes.wctSelectEvents
          Return "WSEV"
        Case WebControlTypes.wctViewTransaction
          Return "WVTR"
        Case WebControlTypes.wctSelectEventDelegates
          Return "WSED"
        Case WebControlTypes.wctSelectOptionSessions
          Return "WSOS"
        Case WebControlTypes.wctSelectMembershipTypes
          Return "WSMT"
        Case WebControlTypes.wctEventDelegateActivities
          Return "WEDA"
        Case WebControlTypes.wctBookEvent
          Return "WEVB"
        Case WebControlTypes.wctProcessPayment
          Return "WSPP"
        Case WebControlTypes.wctShowEventBookings
          Return "WSEB"
        Case WebControlTypes.wctRegisterMember
          Return "WRME"
        Case WebControlTypes.wctRegisterCorporateMember
          Return "WRCM"
        Case WebControlTypes.wctSelectSurveys
          Return "WSSV"
        Case WebControlTypes.wctSearchOrganisation
          Return "WSOG"
        Case WebControlTypes.wctAddOrganisation
          Return "WSAO"
        Case WebControlTypes.wctUpdatePosition
          Return "WUUP"
        Case WebControlTypes.wctUpdateOrganisation
          Return "WUPO"
        Case WebControlTypes.wctSearchDirectory
          Return "WSDI"
        Case WebControlTypes.wctRegisterCombined
          Return "WRCO"
        Case WebControlTypes.wctViewDirectoryDetails
          Return "WVDD"
        Case WebControlTypes.wctSurveyResponses
          Return "WSSR"
        Case WebControlTypes.wctCPDCycle
          Return "WSCC"
        Case WebControlTypes.wctDownloadSelection
          Return "WDLS"
        Case WebControlTypes.wctUpdateCpdPoints
          Return "WUCP"
        Case WebControlTypes.wctUpdateCpdObjectives
          Return "WACP"
        Case WebControlTypes.wctRelatedContacts
          Return "WRCN"
        Case WebControlTypes.wctRelatedOrganisations
          Return "WROG"
        Case WebControlTypes.wctDownloadDocument
          Return "WDLD"
        Case WebControlTypes.wctSearchContact
          Return "WSCO"
        Case WebControlTypes.wctEmailSelectedContacts
          Return "WEMS"
        Case WebControlTypes.wctAddPosition
          Return "WADP"
        Case WebControlTypes.wctDisplayTransactions
          Return "WADT"
        Case WebControlTypes.wctPrintReceipt
          Return "WAPR"
        Case WebControlTypes.wctDirectoryPreferences
          Return "WDIP"
        Case WebControlTypes.wctPayerSelection
          Return "WPPS"
        Case WebControlTypes.wctDeDupOrgForRegistration
          Return "WDOR"
        Case WebControlTypes.wctAddEvent
          Return "WADE"
        Case WebControlTypes.wctPayMultiplePaymentPlans
          Return "WPMP"
        Case WebControlTypes.wctSelectExams
          Return "WPSX"
        Case WebControlTypes.wctBookExam
          Return "WPBX"
        Case WebControlTypes.wctShowExamBookings
          Return "WSXB"
        Case WebControlTypes.wctShowExamHistory
          Return "WSXH"
        Case WebControlTypes.wctSetUserOrganisation
          Return "WSUO"
        Case WebControlTypes.wctAddMemberCS
          Return "WMCS"
        Case WebControlTypes.wctSelecttPayPlanForDD
          Return "WCSD"
        Case WebControlTypes.wctConvertPayPlanToDD
          Return "WCPD"
        Case WebControlTypes.wctAddMemberCI
          Return "WMCI"
        Case WebControlTypes.wctInvoicePayment
          Return "WINV"
        Case WebControlTypes.wctEventDelegateEntry
          Return "WEDE"        
        Case WebControlTypes.wctPrintButton
          Return "WPBT"
        Case Else
          Return ""
      End Select
    End Function

    Public Shared Sub CheckWebControls(pEnv As CDBEnvironment)
      Dim vSQL As New SQLStatement(pEnv.Connection, "web_page_user_control,control_title,initial_parameters,default_parameters", "web_page_user_controls", New CDBFields, "control_title")
      Dim vTable As DataTable = vSQL.GetDataTable
      Dim vUpdate As Boolean

      If vTable Is Nothing OrElse vTable.Rows.Count = 0 Then
        vUpdate = True
      Else
        Dim vColumns() As DataColumn = {vTable.Columns("web_page_user_control")}
        vTable.PrimaryKey = vColumns
        Dim vRow As DataRow = vTable.Rows.Find("PROCESSPAYMENT")
        If vRow Is Nothing Then
          vUpdate = True
        Else
          vUpdate = Not vRow("default_parameters").ToString.Contains("CV2Optional")
        End If
      End If
      If vUpdate Then
        Dim vValues As String(,) = { _
          {"ADDACTION", "Controls\AddAction.ascx", "Add Action", "ActionPriority,DocumentClass,DurationDays,DurationHours,DurationMinutes,Topic,TopicLookupGroup,UserLookupGroup", ""}, _
          {"ADDBANKACCOUNT", "Controls\AddBankAccount.ascx", "Add Bank Account", "", ""}, _
          {"ADDCATEGORY", "Controls\AddCategory.ascx", "Add Category", "Activity", "Source,SetHistoric,SetValidFromDate,SetValidToDate,ShowActivitiesSuppressionsThatExists"}, _
          {"ADDCATEGORYCHECKBOXES", "Controls\AddCategoryCheckboxes.ascx", "Add Category Checkboxes", "CheckBoxMandatory", "Activity,Source,SetHistoric,SetValidFromDate,SetValidToDate,ShowActivitiesSuppressionsThatExists"}, _
          {"ADDCATEGORYNOTES", "Controls\AddCategoryNotes.ascx", "Add Category Notes", "", "Activity,Source,SetHistoric,SetValidFromDate,SetValidToDate,ShowActivitiesSuppressionsThatExists"}, _
          {"ADDCATEGORYOPTIONS", "Controls\AddCategoryOptions.ascx", "Add Category Options", "", "Activity,Source,SetHistoric,SetValidFromDate,SetValidToDate,ShowActivitiesSuppressionsThatExists"}, _
          {"ADDCATEGORYVALUE", "Controls\AddCategoryValue.ascx", "Add Category Value", "", "Activity,ActivityValue,Source,NotesMandatory,SetHistoric,SetValidFromDate,SetValidToDate,ShowActivitiesSuppressionsThatExists"}, _
          {"ADDCOMMUNICATIONNOTE", "Controls\AddCommunicationNote.ascx", "Add Communication Note", "Direction", "DocumentType,DocumentClass,Topic,SubTopic,DefaultTopicSubTopic"}, _
          {"ADDCONTACT", "Controls\AddContact.ascx", "Add Contact", "TitleLookupGroup,Device1,Device2,Device3", "Source,SetHistoric"}, _
          {"ADDDEFAULTADDRESS", "Controls\AddDefaultAddress.ascx", "Add New Default Address", "", ""}, _
          {"ADDEXTERNALREFERENCE", "Controls\AddExternalReference.ascx", "Add External Reference", "", "DataSource,DisplayFirstRecord,AllowMaintenance"}, _
          {"ADDFUNDRAISINGPAGE", "Controls\AddFundraisingPage.ascx", "Add Fundraising Page", "TemplatePage,Topic,SubTopic", "Source"}, _
          {"ADDLINK", "Controls\AddLink.ascx", "Add Link", "LinkType,UserLookupGroup,Activity", "Relationship,UseCurrentDate,SetHistoric"}, _
          {"ADDMEMBERCC", "Controls\AddMemberCC.ascx", "Add Member (CC)", "MembershipType,TitleLookupGroup,OnlineCCAuthorisation,MembershipFor", "Branch,BankAccount,PaymentFrequency,Source,ReasonForDespatch,SetCardExpiry,BatchCategory"}, _
          {"ADDMEMBERCS", "Controls\AddMemberCS.ascx", "Add Member (CS)", "MembershipType,TitleLookupGroup,CreateInvoice", "Branch,BankAccount,PaymentFrequency,Source,ReasonForDespatch,CreditCategory,Company"}, _
          {"ADDMEMBERCI", "Controls\AddMemberCI.ascx", "Add Member (CI)", "MembershipType,TitleLookupGroup,OnlineCCAuthorisation,MembershipFor", "Branch,BankAccount,PaymentFrequency,Source,ReasonForDespatch,SetCardExpiry,BatchCategory"}, _
          {"ADDMEMBERDD", "Controls\AddMemberDD.ascx", "Add Member (DD)", "MembershipType,TitleLookupGroup", "Branch,BankAccount,PaymentFrequency,Source,ReasonForDespatch,SetCardExpiry"}, _
          {"ADDNETWORKCONTACT", "Controls\AddNetworkContact.ascx", "Add Network Contact", "TitleLookupGroup", "Relationship,MailingSuppression,Source"}, _
          {"ADDORGANISATION", "Controls\AddOrganisation.ascx", "Add Organisation", "", "Source"}, _
          {"ADDPAYMENTPLANDD", "Controls\AddPaymentPlanDD.ascx", "Add Payment Plan (DD)", "Product,Rate,TitleLookupGroup", "BankAccount,PaymentFrequency,Source,ReasonForDespatch"}, _
          {"ADDPOSITION", "Controls\AddPosition.ascx", "Add Position", "Position,PositionFunction,PositionSeniority", ""}, _
          {"ADDRELATEDCONTACT", "Controls\AddRelatedContact.ascx", "Add Related Contact", "TitleLookupGroup,RelationshipLookupGroup,DefaultRelationship,Device1,Device2,Device3", "Source,SetHistoric,HideHistoricLinks"}, _
          {"ADDSUBSCRIPTIONDD", "Controls\AddSubscriptionDD.ascx", "Add Subscription (DD)", "Product,Rate,TitleLookupGroup", "BankAccount,PaymentFrequency,Source,ReasonForDespatch"}, _
          {"ADDSUPPRESSION", "Controls\AddSuppression.ascx", "Add Suppression", "", "Suppression,Source,SetHistoric,SetValidFromDate,SetValidToDate,ShowActivitiesSuppressionsThatExists"}, _
          {"BOOKEVENT", "Controls\BookEvent.ascx", "Book Event", "EventNumber,OptionNumber,Rate,SessionList,TitleLookupGroup", "BankAccount,Source,DistributionCode,UseSourceFromEvent"}, _
          {"BOOKEVENTCC", "Controls\BookEventCC.ascx", "Book Event (CC)", "EventNumber,OptionNumber,TitleLookupGroup,OnlineCCAuthorisation", "BankAccount,Source,DistributionCode,BatchCategory,UseSourceFromEvent"}, _
          {"BOOKEXAM", "Controls\BookExam.ascx", "Book Exam", "ExamSessionCode,ExamUnitId,ExamCentreCode,TitleLookupGroup", "BankAccount,Source,DistributionCode"}, _
          {"BOOKINGOPTIONSELECTION", "Controls\BookingOptionSelection.ascx", "Booking Option Selection", "EventNumber,BookingPage,DisplayFormat,HyperlinkFormat,HyperlinkText", ""}, _
          {"CONFIRMREGISTRATION", "Controls\ConfirmRegistration.ascx", "Confirm Registration", "", ""}, _
          {"CONTACTSELECTION", "Controls\ContactSelection.ascx", "Contact Selection", "", ""}, _
          {"CONTACTSELECTIONEXTERNALREF", "Controls\ContactSelectionExternalRef.ascx", "Contact Selection External Reference", "DataSource", ""}, _
          {"CONTACTCPDCYCLE", "Controls\ContactCPDCycle.ascx", "Update CPD Cycles", "CPDPointPage,CPDObjectivePage,AllowEditing,HyperlinkText,ShowGridWithFields,GridHyperlinkText", ""}, _
          {"CONVERTPAYPLANTODD", "Controls\ConvertPayPlanToDD.ascx", "Convert Payment Plan to DD", "", "BankAccount,Source"}, _
          {"DATADISPLAY", "Controls\DataDisplay.ascx", "Content Display", "", ""}, _
          {"DEDUPLICATEORGANISATIONS", "Controls\DeDupOrgForRegistration.ascx", "DeDuplicate Organisations", "MaximumOrganisations", "ReturnToRegisterPage"}, _
          {"DISPLAYCONTACTDATA", "Controls\DisplayContactData.ascx", "Display Contact Data", "DataSelectionType,DataFilter", ""}, _
          {"DISPLAYRELATEDTEDCONTACTS", "Controls\DisplayRelatedContacts.ascx", "Display Related Contacts", "ContactsView,AccessView,UpdateView,EditRelatedContactPage,MoveRelatedContactPage,SendEmailPage,MailMergePage,DataExportPage,SetDefaultPage", ""}, _
          {"DISPLAYRELATEDTEDORGANISATIONS", "Controls\DisplayRelatedOrganisations.ascx", "Display Related Organisations", "ItemsPerPage,DisplayFormat,HyperlinkFormat,HyperlinkText1,HyperlinkText2,ShowChildren,ManageRelatedOrganisationPage", ""}, _
          {"DISPLAYTRANSACTIONS", "Controls\DisplayTransactions.ascx", "Display Transactions", "PrintReceiptPage,HyperlinkFormat,HyperlinkText,PaymentMethod,BatchCategory", ""}, _
          {"DOWNLOADDOCUMENT", "Controls\DownloadDocument.ascx", "Download Document", "", ""}, _
          {"DOWNLOADSELECTION", "Controls\DownloadSelection.ascx", "Download Selection", "ItemsPerPage,DisplayFormat,HyperlinkFormat,HyperlinkText,Topic,DownloadPage", ""}, _
          {"EMAILPASSWORD", "Controls\EmailPassword.ascx", "EMail Password", "", "StandardDocument,EMailAddress,Name,ResetPasswordPage"}, _
          {"EVENTDELEGATEACTIVITIES", "Controls\EventDelegateActivities.ascx", "Event Delegate Activities", "BookingNumber", ""}, _
          {"EVENTDELEGATEENTRY", "Controls\EventDelegateEntry.ascx", "Event Delegate Entry", "BookingNumber,TitleLookupGroup,AllDelegatesMandatory,DeDuplicate,AddDelegatePosition", "Source"}, _
          {"EVENTDELEGATESELECTION", "Controls\EventDelegateSelection.ascx", "Event Delegate Selection", "BookingNumber,TitleLookupGroup", "Source"}, _
          {"EMAILSELECTEDCONTACTS", "Controls\EmailSelectedContacts.ascx", "Email Selected Contacts", "HyperlinkText", ""}, _
          {"EVENTSELECTION", "Controls\EventSelection.ascx", "Event Selection", "ItemsPerPage,Topic,BookingPage,DisplayFormat,HyperlinkFormat,HyperlinkText", ""}, _
          {"EVENTSELECTIONCALENDAR", "Controls\EventSelectionCalendar.ascx", "Event Selection Calendar", "Topic,BookingPage", ""}, _
          {"EXAMSELECTION", "Controls\ExamSelection.ascx", "Exam Selection", "ItemsPerPage,Subject,SkillLevel,ExamSessionCode,ExamCentreCode,BookingPage,DisplayFormat,HyperlinkFormat,HyperlinkText", ""}, _
          {"FINDFUNDRAISER", "Controls\FindFundraiser.ascx", "Find Fundraiser", "", ""}, _
          {"FINDLOCALGROUP", "Controls\FindLocalGroup.ascx", "Find Local Group", "", ""}, _
          {"FUNDRAISERDONATIONS", "Controls\FundraiserDonations.ascx", "Fundraiser Donations", "", ""}, _
          {"FUNDRAISERPAGEINFO", "Controls\FundraiserPageInformation.ascx", "Fundraiser Page Info", "", ""}, _
          {"INVOICEPAYMENT", "Controls\InvoicePayment.ascx", "Invoice Payment", "Company", "BankAccount,Source,DistributionCode"}, _
          {"LOGIN", "Controls\Login.ascx", "Login", "", ""}, _
          {"LOGOUT", "Controls\Logout.ascx", "Logout", "", ""}, _
          {"MAINTAINACTIVITYGROUP", "Controls\MaintainActivityGroup.ascx", "Maintain Activity Group", "ActivityGroup,UseNewContact", "Source"}, _
          {"MAINTAINNUMBERS", "Controls\MaintainNumbers.ascx", "Maintain Comms Numbers", "", ""}, _
          {"MAKEDONATIONCC", "Controls\MakeDonationCC.ascx", "Make Donation (CC)", "Product,Rate,TitleLookupGroup,OnlineCCAuthorisation", "BankAccount,Source,DistributionCode,StandardDocument,EMailAddress,Name,BatchCategory"}, _
          {"MEMBERSHIPTYPESELECTION", "Controls\MembershipTypeSelection.ascx", "Membership Type Selection", "ItemsPerPage,LookupGroup,DirectDebitSalePage,CreditCardSalePage,DisplayFormat,HyperlinkFormat,HyperlinkText1,HyperlinkText2", ""}, _
          {"MODIFYDD", "Controls\ModifyDD.ascx", "Add Direct Debit Amount", "Product,Rate", "Source,DistributionCode"}, _
          {"NAVIGATEBUTTON", "Controls\NavigateButton.ascx", "Navigate Button", "HyperlinkFormat,AccessView", ""}, _
          {"PAYMULTIPLEPAYMENTPLANS", "Controls\PayMultiplePaymentPlans.ascx", "Pay Multiple Payment Plans", "BankAccount,Source,DisplayFormat,MembershipFor", ""}, _
          {"PAYERSELECTION", "Controls\PayerSelection.ascx", "Payer Selection", "BypassIfOneAddress", ""}, _
          {"PAYMEMBERSHIPCC", "Controls\PayMembershipCC.ascx", "Pay Membership (CC)", "OnlineCCAuthorisation", "BankAccount,Source,BatchCategory"}, _
          {"PAYSUBSCRIPTIONCC", "Controls\PaySubscriptionCC.ascx", "Pay Subscription (CC)", "OnlineCCAuthorisation", "BankAccount,Source,BatchCategory"}, _
          {"PICKSESSIONS", "Controls\OptionSessionSelection.ascx", "Pick Sessions", "EventNumber,OptionNumber", ""}, _
          {"PRINTRECEIPT", "Controls\ViewReceiptDetails.ascx", "Display Receipt", "", ""}, _
          {"PRINTBUTTON", "Controls\PrintButton.ascx", "Print Button", "", ""}, _
          {"PRODUCTPURCHASE", "Controls\ProductPurchase.ascx", "Product Purchase", "Product,Rate,TitleLookupGroup", "BankAccount,Source,DistributionCode"}, _
          {"PRODUCTPURCHASECC", "Controls\ProductPurchaseCC.ascx", "Product Purchase (CC)", "Product,Rate,TitleLookupGroup,OnlineCCAuthorisation", "BankAccount,Source,DistributionCode,BatchCategory"}, _
          {"PRODUCTSELECTION", "Controls\ProductSelection.ascx", "Product Selection", "ItemsPerPage,SalesGroup,SecondaryGroup,ProductCategory,ProductSalePage,DisplayFormat,HyperlinkFormat,HyperlinkText", ""}, _
          {"RAPIDPRODUCTPURCHASE", "Controls\RapidProductPurchase.ascx", "Rapid Product Purchase", "Product,Rate,OnlineCCAuthorisation", "BankAccount,Source,DonationProduct,DonationRate,PartSource,DataSource"}, _
          {"RECORDACTIVITY", "Controls\RecordActivity.ascx", "Record Activity", "Activity", "Source"}, _
          {"RECORDSTANDARDEMAIL", "Controls\RecordStandardEmail.ascx", "Record Standard Email", "StandardDocument,EMailAddress", "SendEMail,TestEMailAddress,Source"}, _
          {"REGISTER", "Controls\Register.ascx", "Register", "TitleLookupGroup,EmailAddressIsUserName", "ConfirmationRequired,DeDuplicate,Source,Status,StandardDocument,ConfirmationPage,EMailAddress,Name,DeDuplicateOrganisationPage"}, _
          {"REGISTERCOMBINED", "Controls\RegisterCombined.ascx", "Combined Registration", "", "RegistrationType,StandardDocument,EMailAddress,Name,RegisterPageNumber,RegisterAtOrgPageNumber"}, _
          {"REGISTERCORPORATEMEMBER", "Controls\RegisterCorporateMember.ascx", "Register Corporate Member", "", "StandardDocument,EMailAddress,Name,RegisterPageNumber"}, _
          {"REGISTERMEMBER", "Controls\RegisterMember.ascx", "Register Member", "", "StandardDocument,EMailAddress,Name"}, _
          {"SEARCHCONTACT", "Controls\SearchContact.ascx", "Search Contact", "TitleLookupGroup,MaximumContacts,NewContactPageNumber,HyperlinkText,ShowGridWithFields,GridHyperlinkText", ""}, _
          {"SEARCHDIRECTORY", "Controls\SearchDirectory.ascx", "Search Directory", "DirectoryName,DirectoryDetailsPageNumber,MaximumRecords,ItemsPerPage,DisplayFormat,HyperlinkFormat,HyperlinkText,ContactType,ShowGridWithFields,GridHyperlinkText", "Activity1,ItemSelectType1,Activity2,ItemSelectType2,Activity3,ItemSelectType3,Activity4,ItemSelectType4,Activity5,ItemSelectType5,Activity6,ItemSelectType6"}, _
          {"SEARCHORGANISATION", "Controls\SearchOrganisation.ascx", "Search Organisation", "IncludeMemberOrganisations,MaximumOrganisations,NewOrganisationPageNumber,ShowGridWithFields,GridHyperlinkText", ""}, _
          {"SELECTPAYPLANFORDD", "Controls\SelectPayPlanForDD.ascx", "Select Payment Plan for DD", "HyperlinkText", ""}, _
          {"SHOWDEFAULTADDRESS", "Controls\ShowDefaultAddress.ascx", "Show Default Address", "", ""}, _
          {"SHOWEVENTBOOKINGS", "Controls\ShowEventBookings.ascx", "Show Event Bookings", "DelegateSelectionPage", ""}, _
          {"SHOWEXAMBOOKINGS", "Controls\ShowExamBookings.ascx", "Show Exam Bookings", "", ""}, _
          {"SHOWEXAMHISTORY", "Controls\ShowExamHistory.ascx", "Show Exam History", "", ""}, _
          {"SHOWNETWORK", "Controls\ShowNetwork.ascx", "Show Network", "Relationship", ""}, _
          {"SUBMITALL", "Controls\SubmitAll.ascx", "Submit All", "", ""}, _
          {"SUBMITENQUIRY", "Controls\SubmitEnquiry.ascx", "Submit Enquiry", "", "ContactNumber,AddressNumber,DocumentType,DocumentClass,Topic,SubTopic,Source"}, _
          {"SURVEYRESPONSES", "Controls\SurveyResponses.ascx", "Survey Responses", "SurveyVersionNumber", ""}, _
          {"SURVEYSELECTION", "Controls\SurveySelection.ascx", "Survey Selection", "SurveyType,RegisteredSurveyType,SurveyEntryPage", ""}, _
          {"UPDATEADDRESS", "Controls\UpdateAddress.ascx", "Update Address", "HideHistoricalAddresses,ShowGridWithFields,GridHyperlinkText,HyperlinkText1,HyperlinkText2", ""}, _
          {"UPDATECONTACT", "Controls\UpdateContact.ascx", "Update Contact", "TitleLookupGroup", ""}, _
          {"UPDATECPDPOINTS", "Controls\UpdateCpdPoints.ascx", "Update CPD Points", "AllowEditing,HyperlinkText,ShowGridWithFields,GridHyperlinkText", ""}, _
          {"UPDATECPDOBJECTIVES", "Controls\UpdateCpdObjectives.ascx", "Update CPD Objectives", "AllowEditing,HyperlinkText,ShowGridWithFields,GridHyperlinkText", ""}, _
          {"UPDATEORGANISATION", "Controls\UpdateOrganisation.ascx", "Update Organisation", "", ""}, _
          {"UPDATEPHONENUMBER", "Controls\UpdateTelephoneNumber.ascx", "Update PhoneNumber", "HideHistoricalPhoneFax,DeviceLookupGroup,ShowGridWithFields,GridHyperlinkText,HyperlinkText1,HyperlinkText2", ""}, _
          {"UPDATEPOSITION", "Controls\UpdatePosition.ascx", "Update Position", "OrganisationGroup,HideHistoricalPositions,NewPositionPage,HyperlinkFormat,HyperlinkText,ShowGridWithFields,GridHyperlinkText", ""}, _
          {"UPDATEEMAILADDRESS", "Controls\UpdateEmailAddress.ascx", "Update EmailAddress", "HideHistoricalEmailWebAddresses,DeviceLookupGroup,ShowGridWithFields,GridHyperlinkText,HyperlinkText1,HyperlinkText2", ""}, _
          {"UPDATEPASSWORD", "Controls\UpdatePassword.ascx", "Update Password", "", ""}, _
          {"VIEWTRANSACTION", "Controls\ViewTransaction.ascx", "View Transaction", "DisplayFormat,HyperlinkFormat,HyperlinkText1,HyperlinkText2,ProductUpdatePage", ""}, _
          {"PROCESSPAYMENT", "Controls\ProcessPayment.ascx", "Process Payment", "PaymentType,PaymentService,BookingDocument,DelegateDocument,PayerDocument,Company", "EMailAddress,Name,CreateCreditCustomer,CreditCategory,BatchCategory,CV2Optional"}, _
          {"VIEWDIRECTORYDETAILS", "Controls\ViewDirectoryDetails.ascx", "Display Directory Entry", "DirectoryName,ContactNumber,AddressUsage,CommunicationUsage1,CommunicationUsage2,CommunicationUsage3,CommunicationUsage4,Activity1,Activity2,Activity3,Activity4,Activity5,Activity6", ""}, _
          {"DIRECTORYPREFERENCES", "Controls\UpdateDirectoryPreferences.ascx", "Directory Entry Preferences", "AddressUsage,CommunicationUsage1,Device1,Device2,CommunicationUsage2,Device3,Device4,CommunicationUsage3,Device5,Device6,CommunicationUsage4,Device7,Device8", ""}, _
          {"SETUSERORGANISATION", "Controls\SetUserOrganisation.ascx", "Set User Organisation", "", ""}
          }

        Dim vFields As String() = {"WebPageUserControl", "ControlPath", "ControlTitle", "InitialParameters", "DefaultParameters"}

        For vIndex As Integer = 0 To vValues.GetLength(0) - 1
          Dim vParams As New CDBParameters
          For vItem As Integer = 0 To vValues.GetLength(1) - 1
            Debug.Print(vValues(vIndex, vItem))
            vParams.Add(vFields(vItem), vValues(vIndex, vItem))
          Next
          Dim vWPUC As New WebPageUserControl(pEnv)
          vWPUC.Init(vParams("WebPageUserControl").Value)
          If vWPUC.Existing = False Then
            vWPUC.Create(vParams)
          Else
            vWPUC.Update(vParams)
          End If
          vWPUC.Save(pEnv.User.UserID, True)
        Next
      End If

      'Now setup a portal for processing credit card payments from the back office
      Dim vWebControl As New WebControl(pEnv)
      vWebControl.Init(999)
      If Not vWebControl.Existing Then
        pEnv.Connection.StartTransaction()
        'Create the WEB
        Dim vParams As New CDBParameters
        vParams.Add("WebNumber", 999)
        vParams.Add("WebName", "PaymentPortal")
        vParams.Add("WebUrl", "//localhost/PaymentPortal")
        vWebControl.Create(vParams)
        vWebControl.Save(pEnv.User.UserID)

        'Create the Web page,WEB Page Item and link for Display Data page required by TNS 
        Dim vWP As WebPage = CreateWebPage("Display Data", pEnv, vWebControl.AllocateNextNumber(WebControl.WebNumberFields.wnfPageNumber))
        Dim vWebPageItemParams As CDBParameters = CreateWebPageItem(vWP, pEnv, False)
        CreateWebPageItemLink(vWP, pEnv, vWebPageItemParams)

        'Create the Web page,WEB Page Item and link for Process Payment page
        vWP = CreateWebPage("Process Payment", pEnv, vWebControl.AllocateNextNumber(WebControl.WebNumberFields.wnfPageNumber))
        vWebPageItemParams = CreateWebPageItem(vWP, pEnv, True, vWebPageItemParams("WebPageItemNumber").IntegerValue)
        CreateWebPageItemLink(vWP, pEnv, vWebPageItemParams)

        pEnv.Connection.CommitTransaction()
      End If
    End Sub
    
    ''' <summary>
    ''' Creates web page required for TNS
    ''' </summary>
    ''' <param name="pPageName">Page Name </param>
    ''' <param name="pEnv">Environment</param>
    ''' <param name="pPageNumber">Page Number</param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Shared Function CreateWebPage(ByVal pPageName As String, ByVal pEnv As CDBEnvironment, ByVal pPageNumber As Integer) As WebPage
      Dim vWP As New WebPage(pEnv)
      Dim vParams As New CDBParameters
      vParams.Add("WebPageName", pPageName) '"Process Payment")
      vParams.Add("WebPageTitle", pPageName) '"Process Payment")
      vParams.Add("PageReviewed", "Y")
      vParams.Add("PagePublished", "Y")
      vWP.Create(vParams, pPageNumber)
      vWP.Save(pEnv.User.UserID, True)
      Return vWP
    End Function

    ''' <summary>
    ''' Creates web page item entry required to setup default TNS page
    ''' </summary>
    ''' <param name="pWP"></param>
    ''' <param name="pEnv"></param>
    ''' <remarks></remarks>
    Private Shared Function CreateWebPageItem(ByVal pWP As WebPage, ByVal pEnv As CDBEnvironment, ByVal pProcessPayment As Boolean) As CDBParameters
      Return CreateWebPageItem(pWP, pEnv, pProcessPayment, 0)
    End Function

    ''' <summary>
    ''' Creates web page item entry required to setup default TNS page
    ''' </summary>
    ''' <param name="pWP">Web Page object</param>
    ''' <param name="pEnv">environment</param>
    ''' <param name="pProcessPayment">flag to check of this is called to create process payment page or display content page</param>
    ''' <param name="SubmitPage">submit page for process payment page</param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Shared Function CreateWebPageItem(ByVal pWP As WebPage, ByVal pEnv As CDBEnvironment, ByVal pProcessPayment As Boolean, ByVal SubmitPage As Integer) As CDBParameters
      Dim vWPI As New WebPageItem(pEnv)
      Dim vParams As New CDBParameters
      vParams.Add("WebPageNumber", pWP.WebPageNumber)
      If pProcessPayment Then
        vParams.Add("WebPageItemName", "Payment Module")
        vParams.Add("WebPageUserControl", "PROCESSPAYMENT")
        vParams.Add("InitialParameters", "Company=CO1,PaymentService=TNSHOSTED,PaymentType=CC")
        vParams.Add("DefaultParameters", "CreateCreditCustomer=N,EMailAddress=payments@advancednfp.com,Name=Payment Manager")
      Else
        vParams.Add("WebPageItemName", "Display Content")
        vParams.Add("WebPageUserControl", "DATADISPLAY")
        vParams.Add("InitialParameters", "")
        vParams.Add("DefaultParameters", "")
      End If
      vParams.Add("WebPageItemType", "C")
      vParams.Add("SequenceNumber", "1")
      If SubmitPage > 0 Then vParams.Add("SubmitItemNumber", SubmitPage)
      vWPI.Create(vParams, pWP.GetNextItemNumber)
      vWPI.Save(pEnv.User.UserID, True)
      vParams.Add("WebPageItemNumber", vWPI.WebPageItemNumber)
      Return vParams
    End Function

    ''' <summary>
    '''  Creates web page item link entry 
    ''' </summary>
    ''' <param name="pWP">Web page object</param>
    ''' <param name="pEnv">Environment</param>
    ''' <param name="pParams">Params</param>
    ''' <remarks></remarks>
    Private Shared Sub CreateWebPageItemLink(ByVal pWP As WebPage, ByVal pEnv As CDBEnvironment, ByVal pParams As CDBParameters)
      Dim vWPIL As New WebPageItemLink(pEnv)
      vWPIL.Create(pParams, pWP.GetNextItemLinkNumber)
      vWPIL.Save(pEnv.User.UserID, True)
    End Sub
#End Region

  End Class
End Namespace
