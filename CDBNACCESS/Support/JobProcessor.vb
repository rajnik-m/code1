Namespace Access

  Public Class JobProcessor
    Inherits CARERecord

#Region "AutoGenerated Code"

'--------------------------------------------------
'Enum defining all the fields in the table
'--------------------------------------------------
    Private Enum JobProcessorFields
      AllFields = 0
      JobProcessor
      Started
      Status
      MaxConcurrentJobs
      PollingInterval
      LastPolled
    End Enum

'--------------------------------------------------
'Required overrides for the class
'--------------------------------------------------
    Protected Overrides Sub AddFields()
      With mvClassFields
        .Add("job_processor")
        .Add("started", CDBField.FieldTypes.cftTime)
        .Add("status")
        .Add("max_concurrent_jobs", CDBField.FieldTypes.cftLong)
        .Add("polling_interval", CDBField.FieldTypes.cftLong)
        .Add("last_polled", CDBField.FieldTypes.cftTime)

        .Item(JobProcessorFields.JobProcessor).PrimaryKey = True
      End With
    End Sub

    Protected Overrides ReadOnly Property SupportsAmendedOnAndBy() As Boolean
      Get
        Return False
      End Get
    End Property
    Protected Overrides ReadOnly Property TableAlias() As String
      Get
        Return "jp"
      End Get
    End Property
    Protected Overrides ReadOnly Property DatabaseTableName() As String
      Get
        Return "job_processors"
      End Get
    End Property

'--------------------------------------------------
'Default constructor
'--------------------------------------------------
    Public Sub New(ByVal pEnv As CDBEnvironment)
      MyBase.New(pEnv)
    End Sub

'--------------------------------------------------
'Public property procedures
'--------------------------------------------------
    Public Property JobProcessorCode() As String
      Get
        Return mvClassFields(JobProcessorFields.JobProcessor).Value
      End Get
      Set(ByVal pValue As String)
        mvClassFields(JobProcessorFields.JobProcessor).Value = pValue
      End Set
    End Property
    Public ReadOnly Property Started() As String
      Get
        Return mvClassFields(JobProcessorFields.Started).Value
      End Get
    End Property
    Public ReadOnly Property Status() As String
      Get
        Return mvClassFields(JobProcessorFields.Status).Value
      End Get
    End Property
    Public ReadOnly Property MaxConcurrentJobs() As Integer
      Get
        Return mvClassFields(JobProcessorFields.MaxConcurrentJobs).IntegerValue
      End Get
    End Property
    Public ReadOnly Property PollingInterval() As Integer
      Get
        Return mvClassFields(JobProcessorFields.PollingInterval).IntegerValue
      End Get
    End Property
    Public Property LastPolled() As String
      Get
        Return mvClassFields(JobProcessorFields.LastPolled).Value
      End Get
      Set(ByVal pValue As String)
        mvClassFields(JobProcessorFields.LastPolled).Value = pValue
      End Set
    End Property
#End Region

#Region "Public Methods"

    Public Sub SetProcessorDetails(ByVal pMaxJobs As Integer, ByVal pPollingInterval As Integer, ByVal pStatus As String, ByVal pStarted As String, ByVal pLastPolled As String)
      mvClassFields(JobProcessorFields.MaxConcurrentJobs).IntegerValue = pMaxJobs
      mvClassFields(JobProcessorFields.PollingInterval).IntegerValue = pPollingInterval
      mvClassFields(JobProcessorFields.Status).Value = pStatus
      mvClassFields(JobProcessorFields.Started).Value = pStarted
      mvClassFields(JobProcessorFields.LastPolled).Value = pLastPolled
    End Sub

    Public Sub SetStatus(ByVal pStatus As String, ByVal pStarted As String)
      mvClassFields(JobProcessorFields.Status).Value = pStatus
      mvClassFields(JobProcessorFields.Started).Value = pStarted
    End Sub

#End Region

  End Class
End Namespace
