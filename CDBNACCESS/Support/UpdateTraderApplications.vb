Namespace Access

  Public Class UpdateTraderApplications

    Private Enum NewTraderApp
      ntaCashBatchMaint = 1       'Cash Batch Maintenance
      ntaCreditSales              'Credit Sales
      ntaCreditCardSales          'Credit Card Sales
      ntaDebitCardSales           'Debit Card Sales
      ntaGeneralTransactions      'General Transactions
      ntaPayPlanConversion        'Payment Plan Conversion
      ntaGiveAsYouEarnPayments    'Give As You Earn payments (Pre Tax Payroll Giving)
      ntaPayPlanMaint             'Payment Plan Maintenance
      ntaChangeMembership         'Change Membership Type
      ntaFinancialAdjustments     'Financial Adjustments
      ntaTransactionConfirmation  'Transaction Confirmation
      ntaCreditListReconciliation 'Credit List Reconciliation
      ntaBankStatementPosting     'Bank Statement Posting
      ntaPurchaseOrderMaint       'Purchase Order Maintenance
      ntaPostTaxPGPayments        'Post Tax Payroll Giving payments
    End Enum

    Private mvEnv As CDBEnvironment
    Private mvDefaultBankAccount As String

    Public Sub New(pEnv As CDBEnvironment)
      mvEnv = pEnv
    End Sub

    Public Sub InitialiseTrader(ByVal pBankAccount As String, ByVal pOldVersionNumber As Integer, ByVal pNewVersionNumber As Integer)
      Dim vApplication As Integer
      Dim vCount As Long
      Dim vWhereFields As New CDBFields

      mvDefaultBankAccount = pBankAccount

      vWhereFields.Add("bank_account", CDBField.FieldTypes.cftCharacter, mvDefaultBankAccount, CDBField.FieldWhereOperators.fwoEqual)
      If mvEnv.Connection.GetCount("bank_accounts", vWhereFields) > 0 Then
        'Provide user possible alternative Bank Accounts for Default Applications
        mvDefaultBankAccount = pBankAccount
      Else
        Exit Sub
      End If

      'If adding a new base application, add to For vApplication condition
      'to ensure any current usage is reassigned first
      For vApplication = 6 To 8
        ClearFPApplication(CStr(vApplication))
      Next

      'Application Types
      vWhereFields.Clear()
      vWhereFields.Add("fp_application_type", CDBField.FieldTypes.cftCharacter, "", CDBField.FieldWhereOperators.fwoNotEqual)
      vCount = mvEnv.Connection.DeleteRecords("fp_application_types", vWhereFields, False)
      AddFPAppType("PINVE,Purchase Invoice Entry")
      AddFPAppType("POCHQ,Cheque Production")
      AddFPAppType("POGEN,Auto Purchase Order Generation")
      AddFPAppType("POPRT,Purchase Order Printing")
      AddFPAppType("PORDC,Purchase Order Cancellation")
      AddFPAppType("PORDE,Purchase Order Entry")
      AddFPAppType("TRANS,Trader Transaction entry")
      AddFPAppType("CSTAT,Credit Statement Generation")
      AddFPAppType("BINVG,Batch Invoice Generation")
      AddFPAppType("MAINT,Payment Plan Maintenance")
      AddFPAppType("CNVRT,Payment Plan Conversion")
      AddFPAppType("CHQNA,Cheque Number Allocation")
      AddFPAppType("CHQRE,Cheque Reconciliation")
      AddFPAppType("CLREC,Credit List Reconciliation")
      AddFPAppType("BSPOS,Bank Statement Posting")
      AddFPAppType("GAYEP,PreTax Payroll Giving Payments")
      AddFPAppType("POTPG,PostTax Payroll Giving Payment")

      'Base Trader Applications
      vWhereFields.Clear()
      vWhereFields.Add("fp_application", CDBField.FieldTypes.cftCharacter, "'1','2','3','4','5','6','7','8'", CDBField.FieldWhereOperators.fwoIn)
      vCount = mvEnv.Connection.DeleteRecords("fp_applications", vWhereFields, False)
      AddTraderApp(NewTraderApp.ntaCashBatchMaint)
      AddTraderApp(NewTraderApp.ntaCreditSales)
      AddTraderApp(NewTraderApp.ntaCreditCardSales)
      AddTraderApp(NewTraderApp.ntaDebitCardSales)
      AddTraderApp(NewTraderApp.ntaGeneralTransactions)
      AddTraderApp(NewTraderApp.ntaPayPlanConversion)
      AddTraderApp(NewTraderApp.ntaPayPlanMaint)
      AddTraderApp(NewTraderApp.ntaChangeMembership)
      AddTraderApp(NewTraderApp.ntaFinancialAdjustments)
      AddTraderApp(NewTraderApp.ntaTransactionConfirmation)
      AddTraderApp(NewTraderApp.ntaCreditListReconciliation)
      AddTraderApp(NewTraderApp.ntaBankStatementPosting)
      AddTraderApp(NewTraderApp.ntaGiveAsYouEarnPayments)
      AddTraderApp(NewTraderApp.ntaPurchaseOrderMaint)
      AddTraderApp(NewTraderApp.ntaPostTaxPGPayments)

      'Base Trader Pages
      With vWhereFields
        .Clear()
        .Add("fp_application", CDBField.FieldTypes.cftCharacter, "", CDBField.FieldWhereOperators.fwoEqual)
        .Add("fp_page_type", CDBField.FieldTypes.cftCharacter, "???", CDBField.FieldWhereOperators.fwoLike)
      End With
      vCount = mvEnv.Connection.DeleteRecords("fp_controls", vWhereFields, False)

      'Accommodation Booking
      AddFPControl("ACO,1,hdr,none,none,100,100,4000,300,Enter the Accommodation Booking details,0,,Y")
      AddFPControl("ACO,2,txt,contact_room_bookings,contact_number,500,100,1200,300,Contact Number,2000,,Y")
      AddFPControl("ACO,3,txt,contact_room_bookings,address_number,850,100,1200,300,Address,2000,,Y")
      AddFPControl("ACO,4,txt,contact_room_bookings,event_number,1200,100,1200,300,Event Number:,2000,,Y")
      AddFPControl("ACO,5,txt,room_block_bookings,room_type,1550,100,1200,300,Room Type:,2000,,Y")
      AddFPControl("ACO,6,txt,contact_room_bookings,block_booking_number,1900,100,1200,300,Rooms at:,2000,,Y")
      AddFPControl("ACO,7,txt,batch_transaction_analysis,product,1900,100,1200,300,Product:,2000,,N")
      AddFPControl("ACO,8,txt,contact_room_bookings,rate,2250,100,1200,300,Rate:,2000,,Y")
      AddFPControl("ACO,9,txt,batch_transaction_analysis,distribution_code,2600,100,1200,300,Distribution Code:,2000,,Y")
      AddFPControl("ACO,10,txt,batch_transaction_analysis,quantity,2950,100,400,300,Number of Rooms:,2000,,Y")
      AddFPControl("ACO,11,meb,contact_room_bookings,from_date,3300,100,1200,300,From Date:,2000,,Y")
      AddFPControl("ACO,12,meb,contact_room_bookings,to_date,3300,3800,1200,300,To Date:,1100,,Y")
      AddFPControl("ACO,13,txt,batch_transaction_analysis,amount,3650,100,1000,300,Amount:,2000,,Y")
      AddFPControl("ACO,14,txt,contact_room_bookings,notes,4000,100,6600,300,Notes:,2000,,Y")
      AddFPControl("ACO,15,txt,contact_room_bookings,sales_contact_number,4350,100,1200,300,Sales Contact:,2000,Enter the Contact Number of the Sales Person,Y")
      AddFPControl("ACO,16,txt,events,event_group,4700,100,1200,300,Event Group:,2000,,N")
      'Add Activity
      AddFPControl("ACT,1,hdr,none,none,100,100,4000,300,Enter Activity Details,0,,Y")
      AddFPControl("ACT,2,txt,contacts,contact_number,500,100,1200,300,Contact Number:,1900,Enter the Contact Number,Y")
      AddFPControl("ACT,3,txt,contacts,address_number,900,100,1200,300,Address:,1900,,Y")
      AddFPControl("ACT,4,txt,contact_categories,source,1300,100,1200,300,Source:,1900,Enter the Source,Y")
      AddFPControl("ACT,5,ace,contact_categories,activity,1700,100,8600,3000,,,,Y")
      'Address Maintenance
      AddFPControl("ADM,1,hdr,none,none,100,100,4000,300,Maintain Contact Addresses,0,,Y")
      AddFPControl("ADM,2,txt,contacts,contact_number,500,100,1200,300,Contact Number:,1900,Enter the Contact Number,Y")
      AddFPControl("ADM,3,txt,contacts,address_number,900,100,1200,300,Address:,1900,,Y")
      'Amend Event Booking
      AddFPControl("AEV,1,hdr,none,none,100,100,4000,300,Amend Event Booking,0,,Y")
      AddFPControl("AEV,2,txt,event_bookings,contact_number,500,100,1200,300,Contact Number:,2000,,Y")
      AddFPControl("AEV,3,txt,event_bookings,address_number,850,100,1200,300,Address:,2000,,Y")
      AddFPControl("AEV,4,txt,event_bookings,event_number,1200,100,1200,300,Event Number:,2000,,Y")
      AddFPControl("AEV,5,txt,event_bookings,booking_number,1200,100,1200,300,Booking Number:,2000,,N")
      AddFPControl("AEV,6,txt,event_bookings,option_number,1550,100,1200,300,Booking Option:,2000,,Y")
      AddFPControl("AEV,7,txt,event_booking_options,product,1550,100,1200,300,Product:,2000,,N")
      AddFPControl("AEV,8,txt,event_bookings,rate,1900,100,1200,300,Rate:,2000,,Y")
      AddFPControl("AEV,9,txt,event_bookings,quantity,2250,100,400,300,Quantity:,2000,,Y")
      AddFPControl("AEV,10,txt,event_bookings,adult_quantity,2600,100,400,300,Adult Quantity:,2000,Enter the number of adult places required on the Event,Y")
      AddFPControl("AEV,11,txt,event_bookings,child_quantity,2950,100,400,300,Child Quantity:,2000,Enter the number of child places required on the Event,Y")
      AddFPControl("AEV,12,dtp,sessions,start_time,3300,100,1500,300,Start Time:,2000,Event Start Time,Y")
      AddFPControl("AEV,13,dtp,sessions,end_time,3650,100,1500,300,End Time:,2000,Event End Time,Y")
      AddFPControl("AEV,14,txt,batch_transaction_analysis,amount,4000,100,1000,300,Amount:,2000,,Y")
      'Amend Membership Details
      AddFPControl("AMD,1,hdr,none,none,100,100,4000,300,Enter Membership Details,0,,Y")
      AddFPControl("AMD,2,txt,members,membership_type,500,100,1200,300,Membership Type:,1700,,Y")
      AddFPControl("AMD,3,meb,members,joined,850,100,1200,300,Joined:,1700,,Y")
      AddFPControl("AMD,4,txt,members,contact_number,1200,100,1200,300,Member:,1700,,Y")
      AddFPControl("AMD,5,txt,members,address_number,1550,100,1200,300,Member Address:,1700,,Y")
      AddFPControl("AMD,6,txt,addresses,branch,1900,100,1200,300,Branch:,1700,,Y")
      AddFPControl("AMD,7,chk,members,branch_member,2250,1800,2000,300,Branch Member:,0,,Y")
      AddFPControl("AMD,8,meb,members,applied,2250,5000,1200,300,Applied:,1700,,Y")
      AddFPControl("AMD,9,chk,contacts,dob_estimated,2700,1800,2400,300,Estimated Date of Birth,0,,Y")
      AddFPControl("AMD,10,meb,contacts,date_of_birth,2700,5000,1200,300,Date of Birth,1700,,Y")
      AddFPControl("AMD,11,txt,members,age_override,3050,100,500,300,Age Override:,1700,,Y")
      AddFPControl("AMD,12,lbl,members,membership_number,500,10000,500,300,Membership Number:,1700,,Y")
      AddFPControl("AMD,13,txt,order_details,distribution_code,3400,100,1200,300,Distribution Code:,1700,,Y")
      'Bank Details
      AddFPControl("BKD,1,hdr,none,none,100,100,4000,300,Enter the Bank Details,0,,Y")
      AddFPControl("BKD,2,meb,contact_accounts,sort_code,500,100,1200,300,Sort Code:,1800,,Y")
      AddFPControl("BKD,3,txt,banks,branch_name,500,3500,3800,300,Branch:,1300,,Y")
      AddFPControl("BKD,4,txt,contact_accounts,account_number,900,100,1500,300,Account Number:,1800,,Y")
      AddFPControl("BKD,5,txt,contact_accounts,account_name,1300,100,4000,300,Account Name:,1800,,Y")
      AddFPControl("BKD,6,txt,batch_transactions,reference,1700,100,2400,300,Reference,1800,,Y")
      AddFPControl("BKD,7,txt,contact_accounts,bic_code,2100,100,900,300,BIC Code:,1800,,N")
      AddFPControl("BKD,8,ibn,contact_accounts,iban_number,2500,100,2500,300,IBAN Number:,1800,,N")
      'Continuous Credit Card Authority
      AddFPControl("CCA,1,hdr,none,none,100,100,4000,300,Enter Card Authority Details,0,,Y")
      AddFPControl("CCA,2,txt,credit_card_authorities,contact_number,500,100,1200,300,Contact Number,2000,,Y")
      AddFPControl("CCA,3,txt,credit_card_authorities,address_number,850,100,1200,300,Address,2000,,Y")
      AddFPControl("CCA,4,txt,contact_credit_cards,credit_card_type,1250,100,350,300,Card Type,2000,,Y")
      AddFPControl("CCA,5,txt,contact_credit_cards,credit_card_number,1600,100,2000,300,Card Number,2000,,Y")
      AddFPControl("CCA,6,meb,contact_credit_cards,expiry_date,1600,6200,700,300,Expiry,1300,,Y")
      AddFPControl("CCA,7,txt,contact_credit_cards,issuer,1950,6200,1200,300,Issuer,1300,,Y")
      AddFPControl("CCA,8,txt,contact_credit_cards,account_name,1950,100,4000,300,Account Name,2000,,Y")
      AddFPControl("CCA,9,txt,contact_credit_cards,issue_number,2300,100,400,300,Issue Number,2000,,Y")
      AddFPControl("CCA,10,txt,credit_card_authorities,bank_account,2650,100,1200,300,Bank Account,2000,,Y")
      AddFPControl("CCA,11,txt,credit_card_authorities,amount,3000,100,1000,300,Amount:,2000,,Y")
      AddFPControl("CCA,12,meb,credit_card_authorities,start_date,3350,100,1200,300,Start Date:,2000,,Y")
      AddFPControl("CCA,13,txt,credit_card_authorities,source,3700,100,1200,300,Source:,2000,,Y")
      AddFPControl("CCA,14,cbo,orders,claim_day,4000,100,1000,300,Claim Day:,2000,,Y")
      AddFPControl("CCA,15,opt_A,credit_card_authorities,authority_type,4350,100,2000,300,Credit Card Authority,2000,,N")
      AddFPControl("CCA,16,opt_C,credit_card_authorities,authority_type,4350,2100,2000,300,CAF Card Authority,2000,,N")
      'Credit customer
      AddFPControl("CCU,1,hdr,none,none,100,100,4000,300,Select the Credit Customer,0,,Y")
      AddFPControl("CCU,2,txt,credit_customers,contact_number,500,100,1200,300,Contact Number,2000,Enter the contact number for the Credit Customer,Y")
      AddFPControl("CCU,3,txt,credit_customers,address_number,850,100,1200,300,Address,2000,,Y")
      AddFPControl("CCU,4,txt,credit_customers,sales_ledger_account,1200,100,1200,300,Sales Account,2000,Select the Sales Ledger Account,Y")
      AddFPControl("CCU,5,txt,credit_customers,credit_category,1550,100,600,300,Credit Category:,2000,,Y")
      AddFPControl("CCU,6,txt,credit_customers,stop_code,1900,100,600,300,Stop Code:,2000,,Y")
      AddFPControl("CCU,7,txt,credit_customers,credit_limit,2250,100,1200,300,Credit Limit:,2000,,Y")
      AddFPControl("CCU,8,txt,credit_customers,customer_type,2600,100,600,300,Customer Type:,2000,,Y")
      AddFPControl("CCU,9,lbl,credit_customers,outstanding,2250,4000,1200,300,Outstanding:,1500,,Y")
      AddFPControl("CCU,10,lbl,credit_customers,on_order,2600,4000,1200,300,On Order:,1500,,Y")
      AddFPControl("CCU,11,chk,credit_sales,stock_sale,2950,2100,2400,300,Stock Sale,2000,,Y")
      AddFPControl("CCU,12,txt,credit_sales,address_to,3300,100,2400,300,Address To:,2000,,Y")
      AddFPControl("CCU,13,txt,batch_transactions,reference,3650,100,2400,300,Reference,2000,Enter the Customer's reference for the transaction,Y")
      AddFPControl("CCU,14,txt,credit_customers,terms_number,4000,100,600,300,Number of Days:,2000,Number of days from which the invoice will be due,Y")
      AddFPControl("CCU,15,opt_I,credit_customers,terms_from,4000,3000,2000,300,from Invoice Date,2000,,Y")
      AddFPControl("CCU,16,opt_P,credit_customers,terms_from,4000,5000,2000,300,from End of Period,2000,,Y")
      AddFPControl("CCU,17,chk,credit_customers,terms_period,4350,2100,3000,300,Use Months Instead of Days,2000,Uses the number of months rather than days to calculate an invoice due date,Y")
      'Credit or Debit Card details
      AddFPControl("CDC,1,hdr,none,none,100,100,4000,300,Enter the Credit Card Details,0,,Y")
      AddFPControl("CDC,2,txt,card_sales,credit_card_type,500,100,300,300,Credit/Debit Card,2000,,Y")
      AddFPControl("CDC,3,txt,contact_credit_cards,credit_card_type,850,100,300,300,Card Type,2000,,Y")
      AddFPControl("CDC,4,txt,card_sales,card_number,1200,100,2000,300,Card Number,2000,,Y")
      AddFPControl("CDC,5,txt,card_sales,issue_number,1550,100,400,300,Issue,2000,,Y")
      AddFPControl("CDC,6,meb,card_sales,valid_date,1900,100,700,300,Valid Date,2000,,Y")
      AddFPControl("CDC,7,meb,contact_credit_cards,expiry_date,2250,100,700,300,Expiry Date,2000,,Y")
      AddFPControl("CDC,8,txt,card_sales,authorisation_code,2600,100,1200,300,Authorisation,2000,,Y")
      AddFPControl("CDC,9,txt,batch_transactions,reference,2950,100,2400,300,Reference,2000,,Y")
      AddFPControl("CDC,10,txt,card_sales,security_code,3300,100,700,300,Card Security Code,2000,,Y")
      AddFPControl("CDC,11,web,none,none,3300,100,700,300,Card Details,2000,,Y")

      'Cancel Gift Aid Declaration
      AddFPControl("CGA,1,hdr,none,none,100,100,4000,300,Cancel Gift Aid Declaration,0,,Y")
      AddFPControl("CGA,2,txt,contact_mailing_documents,declaration_number,500,100,1200,300,Declaration Number:,2000,Enter Gift Aid Declaration Number,Y")
      AddFPControl("CGA,3,txt,gift_aid_declarations,contact_number,900,100,1200,300,Contact Number:,2000,Enter Contact Number,Y")
      AddFPControl("CGA,4,lbl,gift_aid_declarations,declaration_date,1300,100,1500,300,Declaration Date:,2000,,Y")
      AddFPControl("CGA,5,lbl,gift_aid_declarations,declaration_type,1700,100,1500,300,Declaration Type:,2000,,Y")
      AddFPControl("CGA,6,lbl,gift_aid_declarations,start_date,2100,100,1500,300,Start Date:,2000,,Y")
      AddFPControl("CGA,6,lbl,gift_aid_declarations,end_date,2500,100,1500,300,End Date:,2000,,Y")
      AddFPControl("CGA,8,txt,gift_aid_declarations,cancellation_reason,3000,100,1200,300,Cancellation Reason:,2000,Enter Cancellation Reason,Y")
      AddFPControl("CGA,9,txt,gift_aid_declarations,cancellation_source,3500,100,1200,300,Cancellation Source:,2000,,Y")
      'Change Membership Type
      AddFPControl("CMT,1,hdr,none,none,100,100,4000,300,Existing Membership Details,0,,Y")
      AddFPControl("CMT,2,lbl,membership_types,membership_type_desc,500,100,6900,300,Existing Mship:,1700,,Y")
      AddFPControl("CMT,3,txt,members,cancellation_reason,850,100,850,300,Cancel Reason:,1700,,Y")
      AddFPControl("CMT,4,hdr,none,none,1500,100,4000,300,New Membership Details,0,,Y")
      AddFPControl("CMT,5,txt,members,membership_type,1850,100,1200,300,Membership Type:,1700,,Y")
      AddFPControl("CMT,6,meb,members,joined,2200,100,1200,300,Joined:,1700,,Y")
      AddFPControl("CMT,7,txt,members,number_of_members,2200,3300,600,300,No of Members:,1700,,Y")
      AddFPControl("CMT,8,txt,membership_types,max_free_associates,2200,6400,600,300,No of Associates:,1700,,Y")
      AddFPControl("CMT,9,chk,orders,gift_membership,2550,1800,2000,300,Gift Membership,0,,Y")
      AddFPControl("CMT,10,chk,orders,one_year_gift,2550,4000,2000,300,One Year Gift,0,,Y")
      AddFPControl("CMT,11,chk,new_orders,pack_to_donor,2550,6200,2050,300,Send Pack to Donor,0,,Y")
      AddFPControl("CMT,12,opt_N,new_orders,gift_card_status,2900,1800,2000,300,No Gift Card,2000,,Y")
      AddFPControl("CMT,13,opt_B,new_orders,gift_card_status,2900,4000,2000,300,Blank Gift Card,2000,,Y")
      AddFPControl("CMT,14,opt_W,new_orders,gift_card_status,2900,6200,2000,300,Written Gift Card,2000,,Y")
      AddFPControl("CMT,15,txt,members,source,3250,100,1200,300,Source:,1700,,Y")
      AddFPControl("CMT,16,txt,orders,payment_frequency,3600,100,1200,300,Pay Frequency:,1700,,Y")
      AddFPControl("CMT,17,txt,members,member_number,3950,100,1200,300,Affiliated Member:,1700,,Y")
      AddFPControl("CMT,18,txt,batch_transaction_analysis,member_number,4300,100,1200,300,Member Number:,1700,,Y")
      AddFPControl("CMT,19,txt,orders,giver_contact_number,4650,100,1200,300,Giver Contact:,1700,,Y")
      AddFPControl("CMT,20,txt,order_details,product,5000,100,500,300,Product:,1700,,N")
      AddFPControl("CMT,21,txt,order_details,rate,5350,100,500,300,Rate:,1700,,N")
      AddFPControl("CMT,22,txt,order_details,amount,5700,100,1000,300,Amount:,1700,Represents the Gross Membership Override Amount for Rates with a zero price,N")
      AddFPControl("CMT,23,txt,order_details,distribution_code,6050,100,1000,300,Distribution Code:,1700,,Y")
      AddFPControl("CMT,24,chk,orders,eligible_for_gift_aid,6400,1800,2000,300,Eligible For Gift Aid,2000,Select if the Payment Plan is covered by Gift Aid,N")
      AddFPControl("CMT,25,meb,members,applied,6750,100,1200,300,Applied Date:,1700,The Applied Date for the Membership,N")
      AddFPControl("CMT,26,txt,new_orders,gift_from,7100,100,4500,300,Gift From:,1700,,N")
      AddFPControl("CMT,27,txt,new_orders,gift_to,7450,100,4500,300,Gift To:,1700,,N")
      AddFPControl("CMT,28,txt,new_orders,gift_message,7800,100,4500,600,Gift Message:,1700,,N")
      AddFPControl("CMT,29,chk,none,checkbox,8500,1800,4000,300,Write-off Missed Payments?,1700,Select if missed payments are to be written off,N,,WriteOffMissedPayments")
      AddFPControl("CMT,30,txt,members,membership_status,8850,100,1200,300,Membership Status:,1700,,N")
      AddFPControl("CMT,31,txt,order_details,net_fixed_amount,9200,100,1000,300,Net Amount:,1700,Net Membership Override Amount for VAT-exclusive Rates with a zero price,N")
      AddFPControl("CMT,32,dtp,members,cmt_date,9550,100,1200,300,CMT Date:,1700,Date for CMT prorating calculations,N,,CMTDate")
      'Cheque number allocation
      AddFPControl("CNA,0,hdr,none,none,100,100,4000,300,Cheque Number Allocation,0,,Y")
      AddFPControl("CNA,1,txt,cheques,cheque_reference_number,500,100,1200,300,First Ref:,1900,,Y")
      AddFPControl("CNA,2,txt,cheques,cheque_reference_number,850,100,1200,300,Last Ref:,1900,,Y")
      AddFPControl("CNA,3,txt,cheques,cheque_number,1200,100,1200,300,First Cheque No:,1900,,Y")
      AddFPControl("CNA,4,txt,cheques,cheque_number,1550,100,1200,300,Last Cheque No:,1900,,Y")
      'Comments
      AddFPControl("COM,1,hdr,none,none,100,100,4000,300,Enter any Comments,0,,Y")
      AddFPControl("COM,2,txt,batch_transactions,notes,500,100,4000,2500,Comments,2000,,Y")
      'Covenant
      AddFPControl("COV,1,hdr,none,none,100,100,4000,300,Enter the Covenant Details,0,,Y")
      AddFPControl("COV,2,txt,covenants,contact_number,500,100,1200,300,Contact Number:,2000,,Y")
      AddFPControl("COV,3,txt,covenants,address_number,850,100,1200,300,Address:,2000,,Y")
      AddFPControl("COV,4,txt,covenants,covenant_type,1200,100,400,300,Individual/ Company:,2000,,Y")
      AddFPControl("COV,5,meb,covenants,signature_date,1600,100,1200,300,Signature Date:,2000,,Y")
      AddFPControl("COV,6,txt,covenants,covenant_term,2000,100,400,300,Term:,2000,,Y")
      AddFPControl("COV,7,meb,covenants,start_date,2400,100,1200,300,Start Date:,2000,,Y")
      AddFPControl("COV,8,txt,covenants,covenanted_amount,2800,100,1200,300,Amount:,2000,,Y")
      AddFPControl("COV,9,txt,covenants,source,3200,100,1200,300,Source:,2000,,Y")
      AddFPControl("COV,10,txt,covenants,covenant_status,3600,100,900,300,Status:,2000,,Y")
      AddFPControl("COV,11,chk,covenants,fixed,1200,4000,2000,300,Fixed,0,,Y")
      AddFPControl("COV,12,chk,covenants,deposited_deed,1600,4000,2000,300,Deposited,0,,Y")
      AddFPControl("COV,13,chk,covenants,net,2000,4000,2000,300,Net of Tax,0,,Y")
      AddFPControl("COV,14,chk,covenants,annual_claim,2400,4000,2000,300,Annual Tax Claim,0,,Y")
      AddFPControl("COV,15,meb,covenants,r185_return,2800,4000,1200,300,R185 Returned:,2000,,Y")
      'Cancel Payment Plan
      AddFPControl("CPP,1,hdr,none,none,100,100,4000,300,Cancel Payment Plan,0,,Y")
      AddFPControl("CPP,2,txt,orders,order_number,500,100,1200,300,Payment Plan Number:,2000,Enter Payment Plan Number,Y")
      AddFPControl("CPP,3,txt,contacts,contact_number,900,100,1200,300,Contact Number:,2000,Enter Contact Number,Y")
      AddFPControl("CPP,4,txt,addresses,address_number,1300,100,1200,300,Address Number:,2000,,Y")
      AddFPControl("CPP,5,dtp,orders,renewal_date,1700,100,1500,300,Renewal Date:,2000,Payment Plan Renewal Date,Y")
      AddFPControl("CPP,6,txt,orders,balance,2100,100,1200,300,Balance:,2000,Payment Plan Balance,Y")
      AddFPControl("CPP,7,txt,orders,cancellation_reason,2500,100,1200,300,Cancellation Reason:,2000,Enter Cancellation Reason,Y")
      AddFPControl("CPP,8,txt,orders,cancellation_source,2900,100,1200,300,Cancellation Source:,2000,Enter Cancellation Source,Y")
      'Confirm Provisional Transactions
      AddFPControl("CPT,1,hdr,none,none,100,100,4000,300,Confirm Provisional Transactions,2000,0,Y")
      AddFPControl("CPT,2,txt,batch_transactions,contact_number,500,100,1200,300,Contact Number:,2000,,Y")
      AddFPControl("CPT,3,txt,batch_transaction_analysis,product_number,850,100,1200,300,Product Number:,2000,,Y")
      AddFPControl("CPT,4,lbl,confirmed_transactions,provisional_batch_number,1200,100,1200,300,Batch Number:,2000,,Y")
      AddFPControl("CPT,5,lbl,confirmed_transactions,provisional_trans_number,1550,100,1200,300,Transaction Number:,2000,,Y")
      AddFPControl("CPT,6,lbl,batch_transactions,amount,1900,100,1200,300,Amount:,2000,,Y")
      AddFPControl("CPT,7,lbl,batch_transactions,transaction_date,2250,100,1200,300,Transaction Date:,2000,,Y")
      AddFPControl("CPT,8,lbl,batch_transactions,reference,2600,100,2400,300,Reference:,2000,,Y")
      'Cheque Reconciliation
      AddFPControl("CRE,0,hdr,none,none,100,100,4000,300,Cheque Reconciliation,0,,Y")
      AddFPControl("CRE,1,meb,cheques,reconciled_on,500,100,1200,300,Statement Date:,1900,,Y")
      AddFPControl("CRE,2,txt,cheques,cheque_number,850,100,1200,300,Cheque Number:,1900,,Y")
      AddFPControl("CRE,3,txt,cheques,amount,1200,100,1200,300,Amount:,1900,,Y")
      AddFPControl("CRE,4,txt,cheques,contact_number,1550,100,1200,300,Payee:,1900,,Y")
      AddFPControl("CRE,5,txt,cheques,cheque_status,1900,100,1200,300,Cheque Status:,1900,,Y")
      'Contact Selection
      AddFPControl("CSE,1,hdr,none,none,100,100,4000,300,Select the Contact OR Existing Payment Plan/Member/Covenant Number,0,,Y")
      AddFPControl("CSE,2,txt,batch_transaction_analysis,order_number,500,100,1200,300,Payment Plan Number,2000,,Y")
      AddFPControl("CSE,3,txt,bankers_orders,bankers_order_number,500,4000,1200,300,Standing Order Number,2000,,Y")
      AddFPControl("CSE,4,txt,batch_transaction_analysis,member_number,850,100,1200,300,Member Number,2000,,Y")
      AddFPControl("CSE,5,txt,direct_debits,direct_debit_number,850,4000,1200,300,Direct Debit Number,2000,,Y")
      AddFPControl("CSE,6,txt,batch_transaction_analysis,covenant_number,1200,100,1200,300,Covenant Number,2000,,Y")
      AddFPControl("CSE,7,txt,credit_card_authorities,credit_card_authority_number,1200,4000,1200,300,CCCA Number,2000,,Y")
      AddFPControl("CSE,8,txt,contacts,contact_number,1700,100,1200,300,Contact Number,2000,,Y")
      AddFPControl("CSE,9,txt,addresses,address_number,2050,100,1200,300,Address Number,2000,,Y")
      AddFPControl("CSE,10,txt,batch_transactions,mailing,2400,100,1200,300,Mailing,2000,Enter a mailing code for the Mailing Document,N")
      'Credit Statement Generation
      AddFPControl("CSG,0,hdr,none,none,100,100,4000,300,Specify the parameters for the generation of Credit Statement reports,2000,0,Y")
      AddFPControl("CSG,1,txt,credit_customers,company,500,100,1200,300,Company:,2100,,Y")
      AddFPControl("CSG,2,txt,credit_customers,sales_ledger_account,850,100,1200,300,Sales Ledger Account:,2100,,Y")
      'Direct Debit
      AddFPControl("DDR,1,hdr,none,none,100,100,4000,300,Enter Direct Debit Details,0,,Y")
      AddFPControl("DDR,2,txt,direct_debits,contact_number,500,100,1200,300,Contact Number,1800,,Y")
      AddFPControl("DDR,3,txt,direct_debits,address_number,850,100,1200,300,Address,1800,,Y")
      AddFPControl("DDR,4,meb,contact_accounts,sort_code,1250,100,1200,300,Sort Code:,1800,,Y")
      AddFPControl("DDR,5,txt,banks,branch_name,1250,4100,3800,300,Branch:,800,,Y")
      AddFPControl("DDR,6,txt,contact_accounts,account_number,1600,100,2050,300,Account Number:,1800,,Y")
      AddFPControl("DDR,7,txt,contact_accounts,account_name,1600,4100,3800,300,Name:,800,,Y")
      AddFPControl("DDR,8,txt,contact_accounts,bic_code,1950,100,900,300,BIC Code:,1800,,N")
      AddFPControl("DDR,9,ibn,contact_accounts,iban_number,2300,100,2500,300,IBAN Number:,1800,,N")
      AddFPControl("DDR,10,txt,direct_debits,bank_account,2650,100,1200,300,Bank Account:,1800,,Y")
      AddFPControl("DDR,11,txt,direct_debits,reference,3000,100,2100,300,Reference:,1800,,Y")
      AddFPControl("DDR,12,txt,direct_debits,amount,3000,4100,1000,300,Amount:,900,,Y")
      AddFPControl("DDR,13,meb,direct_debits,start_date,3000,6200,1200,300,Start Date:,1100,,Y")
      AddFPControl("DDR,14,txt,direct_debits,source,3350,100,1200,300,Source:,1800,,Y")
      AddFPControl("DDR,15,cbo,direct_debits,mandate_type,3700,100,1500,300,Mandate Type:,1800,,Y")
      AddFPControl("DDR,16,cbo,orders,claim_day,4050,100,1000,300,Claim Day:,1800,,Y")
      AddFPControl("DDR,17,txt,direct_debit_references,text1,4400,100,4300,300,Text 1:,1800,,Y")
      AddFPControl("DDR,18,txt,direct_debit_references,text2,4750,100,4300,300,Text 2:,1800,,Y")
      AddFPControl("DDR,19,txt,direct_debit_references,text3,5100,100,4300,300,Text 3:,1800,,Y")
      AddFPControl("DDR,20,txt,direct_debit_references,text4,5450,100,4300,300,Text 4:,1800,,Y")
      AddFPControl("DDR,21,txt,direct_debit_references,text5,5800,100,4300,300,Text 5:,1800,,Y")
      AddFPControl("DDR,22,dtp,direct_debits,date_signed,6150,100,1350,300,Date Signed:,1800,Enter the date the mandate was signed,N")
      'Event Booking
      AddFPControl("EVE,1,hdr,none,none,100,100,4000,300,Enter the Event Booking details,0,,Y")
      AddFPControl("EVE,2,txt,event_bookings,contact_number,500,100,1200,300,Contact Number,2000,,Y")
      AddFPControl("EVE,3,txt,event_bookings,address_number,850,100,1200,300,Address,2000,,Y")
      AddFPControl("EVE,4,txt,event_bookings,event_number,1200,100,1200,300,Event Number:,2000,,Y")
      AddFPControl("EVE,5,txt,event_bookings,option_number,1550,100,1200,300,Booking Option:,2000,,Y")
      AddFPControl("EVE,6,txt,event_booking_options,product,1550,100,1200,300,Product:,2000,,N")
      AddFPControl("EVE,7,txt,event_bookings,rate,1900,100,1200,300,Rate:,2000,,Y")
      AddFPControl("EVE,8,txt,batch_transaction_analysis,distribution_code,2250,100,1200,300,Distribution Code:,2000,,Y")
      AddFPControl("EVE,9,txt,event_bookings,quantity,2600,100,400,300,Quantity:,2000,,Y")
      AddFPControl("EVE,10,txt,batch_transaction_analysis,amount,2950,100,1000,300,Amount:,2000,,Y")
      AddFPControl("EVE,11,txt,event_bookings,sales_contact_number,3300,100,1200,300,Sales Contact:,2000,Enter the Contact Number of the Sales Person,Y")
      AddFPControl("EVE,12,txt,event_bookings,booking_number,4000,100,1200,300,Transfer From Event Booking:,2750,Optional Event Booking Number to Transfer From if required.,Y")
      AddFPControl("EVE,13,dtp,events,start_date,4700,100,1500,300,Start Date:,2000,Event Start Date,N")
      AddFPControl("EVE,14,txt,events,event_reference,5050,100,5000,300,Reference:,2000,Event Reference,N")
      AddFPControl("EVE,15,lbl,venues,venue_desc,5400,100,5000,300,Venue Description:,2000,Name of the Event Venue,N")
      AddFPControl("EVE,16,lbl,venues,location,5750,100,5000,1500,Venue Location:,2000,Location of the Event Venue,N")
      AddFPControl("EVE,17,chk,none,checkbox,6100,100,2000,300,Add to Waiting List,2000,Add Booking to Event Waiting List even if places are available,N,,WaitingList")
      AddFPControl("EVE,18,txt,event_bookings,notes,7350,100,6600,1500,Notes:,2000,Notes,N")
      AddFPControl("EVE,19,txt,events,event_group,7700,100,1200,300,Event Group:,2000,,N")
      AddFPControl("EVE,20,chk,none,checkbox,8050,100,2000,300,Interest Only,2000,Create as Interest Only Booking,N,,InterestOnly")
      AddFPControl("EVE,21,txt,delegates,booking_number,8400,100,1200,300,Convert Interested Booking:,2750,Convert existing Interest Only Booking into an actual Event Booking Number,Y,,InterestBookingNumber")
      AddFPControl("EVE,22,txt,event_bookings,adult_quantity,8750,100,400,300,Adult Quantity:,2000,Enter the number of adult places required on the Event,N")
      AddFPControl("EVE,23,txt,event_bookings,child_quantity,9100,100,400,300,Child Quantity:,2000,Enter the number of child places required on the Event,N")
      AddFPControl("EVE,24,dtp,sessions,start_time,9450,100,1500,300,Start Time:,2000,Event Start Time,N")
      AddFPControl("EVE,25,dtp,sessions,end_time,9800,100,1500,300,End Time:,2000,Event End Time,N")
      AddFPControl("EVE,26,chk,none,checkbox,10150,100,2000,300,Display Pricing Breakdown:,2000,Display the Event Booking price breakdown,N,,DisplayPricingBreakdown")

      'Exam Booking
      AddFPControl("EXA,1,hdr,none,none,100,100,4000,300,Enter the Exam Booking details,0,,Y")
      AddFPControl("EXA,2,txt,exam_bookings,contact_number,500,100,1200,300,Contact Number:,2000,,Y")
      AddFPControl("EXA,3,txt,exam_bookings,address_number,850,100,1200,300,Address:,2000,,Y")
      AddFPControl("EXA,4,txt,exam_sessions,exam_session_code,1200,100,1200,300,Session:,2000,,Y")
      AddFPControl("EXA,5,txt,exam_units,exam_unit_code,1550,100,1200,300,Course:,2000,,Y")
      AddFPControl("EXA,6,txt,exam_centres,exam_centre_code,1900,100,1200,300,Centre:,2000,,Y")
      AddFPControl("EXA,7,txt,exam_bookings,study_mode,2250,100,1200,300,Study Mode:,2000,,Y")
      AddFPControl("EXA,8,exs,exam_units,exam_unit_id,2850,100,4000,3000,Selection,2000,,Y")
      AddFPControl("EXA,9,rdo,batch_transaction_analysis,amount,6000,100,1200,300,Amount:,2000,,Y")
      AddFPControl("EXA,10,dtp,exam_booking_units,course_start_date,6350,100,1200,300,Course Start Date:,2000,,N")
      AddFPControl("EXA,11,txt,exam_booking_units,exam_assessment_language,6700,100,1200,300,Assessment Language:,2000,,N")
      AddFPControl("EXA,12,txt,contacts,contact_reference,7050,100,3000,300,Contact Reference:,2000,,N")

      'Gift Aid Declaration
      AddFPControl("GAD,1,hdr,none,none,100,100,4000,300,Enter the Gift Aid Declaration details,0,,Y")
      AddFPControl("GAD,2,txt,gift_aid_declarations,contact_number,500,100,1200,300,Contact Number:,2000,Enter the Contact Number of the Donor,Y")
      AddFPControl("GAD,3,dtp,gift_aid_declarations,declaration_date,900,100,1500,300,Declaration Date:,2000,Specify the Declaration Date,Y")
      AddFPControl("GAD,4,lbl,none,none,1300,100,100,300,Declaration Type:,2000,,Y")
      AddFPControl("GAD,5,chk,gift_aid_declarations,declaration_type,1300,2100,1200,300,Donations,2000,Indicates the Declaration includes Donations,Y")
      AddFPControl("GAD,6,chk,gift_aid_declarations,declaration_type,1300,3400,1000,300,Members,2000,Indicates the Declaration includes Membership Payments,Y")
      AddFPControl("GAD,8,cbo,gift_aid_declarations,method,1700,100,1200,300,Declaration Method:,2000, Written or Oral or Electronic Declaration,Y")
      AddFPControl("GAD,9,dtp,gift_aid_declarations,confirmed_on,1700,4700,1500,300,Confirmed On:,1200,Specify the Oral Declaration Confirmation Date,Y")
      AddFPControl("GAD,10,txt,gift_aid_declarations,source,2100,100,1200,300,Source:,2000,,Y")
      AddFPControl("GAD,11,dtp,gift_aid_declarations,start_date,2500,100,1500,300,Start Date:,2000,Specify the Declaration Start Date,Y")
      AddFPControl("GAD,12,dtp,gift_aid_declarations,end_date,2500,4700,1500,300,End Date:,1200,Specify the Declaration End Date,Y")
      AddFPControl("GAD,13,txt,gift_aid_declarations,notes,2900,100,4000,1500,Notes:,2000,,Y")
      'Gone Away
      AddFPControl("GAW,1,hdr,none,none,100,100,4000,300,Mark Contact as Gone Away,0,,Y")
      AddFPControl("GAW,2,txt,contacts,contact_number,500,100,1200,300,Contact Number:,1900,Enter the Contact Number,Y")
      AddFPControl("GAW,3,txt,contacts,address_number,900,100,1200,300,Address:,1900,,Y")
      'Give As You Earn Entry
      AddFPControl("GYE,1,hdr,none,none,100,100,4000,300,Enter the Pre Tax Payroll Giving details,0,,Y")
      AddFPControl("GYE,2,txt,gaye_pledges,contact_number,500,100,1200,300,Contact Number:,2000,Enter the Contact Number of the Donor,Y")
      AddFPControl("GYE,3,txt,gaye_pledges,organisation_number,850,100,1200,300,Employer Number:,2000,Enter the Employer Organisation Number,Y")
      AddFPControl("GYE,4,txt,gaye_pledges,work_address_number,1200,100,1200,300,Work Address:,2000,Specify the pledger's Work Address Number,Y")
      AddFPControl("GYE,5,txt,gaye_pledges,payroll_organisation_number,1550,100,1200,300,Payroll Organisation:,2000,Enter the Payroll Organisation Number,Y")
      AddFPControl("GYE,6,txt,gaye_pledges,paybill_address_number,1900,100,1200,300,Payroll Address:,2000,Specify the donor's Payroll Address Number,Y")
      AddFPControl("GYE,7,txt,gaye_pledges,agency_number,2250,100,1200,300,Agency Number:,2000,Enter the Agency Organisation Number,Y")
      AddFPControl("GYE,8,txt,gaye_pledges,source,2600,100,1200,300,Source:,2000,,Y")
      AddFPControl("GYE,9,txt,gaye_pledges,product,2950,100,1200,300,Product:,2000,,Y")
      AddFPControl("GYE,10,txt,gaye_pledges,rate,3300,100,1200,300,Rate:,2000,,Y")
      AddFPControl("GYE,11,txt,gaye_pledges,distribution_code,3650,100,1200,300,Distribution Code:,2000,,Y")
      AddFPControl("GYE,12,txt,gaye_pledges,payment_frequency,4000,100,1200,300,Payment Frequency:,2000,,Y")
      AddFPControl("GYE,13,txt,gaye_pledges,pledge_amount,4350,100,1200,300,Pledge Amount:,2000,Enter the amount of the pledge,Y")
      AddFPControl("GYE,14,txt,gaye_pledges,donor_id,4350,4000,1200,300,Donor ID:,1000,Enter the ID given to the donor by the Agency,Y")
      AddFPControl("GYE,15,dtp,gaye_pledges,start_date,4700,100,1500,300,Start Date:,2000,Specify the Pledge Start Date,Y")
      AddFPControl("GYE,16,txt,gaye_pledges,pfo_code,4700,4000,1200,300,PFO Code:,1000,Enter the PFO Code,Y")
      AddFPControl("GYE,17,txt,gaye_pledges,payroll_number,5050,100,2800,300,Payroll Number:,2000,Enter Payroll Number of the Donor,Y")
      'Give As You Earn Payments  (Pre Tax Payroll Giving)
      AddFPControl("GYP,1,hdr,none,none,100,100,4000,300,Enter the Pre Tax Payroll Giving Payment Details,0,,Y")
      AddFPControl("GYP,2,txt,gaye_pledges,gaye_pledge_number,500,100,1200,300,PG Pledge Number:,1900,Enter the PG Pledge Number,Y")
      AddFPControl("GYP,3,txt,batch_transactions,contact_number,900,100,1200,300,Contact Number:,1900,Enter the Contact Number of the Donor,Y")
      AddFPControl("GYP,4,txt,batch_transactions,address_number,1300,100,1200,300,Address Number:,1900,,Y")
      AddFPControl("GYP,5,txt,batch_transaction_analysis,source,1700,100,1200,300,Source:,1900,Enter a valid source code,Y")
      AddFPControl("GYP,6,txt,batch_transactions,mailing,2100,100,1200,300,Mailing:,1900,Enter a mailing code for the Thank You Letter,Y")
      AddFPControl("GYP,7,meb,batch_transactions,transaction_date,2500,100,1200,300,Transaction Date:,1900,Enter the date of the transaction,Y")
      AddFPControl("GYP,8,txt,batch_transactions,reference,2500,3450,2400,300,Reference:,1900,Enter any transaction reference,Y")
      AddFPControl("GYP,9,txt,gaye_pledges,donor_total,2900,100,1200,300,Donor Amount:,1900,Enter the Donors donation amount,Y")
      AddFPControl("GYP,10,txt,gaye_pledges,employer_total,2900,3450,1200,300,Employer Amount:,1900,Enter the Employers donation amount,Y")
      AddFPControl("GYP,11,txt,gaye_pledges,government_total,3300,100,1200,300,Government Contribution:,1900,Enter the amount of the Government contribution,Y")
      AddFPControl("GYP,12,txt,gaye_pledges,admin_fees_total,3300,3450,1200,300,Admin Fees:,1900,Enter the amount of any Admin Fees,Y")
      AddFPControl("GYP,13,lbl,batch_transactions,amount,3700,100,1200,300,Transaction Total:,1900,,Y")
      AddFPControl("GYP,14,chk,none,checkbox,4100,100,4000,280,Post Batch to Cash Book,1900,Post the batch to the Cash Book,Y")
      'Batch Invoice Generation
      AddFPControl("ING,0,hdr,none,none,100,100,4000,300,Specify the Parameters for the Generation of Invoices,2000,0,Y")
      AddFPControl("ING,1,txt,credit_customers,company,500,100,1200,300,Company:,1900,,Y")
      AddFPControl("ING,2,txtN,invoices,invoice_number,850,100,1200,300,From Invoice:,1900,,Y")
      AddFPControl("ING,3,txtN,invoices,invoice_number,1200,100,1200,300,To Invoice:,1900,,Y")
      AddFPControl("ING,4,dtp,invoices,invoice_date,1550,100,1200,300,From Date:,1900,,Y,,FromDate")
      AddFPControl("ING,5,dtp,invoices,invoice_date,1900,100,1200,300,To Date:,1900,,Y,,ToDate")
      AddFPControl("ING,6,txtN,batches,batch_number,2250,100,1200,300,Start Batch:,1900,Start Batch Number,N,,StartBatch")
      AddFPControl("ING,7,txtN,batches,batch_number,2600,100,1200,300,End Batch:,1900,End Batch Number,N,,EndBatch")
      AddFPControl("ING,8,chk,none,checkbox,2950,100,1200,300,Display Invoices,1900,,Y,,DisplayInvoices")
      AddFPControl("ING,9,chk,none,checkbox,2950,2000,1400,300,Part-paid Only,1900,,N,,PartPaidOnly")
      AddFPControl("ING,10,opt_N,none,run_type,3300,100,1500,300,New Invoices,1900,New invoices only,Y")
      AddFPControl("ING,11,opt_R,none,run_type,3300,2000,1500,300,Reprint Invoices,1900,Reprint invoices only,Y")
      AddFPControl("ING,12,opt_A,none,run_type,3300,3900,1500,300,All Invoices,1900,Both new invoices and reprint invoices,Y")
      'Batch Invoice Summary
      AddFPControl("INS,0,hdr,none,none,100,100,4000,300,Selected Invoices:,2000,0,Y")
      AddFPControl("INS,1,chk,none,checkbox,500,100,1200,300,Select All,1900,,Y,,SelectAll")
      AddFPControl("INS,2,chk,fp_applications,invoice_print_preview_default,500,2000,1200,300,Print Preview,1900,Preview Invoices before printing?,Y,,PrintPreview")
      'Legacy Bequest Receipt
      AddFPControl("LBR,1,hdr,none,none,100,100,4000,300,Enter Legacy Bequest Receipt Details,0,,Y")
      AddFPControl("LBR,2,txt,legacy_bequest_receipts,legacy_number,500,100,1200,300,Legacy Number:,2500,Enter the Legacy Number,Y")
      AddFPControl("LBR,3,txt,legacy_bequest_receipts,bequest_number,900,100,1200,300,Bequest Number:,2500,Enter the Legacy Bequest Number,Y")
      AddFPControl("LBR,4,txtN,legacy_bequest_receipts,amount,1300,100,1200,300,Amount:,2500,Enter the Amount of the Receipt,Y")
      AddFPControl("LBR,5,txtN,legacy_bequests,expected_value,1700,100,1200,300,Bequest Expected Value:,2500,,Y")
      AddFPControl("LBR,6,txtN,legacy_bequests,estimated_outstanding,2100,100,1200,300,Bequest Estimated Outstanding:,2500,,Y")
      AddFPControl("LBR,7,dtp,legacy_bequest_receipts,date_received,2500,100,1500,300,Date Received:,2500,Specify the Date of the Receipt,Y")
      AddFPControl("LBR,8,txt,legacy_bequest_receipts,notes,2900,100,6100,1800,Notes:,2500,Enter any Notes Regarding the Receipt,Y")
      'Loans
      AddFPControl("LON,1,hdr,none,none,100,100,4000,300,Enter Loan Details,0,,Y")
      AddFPControl("LON,2,dtp,orders,order_date,500,100,1200,300,Start Date:,1900,Enter the Start Date of the Loan,Y")
      AddFPControl("LON,3,txt,loans,loan_type,850,100,1200,300,Loan Type:,1900,Enter the type of Loan,Y")
      AddFPControl("LON,4,txtN,loans,loan_amount,1200,100,1200,300,Loan Amount:,1900,Enter the amount being loaned,Y")
      AddFPControl("LON,5,txt,orders,payment_frequency,1550,100,1200,300,Payment Frequency:,1900,Enter the payment frequency,Y")
      AddFPControl("LON,6,txtN,loans,interest_rate,1900,100,1200,300,Interest Rate:,1900,Enter the interest rate percentage,Y")
      AddFPControl("LON,7,txtN,loans,fixed_monthly_amount,2250,100,1200,300,Monthly Payment Amount:,1900,Enter the required fixed monthly payment amount,Y")
      AddFPControl("LON,8,txtN,loans,loan_term,2600,100,1200,300,Loan Term:,1900,Enter the required fixed number of years of the Loan,Y")
      AddFPControl("LON,9,txt,loans,source,2950,100,1200,300,Source:,1900,Enter the source of the Loan,Y")
      AddFPControl("LON,10,txt,orders,their_reference,3300,100,1200,300,Reference:,1900,Enter any loan reference,Y")
      AddFPControl("LON,11,txt,orders,sales_contact_number,3650,100,1200,300,Sales Contact:,1900,,Y")
      'Membership
      AddFPControl("MEM,1,hdr,none,none,100,100,4000,300,Enter Membership Details,0,,Y")
      AddFPControl("MEM,2,txt,members,membership_type,500,100,1200,300,Membership Type:,1700,,Y")
      AddFPControl("MEM,3,meb,members,joined,850,100,1200,300,Joined:,1700,,Y")
      AddFPControl("MEM,4,txt,members,number_of_members,850,3300,600,300,No of Members:,1700,,Y")
      AddFPControl("MEM,5,txt,membership_types,max_free_associates,850,6400,600,300,No of Associates:,1700,,Y")
      AddFPControl("MEM,6,chk,orders,gift_membership,1200,1800,2000,300,Gift Membership,0,,Y")
      AddFPControl("MEM,7,chk,orders,one_year_gift,1200,4000,2000,300,One Year Gift,0,,Y")
      AddFPControl("MEM,8,chk,new_orders,pack_to_donor,1200,6200,2200,300,Send Initial Pack to Donor,0,,Y")
      AddFPControl("MEM,9,opt_N,new_orders,gift_card_status,1600,1800,2000,300,No Gift Card,2000,,Y")
      AddFPControl("MEM,10,opt_B,new_orders,gift_card_status,1600,4000,2000,300,Blank Gift Card,2000,,Y")
      AddFPControl("MEM,11,opt_W,new_orders,gift_card_status,1600,6200,2000,300,Written Gift Card,2000,,Y")
      AddFPControl("MEM,12,txt,members,source,1950,100,1200,300,Source:,1700,,Y")
      AddFPControl("MEM,13,txt,members,contact_number,2300,100,1200,300,Member:,1700,,Y")
      AddFPControl("MEM,14,txt,members,address_number,2650,100,1200,300,Member Address:,1700,,Y")
      AddFPControl("MEM,15,txt,addresses,branch,3000,100,1200,300,Branch:,1700,,Y")
      AddFPControl("MEM,16,chk,members,branch_member,3350,1800,2000,300,Branch Member:,0,,Y")
      AddFPControl("MEM,17,meb,members,applied,3350,5000,1200,300,Applied:,1700,,Y")
      AddFPControl("MEM,18,chk,contacts,dob_estimated,3700,1800,2400,300,Estimated Date of Birth,0,,Y")
      AddFPControl("MEM,19,meb,contacts,date_of_birth,3700,5000,1200,300,Date of Birth,1700,,Y")
      AddFPControl("MEM,20,txt,members,age_override,4050,100,500,300,Age Override:,1700,,Y")
      AddFPControl("MEM,21,txt,batch_transaction_analysis,member_number,4050,5000,1200,300,Member Number:,1700,,Y")
      AddFPControl("MEM,22,txt,members,member_number,4500,100,1200,300,Affiliated Member:,1700,,Y")
      AddFPControl("MEM,23,chk,orders,pack_to_member,4500,5000,2700,300,Send Renewal Pack To Member,0,Send gift membership pack to the member,N")
      AddFPControl("MEM,24,txt,orders,giver_contact_number,4850,100,1200,300,Giver Contact:,1700,,Y")
      AddFPControl("MEM,25,txt,order_details,product,5200,100,500,300,Product:,1700,,N")
      AddFPControl("MEM,26,txt,order_details,rate,5550,100,500,300,Rate:,1700,,N")
      AddFPControl("MEM,27,txt,order_details,amount,5900,100,1000,300,Amount:,1700,Represents the Gross Membership Override Amount for Rates with a zero price,N")
      AddFPControl("MEM,28,txt,order_details,distribution_code,6250,100,1200,300,Distribution Code:,1700,,Y")
      AddFPControl("MEM,29,txt,orders,payment_frequency,6600,100,1200,300,Payment Frequency:,1700,,N")
      AddFPControl("MEM,30,txt,new_orders,gift_from,6950,100,4500,300,Gift From:,1700,,N")
      AddFPControl("MEM,31,txt,new_orders,gift_to,7300,100,4500,300,Gift To:,1700,,N")
      AddFPControl("MEM,32,txt,new_orders,gift_message,7650,100,4500,600,Gift Message:,1700,,N")
      AddFPControl("MEM,33,txt,members,membership_status,8000,100,1200,300,Membership Status:,1700,,N")
      AddFPControl("MEM,34,txt,order_details,net_fixed_amount,8350,100,1000,300,Net Amount:,1700,Net Membership Override Amount for VAT-exclusive Rates with a zero price,N")
      'Membership Payer
      AddFPControl("MSP,1,hdr,none,none,100,100,4000,300,Membership Payer Details,0,,Y")
      AddFPControl("MSP,2,txt,orders,contact_number,500,100,1200,300,Membership Payer:,2200,,Y")
      AddFPControl("MSP,3,txt,orders,address_number,850,100,1200,300,Address:,2200,,Y")
      'Advanced CMT
      AddFPControl("MTC,1,hdr,none,none,100,100,4000,300,Set Change Membership Type Details,0,,Y")
      AddFPControl("MTC,2,dgs,none,none,500,100,800,800,,0,Old Membership Lines|New Membership Lines,Y,,CMTDetailLines")
      'Token Selection
      AddFPControl("TKN,1,hdr,none,none,100,100,4000,300,Select Or Create Token:,0,,Y")
      AddFPControl("TKN,2,lst,contact_credit_cards,token_desc,500,100,3800,900,Select Token:,1600,,Y,,")
      AddFPControl("TKN,3,chk,none,checkbox,1500,100,3800,900,Add New Token,1600,,Y,,NewToken")
      AddFPControl("TKN,4,txt,contact_credit_cards,token_desc,1850,100,3800,900,Add New Token:,1600,,Y,,TokenDescription")
      'Outstanding Scheduled Payments
      AddFPControl("OSP,1,hdr,none,none,100,100,4000,300,Select the Scheduled Payments to be paid,0,,Y")
      AddFPControl("OSP,2,lbl,order_payment_schedule,amount_due,500,100,1200,300,Payment:,1200,,Y")
      AddFPControl("OSP,3,lbl,order_payment_schedule,amount_outstanding,500,3500,1200,300,Outstanding:,1200,,Y")
      AddFPControl("OSP,4,ssc,order_payment_schedule,scheduled_payment_number,900,100,8000,3500,Order|Payment|Due|Amount Due|Outstanding|Revised Amount|Pay?|Allocated+1|1000|1200|1200|1200|1200|500|1200,1900,,Y")
      'Postage & Packing - Carriage
      AddFPControl("PAP,1,hdr,none,none,100,100,4000,300,Enter the Postage and Packing,0,,Y")
      AddFPControl("PAP,2,txt,batch_transaction_analysis,product,500,100,1200,300,Product,2000,Enter a Postage and Packing Product,Y")
      AddFPControl("PAP,3,txt,batch_transaction_analysis,rate,850,100,1200,300,Rate,2000,,Y")
      AddFPControl("PAP,4,txt,cancellation_fees,percentage,1200,100,1200,300,Percentage,2000,Enter the Postage and Packing Percentage,Y")
      AddFPControl("PAP,5,lbl,batch_transactions,amount,1550,100,1200,300,Transaction Total,2000,,Y")
      AddFPControl("PAP,6,txt,batch_transaction_analysis,amount,1900,100,1200,300,Postage and Packing Amount,2000,Enter the Postage and Packing Amount,Y")
      'Payments
      AddFPControl("PAY,1,hdr,none,none,100,100,4000,300,Select the Payment Type and enter the Payment Reference,0,,Y")
      AddFPControl("PAY,2,txt,batch_transaction_analysis,member_number,500,100,1200,300,Member Number,2000,,Y")
      AddFPControl("PAY,3,txt,batch_transaction_analysis,covenant_number,850,100,1200,300,Covenant,2000,,Y")
      AddFPControl("PAY,4,txt,batch_transaction_analysis,order_number,1200,100,1200,300,Payment Plan,2000,,Y")
      AddFPControl("PAY,5,txt,batch_transactions,amount,1550,100,1200,300,Amount,2000,,Y")
      AddFPControl("PAY,6,chk,batch_transaction_analysis,accept_as_full,1900,2100,2400,300,Accept as Full,2000,,Y")
      AddFPControl("PAY,7,txt,batch_transaction_analysis,sales_contact_number,2250,100,1200,300,Sales Contact:,2000,Enter the Contact Number of the Sales Person,Y")
      'Public Collection Payments
      AddFPControl("PCP,1,hdr,none,none,100,100,4000,300,Enter the Appeal Collection details,0,,Y")
      AddFPControl("PCP,2,txt,appeal_collections,collection_number,500,100,1200,300,Collection Number:,2000,Enter the Appeal Collection Number,Y")
      AddFPControl("PCP,3,cbo,collection_pis,pis_number,900,100,2400,300,Paying In Slip Number:,2000,Select the PIS Number,Y")
      AddFPControl("PCP,4,txt,batch_transactions,amount,1300,100,1200,300,Amount:,2000,Enter the Collection payment amount,Y")
      AddFPControl("PCP,5,txt,batch_transaction_analysis,deceased_contact_number,1700,100,1200,300,Sent On Behalf Of:,2000,Enter the Contact Number on whose behalf the payment is made,Y")
      AddFPControl("PCP,6,txt,batch_transaction_analysis,notes,2100,100,4000,300,Comments:,2000,,Y")
      AddFPControl("PCP,7,ssc,collection_payments,collection_box_number,2600,100,8000,1000,Box No|Collector|Box Reference|Amount|Pay?+1|1|2400|1200|1200,1900,,Y")
      AddFPControl("PCP,8,txt,appeal_collections,product,4000,100,1200,300,Product:,2000,,N")
      AddFPControl("PCP,9,txt,appeal_collections,rate,4400,100,1200,300,Rate:,2000,,N")
      AddFPControl("PCP,10,txt,appeal_collections,source,4800,100,1200,300,Source:,2000,,N")
      AddFPControl("PCP,11,txt,appeal_collections,bank_account,5200,100,1200,300,Bank Account:,2000,,N")
      'Post Tax Payroll Giving
      AddFPControl("PGP,1,hdr,none,none,100,100,4000,300,Enter the Post Tax Payroll Giving payment details,0,,Y")
      AddFPControl("PGP,2,txt,post_tax_pg_pledges,pledge_number,500,100,1200,300,Pledge Number:,1900,Enter the Post Tax Payroll Giving Pledge number,Y")
      AddFPControl("PGP,3,txt,batch_transactions,contact_number,900,100,1200,300,Payer Contact Number:,1900,Enter the payers Contact Number,Y")
      AddFPControl("PGP,4,txt,batch_transactions,address_number,1300,100,1200,300,Address Number:,1900,,Y")
      AddFPControl("PGP,5,txt,batch_transaction_analysis,source,1700,100,1200,300,Source:,1900,Enter the Source code,Y")
      AddFPControl("PGP,6,txt,batch_transactions,mailing,2100,100,1200,300,Mailing:,1900,Enter the Mailing Code,Y")
      AddFPControl("PGP,7,meb,batch_transactions,transaction_date,2500,100,1200,300,Transaction Date:,1900,Enter the Transaction Date,Y")
      AddFPControl("PGP,8,txt,batch_transactions,reference,2500,3450,2400,300,Reference:,1900,Enter the Transaction Reference,Y")
      AddFPControl("PGP,9,txt,post_tax_pg_pledges,donor_total,2900,100,1200,300,Donor Amount:,1900,Enter the Donors donation amount,Y")
      AddFPControl("PGP,10,txt,post_tax_pg_pledges,employer_total,2900,3450,1200,300,Employer Amount:,1900,Enter any Employer matched giving amount,Y")
      AddFPControl("PGP,11,chk,none,checkbox,3300,100,4000,280,Post To Cash Book?,1900,Post the Batch to the Cash Book?,Y,,PostCashBook")
      AddFPControl("PGP,12,lbl,batch_transactions,amount,3700,100,1200,300,Transaction Total:,1900,,Y")
      'Purchase Invoice Details
      AddFPControl("PID,1,hdr,none,none,100,100,4000,300,Enter the Purchase Invoice details,0,,Y")
      AddFPControl("PID,2,txt,purchase_invoices,purchase_order_number,500,100,1200,300,Purchase Order:,1900,,Y")
      AddFPControl("PID,3,txt,purchase_invoices,contact_number,850,100,1200,300,Contact Number:,1900,,Y")
      AddFPControl("PID,4,txt,purchase_invoices,address_number,1200,100,1200,300,Address Number:,1900,,Y")
      AddFPControl("PID,5,txt,purchase_invoices,amount,1550,100,1200,300,Amount:,1900,,Y")
      AddFPControl("PID,6,txt,purchase_invoices,payee_contact_number,1900,100,1200,300,Payee Contact:,1900,,Y")
      AddFPControl("PID,7,txt,purchase_invoices,payee_address_number,2250,100,1200,300,Payee Address:,1900,,Y")
      AddFPControl("PID,8,txt,purchase_invoices,payee_reference,2600,100,2500,300,Payee Ref:,1900,,Y")
      AddFPControl("PID,9,dtp,purchase_invoices,purchase_invoice_date,2950,100,1500,300,Return Date:,1900,,Y")
      AddFPControl("PID,10,txt,purchase_invoices,campaign,3300,100,1200,300,Campaign:,1900,,Y")
      AddFPControl("PID,11,txt,purchase_invoices,appeal,3650,100,1200,300,Appeal:,1900,,Y")
      AddFPControl("PID,12,txt,purchase_invoices,segment,3900,100,1200,300,Segment:,1900,,Y")
      AddFPControl("PID,13,txt,purchase_invoices,currency_code,4350,100,1200,300,Currency:,1900,,N")
      'Purchase Invoice Products
      AddFPControl("PIP,1,hdr,none,none,100,100,4000,300,Enter the Purchase Invoice Analysis,0,,Y")
      AddFPControl("PIP,2,txt,purchase_invoice_details,line_item,500,100,4000,300,Item:,1900,,Y")
      AddFPControl("PIP,2,cbo,purchase_order_line_items,line_item,500,100,4000,300,Line Item:,1900,,N,,PILineItem")
      AddFPControl("PIP,3,txt,purchase_invoice_details,line_price,850,100,1200,300,Price:,1900,,Y")
      AddFPControl("PIP,4,txt,purchase_invoice_details,quantity,1200,100,1200,300,Quantity:,1900,,Y")
      AddFPControl("PIP,5,txt,purchase_invoice_details,amount,1550,100,1200,300,Amount:,1900,,Y")
      'Payment method choice 1
      AddFPControl("PM1,1,hdr,none,none,100,100,4000,300,Select the Payment Method,0,,Y")
      AddFPControl("PM1,2,cmd_CASH,none,none,600,100,4000,400,&Cash,0,,Y")
      AddFPControl("PM1,3,cmd_CHEQ,none,none,1100,100,4000,400,Che&que,0,,Y")
      AddFPControl("PM1,4,cmd_POST,none,none,1600,100,4000,400,&Postal Order,0,,Y")
      AddFPControl("PM1,5,cmd_CARD,none,none,2100,100,4000,400,C&redit or Debit Card,0,,Y")
      AddFPControl("PM1,6,cmd_CRED,none,none,2600,100,4000,400,Credit &Sale,0,,Y")
      AddFPControl("PM1,7,cmd_VOUC,none,none,3100,100,4000,400,&Voucher,0,,Y")
      AddFPControl("PM1,8,cmd_GFIK,none,none,3600,100,4000,400,&Gift In Kind,0,,Y")
      AddFPControl("PM1,9,cmd_CAFC,none,none,4100,100,4000,400,CA&F Card,0,,Y")
      AddFPControl("PM1,10,cmd_SAOR,none,none,4600,100,4000,400,S&ale Or Return,0,,Y")
      AddFPControl("PM1,11,cmd_CQIN,none,none,5100,100,4000,400,Che&que with Invoice,0,,Y")
      AddFPControl("PM1,12,cmd_CCIN,none,none,5600,100,4000,400,Cre&dit Card with Invoice,0,,Y")
      'Payment method choice 2
      AddFPControl("PM2,1,hdr,none,none,100,100,4000,300,Select Payment Type,0,,Y")
      AddFPControl("PM2,2,cmd_CURR,none,none,600,100,4000,400,&Current,0,,Y")
      AddFPControl("PM2,3,cmd_STDO,none,none,1100,100,4000,400,&Standing Order,0,,Y")
      AddFPControl("PM2,4,cmd_DIRD,none,none,1600,100,4000,400,&Direct Debit,0,,Y")
      AddFPControl("PM2,5,cmd_CCCA,none,none,2100,100,4000,400,Credit Card &Authority,0,,Y")
      AddFPControl("PM2,6,cmd_NPAY,none,none,2600,100,4000,400,&No Payment Required,0,,Y")
      'Payment Method 3; order conversion type
      AddFPControl("PM3,1,hdr,none,none,100,100,4000,300,Select Payment Plan Conversion Required,0,,Y")
      AddFPControl("PM3,2,cmd_COVT,none,none,450,2475,4000,400,Add Co&venant,0,,Y")
      AddFPControl("PM3,3,cmd_DIRD,none,none,900,2475,4000,400,Add &Direct Debit,0,,Y")
      AddFPControl("PM3,4,cmd_STDO,none,none,1350,2475,4000,400,Add &Standing Order,0,,Y")
      AddFPControl("PM3,5,cmd_CCCA,none,none,1800,2475,4000,400,Add &Continuous Credit Card,0,,Y")
      AddFPControl("PM3,6,cmd_CVDD,none,none,2250,2475,4000,400,Add Covenant and D&irect Debit,0,,Y")
      AddFPControl("PM3,7,cmd_CVSO,none,none,2700,2475,4000,400,Add Covenant and S&tanding Order,0,,Y")
      AddFPControl("PM3,8,cmd_CVCC,none,none,3150,2475,4000,400,Add Covenant and C&ontinuous Credit Card,0,,Y")
      AddFPControl("PM3,9,cmd_MEMB,none,none,3600,2475,4000,400,Add &Membership,0,,Y")
      AddFPControl("PM3,10,cmd_MAINT,none,none,4050,2475,4000,400,M&aintenance Only,0,,N")
      'Purchase Order Cancellation
      AddFPControl("POC,0,hdr,none,none,100,100,4000,300,Select the purchase orders to be cancelled,0,,Y")
      AddFPControl("POC,1,txt,purchase_orders,purchase_order_number,500,100,1200,300,First Number:,1900,,Y")
      AddFPControl("POC,2,txt,purchase_orders,purchase_order_number,850,100,1200,300,Last Number:,1900,,Y")
      AddFPControl("POC,3,txt,purchase_orders,cancellation_reason,1200,100,1200,300,Reason:,1900,,Y")
      AddFPControl("POC,4,txt,purchase_orders,cancellation_source,1550,100,1200,300,Source:,1900,,Y")
      AddFPControl("POC,5,meb,purchase_orders,cancelled_on,1900,100,1200,300,Date:,1900,,Y")
      'Purchase Order Details
      AddFPControl("POD,1,hdr,none,none,100,100,4000,300,Enter the Purchase Order details,0,,Y")
      AddFPControl("POD,2,txt,purchase_orders,contact_number,500,100,1200,300,Contact Number:,1900,,Y")
      AddFPControl("POD,3,txt,purchase_orders,address_number,850,100,1200,300,Address Number:,1900,,Y")
      AddFPControl("POD,4,txt,purchase_orders,amount,1200,100,1200,300,Amount:,1900,,Y")
      AddFPControl("POD,5,txt,purchase_orders,output_group,1550,100,1200,300,Output Group:,1900,,Y")
      AddFPControl("POD,6,txt,purchase_orders,purchase_order_type,1900,100,1200,300,Type:,1900,,Y")
      AddFPControl("POD,7,txt,purchase_orders,purchase_order_desc,2250,100,2500,300,Description:,1900,,Y")
      AddFPControl("POD,8,txt,purchase_orders,payee_contact_number,2600,100,1200,300,Payee Contact:,1900,,Y")
      AddFPControl("POD,9,txt,purchase_orders,payee_address_number,2950,100,1200,300,Payee Address:,1900,,Y")
      AddFPControl("POD,10,dtp,purchase_orders,start_date,3300,100,1400,300,Start Date:,1900,,Y")
      AddFPControl("POD,11,chk,none,checkbox,3300,4600,2000,300,Use Different payee,1900,,Y,,UseDifferentPayee")
      AddFPControl("POD,12,txt,purchase_orders,payment_frequency,3650,100,1200,300,Payment Frequency:,1900,,Y")
      AddFPControl("POD,13,txt,purchase_orders,number_of_payments,4000,100,1200,300,No Of Payments:,1900,,Y")
      AddFPControl("POD,14,opt_S,purchase_orders,distribution_method,4350,1950,2000,300,Sequential Distribution,1900,,Y")
      AddFPControl("POD,15,opt_P,purchase_orders,distribution_method,4350,4600,2000,300,Proportional Distribution,1900,,Y")
      AddFPControl("POD,16,chk,purchase_orders,payment_as_percentage,4700,1950,3000,300,Payments as Percentage:,1900,,Y")
      AddFPControl("POD,17,txt,purchase_orders,campaign,5050,100,1200,300,Campaign:,1900,,Y")
      AddFPControl("POD,18,txt,purchase_orders,appeal,5400,100,1200,300,Appeal:,1900,,Y")
      AddFPControl("POD,19,txt,purchase_orders,segment,5750,100,1200,300,Segment:,1900,,Y")
      AddFPControl("POD,20,txt,purchase_orders,currency_code,6100,100,1200,300,Currency:,1900,,N")
      'Purchase Order Products
      AddFPControl("POP,1,hdr,none,none,100,100,4000,300,Enter the Purchase Order Analysis,0,,Y")
      AddFPControl("POP,2,txt,purchase_order_details,line_item,500,100,4000,300,Item:,1900,,Y")
      AddFPControl("POP,3,cbo,purchase_order_line_items,line_item,500,100,4000,300,Line Item:,1900,,N,,POLineItem")
      AddFPControl("POP,4,txt,purchase_order_details,line_price,850,100,1200,300,Price:,1900,,Y")
      AddFPControl("POP,5,txt,purchase_order_details,quantity,1200,100,1200,300,Quantity:,1900,,Y")
      AddFPControl("POP,6,txt,purchase_order_details,amount,1550,100,1200,300,Amount:,1900,,Y")
      AddFPControl("POP,7,txt,purchase_order_details,nominal_account,1900,100,1200,300,Nominal Account:,1900,,Y")
      AddFPControl("POP,8,txt,purchase_order_details,distribution_code,2250,100,1200,300,Distribution Code:,1900,,Y")
      AddFPControl("POP,9,txt,purchase_order_details,product,2600,100,1200,300,Product:,1900,,Y")
      AddFPControl("POP,10,cbo,purchase_order_details,warehouse,2950,100,4000,300,Warehouse:,1900,,Y")
      'Purchase Order Payments
      AddFPControl("PPA,1,hdr,none,none,100,100,4000,300,Enter the Purchase Order Payments,0,,Y")
      AddFPControl("PPA,2,txt,purchase_order_payments,amount,500,100,1200,300,Amount:,1900,,Y")
      AddFPControl("PPA,3,txt,purchase_order_payments,percentage,850,100,1200,300,Percentage:,1900,,Y")
      AddFPControl("PPA,4,dtp,purchase_order_payments,due_date,1200,100,1500,300,Due Date:,1900,,Y")
      AddFPControl("PPA,5,dtp,purchase_order_payments,latest_expected_date,1550,100,1500,300,Expected Date:,1900,,Y")
      AddFPControl("PPA,6,chk,purchase_order_payments,authorisation_required,1900,100,3000,300,Authorisation:,1900,,Y")
      AddFPControl("PPA,7,txt,purchase_order_payments,po_payment_type,500,3400,3000,300,Payment Type:,1900,,Y")
      AddFPControl("PPA,8,txt,purchase_order_payments,distribution_code,850,3400,3000,300,Distribution Code:,1900,,Y")
      AddFPControl("PPA,9,txt,purchase_order_payments,nominal_account,1200,3400,3000,300,Nominal Account:,1900,,Y")
      AddFPControl("PPA,10,chk,purchase_order_payments,separate_payment,1550,3400,3000,300,Separate Payment:,1900,,Y")
      AddFPControl("PPA,11,chk,none,checkbox,1900,3400,3000,300,Apply to All:,1900,Select to apply Purchase Order Payment details to all the Payment Row,Y")
      AddFPControl("PPA,12,ssc,purchase_order_payments,payment_number,2250,100,8100,2400,Due Date|Expected Date|Amount|Percentage|Auth|Status|Posted|PI|ABy|AOn+1500|1500|1000|1000|900|1000|1000|1|1|1,1000,,Y")
      'Payment Plan details
      AddFPControl("PPD,1,hdr,none,none,100,100,4000,300,Enter the Payment Plan Details,0,,Y")
      AddFPControl("PPD,2,meb,orders,order_date,500,100,1200,300,Start Date,2000,,Y")
      AddFPControl("PPD,3,meb,orders,expiry_date,850,100,1200,300,Expiry Date,2000,,Y")
      AddFPControl("PPD,4,txt,orders,order_term,1200,100,1200,300,Term,2000,,Y")
      AddFPControl("PPD,5,txt,orders,amount,1550,100,1200,300,Fixed Amount,2000,Gross Fixed Amount,Y")
      AddFPControl("PPD,6,txt,orders,balance,1900,100,1200,300,Balance,2000,,Y")
      AddFPControl("PPD,7,txt,orders,source,2250,100,1200,300,Source,2000,,Y")
      AddFPControl("PPD,8,txt,orders,their_reference,2600,100,1200,300,Reference,2000,,Y")
      AddFPControl("PPD,9,txt,orders,payment_frequency,2950,100,1200,300,Payment Frequency,2000,,Y")
      AddFPControl("PPD,10,txt,orders,reason_for_despatch,3300,100,1200,300,Reason For Despatch,2000,,Y")
      AddFPControl("PPD,11,txt,orders,sales_contact_number,3650,100,1200,300,Sales Contact,2000,Enter the Contact Number of the Sales Person,Y")
      AddFPControl("PPD,12,txt,orders,renewal_amount,4000,100,1200,300,Renewal Amount,2000,,N")
      AddFPControl("PPD,13,chk,none,checkbox,4000,3400,2000,300,Use As First Amount,2000,Tick to use Renewal Amount as the First Amount. Untick to use Frequency Amount,N")
      AddFPControl("PPD,14,txt,orders,first_amount,4350,100,1200,300,First Amount,2000,,N")
      AddFPControl("PPD,15,chk,orders,eligible_for_gift_aid,4700,2100,2000,300,Eligible For Gift Aid,2000,Select if the Payment Plan is covered by Gift Aid,N")
      AddFPControl("PPD,16,chk,orders,one_off_payment,5050,2100,2000,300,One Off Payment,2000,Select if the Payment Plan is one-off expecting only one payment,N")
      AddFPControl("PPD,17,cbo,orders,start_month,5400,100,2000,300,Start Month,2000,Select the month that the payments are to start from,N")
      'Payment Plan Maintenance
      AddFPControl("PPM,1,hdr,none,none,100,100,4000,300,Amend the Payment Plan Details,0,,Y")
      AddFPControl("PPM,2,txt,orders,source,500,100,1200,300,Source,2000,,Y")
      AddFPControl("PPM,3,txt,orders,their_reference,850,100,1200,300,Reference,2000,,Y")
      AddFPControl("PPM,4,txt,orders,payment_frequency,1200,100,1200,300,Payment Frequency,2000,,Y")
      AddFPControl("PPM,5,txt,orders,reason_for_despatch,1550,100,1200,300,Reason For Despatch,2000,,Y")
      AddFPControl("PPM,6,txt,orders,giver_contact_number,1900,100,1200,300,Giver Contact,2000,,Y")
      AddFPControl("PPM,7,txt,orders,amount,2250,100,1200,300,Fixed Amount,2000,Gross Fixed Amount,Y")
      AddFPControl("PPM,8,txt,orders,balance,2600,100,1200,300,Balance,2000,,N")
      AddFPControl("PPM,9,txt,orders,payment_method,2950,100,1200,300,Payment Method,2000,,N")
      AddFPControl("PPM,10,chk,orders,eligible_for_gift_aid,3300,2100,2000,300,Eligible For Gift Aid,2000,Select if the Payment Plan is covered by Gift Aid,N")
      AddFPControl("PPM,11,chk,orders,pack_to_member,3650,2100,2700,300,Send Renewal Pack to Member,2000,Send gift membership pack to the member,N")
      AddFPControl("PPM,12,txt,new_orders,gift_from,4000,100,4500,300,Gift From:,2000,,N")
      AddFPControl("PPM,13,txt,new_orders,gift_to,4350,100,4500,300,Gift To:,2000,,N")
      AddFPControl("PPM,14,txt,new_orders,gift_message,4700,100,4500,600,Gift Message:,2000,,N")
      AddFPControl("PPM,15,chk,none,checkbox,5350,2100,2000,300,Write-off Missed Payments?,2000,Select if missed payments are to be written off,N,,WriteOffMissedPayments")
      AddFPControl("PPM,16,rdo,orders,renewal_date,5700,100,2000,300,Renewal Date:,2000,,N")
      AddFPControl("PPM,17,chk,orders,gift_membership,6050,2100,2000,300,Gift Membership,2000,,N")
      AddFPControl("PPM,18,chk,orders,one_year_gift,6400,2100,2000,300,One Year Gift,2000,Select if the membership is a one year gifted membership,N")
      'Payment Plan Details Maintenance
      AddFPControl("PPN,1,hdr,none,none,100,100,4000,300,Payment Plan Products,0,,Y")
      AddFPControl("PPN,2,txt,order_details,product,500,100,1200,300,Product:,2000,,Y")
      AddFPControl("PPN,3,txt,order_details,rate,850,100,1200,300,Rate:,2000,,Y")
      AddFPControl("PPN,4,txt,order_details,distribution_code,1200,100,1200,300,Distribution Code:,2000,,Y")
      AddFPControl("PPN,5,txt,order_details,quantity,1550,100,1200,300,Quantity:,2000,,Y")
      AddFPControl("PPN,6,txt,order_details,amount,1900,100,1200,300,Fixed Amount:,2000,Represents the Gross Override Amount for Rates with a zero price,Y")
      AddFPControl("PPN,7,txt,order_details,balance,2250,100,1200,300,Balance;,2000,,Y")
      AddFPControl("PPN,8,txt,order_details,arrears,2600,100,1200,300,Arrears:,2000,,Y")
      AddFPControl("PPN,9,txt,order_details,despatch_method,2950,100,1200,300,Despatch Method:,2000,,Y")
      AddFPControl("PPN,10,txt,order_details,source,3300,100,1200,300,Source:,2000,,Y")
      AddFPControl("PPN,11,txt,order_details,contact_number,3650,100,1200,300,Delivery Contact:,2000,,Y")
      AddFPControl("PPN,12,txt,order_details,address_number,4000,100,1200,300,Delivery Address:,2000,,Y")
      AddFPControl("PPN,13,txt,order_details,time_status,4350,100,1200,300,Time Status:,2000,,N")
      AddFPControl("PPN,14,txt,order_details,communication_number,4700,100,1200,300,Deliver To:,2000,,N")
      AddFPControl("PPN,15,meb,order_details,effective_date,5050,100,1200,300,Effective Date,2000,The date this Detail line is effective from,N")
      AddFPControl("PPN,16,meb,order_details,valid_from,5400,100,1200,300,Valid From:,2000,,N")
      AddFPControl("PPN,17,meb,order_details,valid_to,5750,100,1200,300,Valid To:,2000,,N")
      AddFPControl("PPN,18,txt,order_details,net_fixed_amount,6100,100,1200,300,Net Fixed Amount:,2000,Represents the Net Override Amount for Rates with a zero price,N")
      'Payment Plan products
      AddFPControl("PPP,1,hdr,none,none,100,100,4000,300,Enter Payment Plan Products,0,,Y")
      AddFPControl("PPP,2,txt,order_details,product,500,100,1200,300,Product:,2000,,Y")
      AddFPControl("PPP,3,txt,order_details,rate,850,100,1200,300,Rate:,2000,,Y")
      AddFPControl("PPP,4,txt,order_details,distribution_code,1200,100,1200,300,Distribution Code:,2000,,Y")
      AddFPControl("PPP,5,txt,order_details,quantity,1550,100,1200,300,Quantity:,2000,,Y")
      AddFPControl("PPP,6,txt,order_details,amount,1900,100,1200,300,Fixed Amount:,2000,Represents the Gross Override Amount for Rates with a zero price,Y")
      AddFPControl("PPP,7,txt,order_details,balance,2250,100,1200,300,Balance:,2000,,Y")
      AddFPControl("PPP,8,txt,order_details,arrears,2250,100,1200,300,Arrears:,2000,,N")
      AddFPControl("PPP,9,txt,order_details,despatch_method,2600,100,1200,300,Despatch Method:,2000,,Y")
      AddFPControl("PPP,10,txt,order_details,source,2950,100,1200,300,Source:,2000,,Y")
      AddFPControl("PPP,11,txt,order_details,contact_number,3300,100,1200,300,Delivery Contact:,2000,,Y")
      AddFPControl("PPP,12,txt,order_details,address_number,3650,100,1200,300,Delivery Address:,2000,,Y")
      AddFPControl("PPP,13,txt,order_details,communication_number,4000,100,1200,300,Deliver To:,2000,,N")
      AddFPControl("PPP,14,meb,order_details,valid_from,4350,100,1200,300,Valid From:,2000,,N")
      AddFPControl("PPP,15,meb,order_details,valid_to,4700,100,1200,300,Valid To:,2000,,N")
      AddFPControl("PPP,16,txt,order_details,net_fixed_amount,5050,100,1200,300,Net Fixed Amount:,2000,Represents the Net Override Amount for Rates with a zero price,N")
      'Product details
      AddFPControl("PRD,1,hdr,none,none,100,100,4000,300,Enter the Transaction Analysis,0,,Y")
      AddFPControl("PRD,2,txt,batch_transaction_analysis,product,500,100,1200,300,Product:,2000,,Y")
      AddFPControl("PRD,3,cbo,products,warehouse,825,100,3000,300,Warehouse:,2000,,Y")
      AddFPControl("PRD,4,lbl,products,last_stock_count,825,5800,1100,300,Total Stock:,1500,,Y")
      AddFPControl("PRD,5,txt,batch_transaction_analysis,rate,1200,100,1200,300,Rate:,2000,,Y")
      AddFPControl("PRD,6,txt,batch_transaction_analysis,distribution_code,1550,100,1200,300,Distribution Code:,2000,,Y")
      AddFPControl("PRD,7,txt,batch_transaction_analysis,quantity,1900,100,1200,300,Quantity:,2000,,Y")
      AddFPControl("PRD,8,txt,batch_transaction_analysis,amount,1900,3500,1200,300,Amount:,1000,,Y")
      AddFPControl("PRD,9,txt,batch_transaction_analysis,vat_amount,1900,6000,1200,300,VAT Amount:,1500,,N")
      AddFPControl("PRD,10,txt,batch_transaction_analysis,source,2250,100,1200,300,Source:,2000,,Y")
      AddFPControl("PRD,11,meb,batch_transaction_analysis,when,2600,100,1200,300,Date:,2000,,Y")
      AddFPControl("PRD,12,txt,batch_transaction_analysis,discount,2600,3500,1200,300,Discount:,1000,,N")
      AddFPControl("PRD,13,txt,batch_transaction_analysis,gross_amount,2600,6000,1200,300,Gross Amount:,1500,,N")
      AddFPControl("PRD,14,txt,batch_transaction_analysis,despatch_method,2950,100,1200,300,Despatch Method:,2000,,Y")
      AddFPControl("PRD,15,txt,batch_transaction_analysis,contact_number,3300,100,1200,300,Delivery Contact:,2000,,Y")
      AddFPControl("PRD,16,txt,batch_transaction_analysis,address_number,3680,100,1200,300,Delivery Address:,2000,,Y")
      AddFPControl("PRD,17,txt,batch_transaction_analysis,sales_contact_number,4040,100,1200,300,Sales Contact:,2000,Enter the Contact Number of the Sales Person,Y")
      AddFPControl("PRD,18,opt_G,batch_transaction_analysis,line_type,4400,2100,2000,300,In Memory of,2000,,Y")
      AddFPControl("PRD,19,opt_H,batch_transaction_analysis,line_type,4400,4400,2000,300,Contributed to by,2000,,Y")
      AddFPControl("PRD,20,opt_S,batch_transaction_analysis,line_type,4400,6700,2000,300,Sent by,2000,,Y")
      AddFPControl("PRD,21,txt,batch_transaction_analysis,deceased_contact_number,4760,100,1200,300,Contact:,2000,,Y")
      AddFPControl("PRD,22,txt,batch_transaction_analysis,notes,5110,100,4000,300,Comments:,2000,,Y")
      AddFPControl("PRD,23,txt,batch_transaction_analysis,product_number,5460,100,1200,300,Product Number:,2000,,Y")
      AddFPControl("PRD,24,txt,service_bookings,service_booking_number,5810,100,1200,300,Service Booking Number:,2000,,N")
      AddFPControl("PRD,25,txt,event_bookings,booking_number,6160,100,1200,300,Event Booking Number:,2000,Enter the Booking Number this product sale is to be linked to,N,,EventBookingNumber")
      AddFPControl("PRD,26,txt,batch_transactions,contact_number,6510,100,1200,300,Credited Contact:,2000,Enter the Contact Number of the Contact to be Credited,N,,CreditedContactNumber")
      'Scheduled Payments
      AddFPControl("SCP,1,hdr,none,none,100,100,4000,300,Confirm Scheduled Payments,0,,Y")
      AddFPControl("SCP,2,lbl,orders,balance,500,100,1200,300,Plan Amount:,1200,,Y")
      AddFPControl("SCP,3,lbl,order_payment_schedule,amount_outstanding,500,3500,1200,300,Payments:,1200,,Y")
      AddFPControl("SCP,4,ssc,order_payment_schedule,scheduled_payment_number,900,100,8000,3500,||No.|Status|Due|Claim|Amount Due|Outstanding|Exp Balance|Revised Amount+1|1|1000|1200|1200|1200|1200|1200|1200|1200,1900,,Y")
      'Set Status
      AddFPControl("STA,1,hdr,none,none,100,100,4000,300,Enter New Status,0,,Y")
      AddFPControl("STA,2,txt,contacts,contact_number,500,100,1200,300,Contact Number:,1900,Enter the Contact Number,Y")
      AddFPControl("STA,3,txt,contacts,address_number,900,100,1200,300,Address:,1900,,Y")
      AddFPControl("STA,4,txt,contacts,status,1300,100,1200,300,Current Status:,1900,Contact's Current Status,Y")
      AddFPControl("STA,5,txt,organisations,status,1700,100,1200,300,New Status:,1900,Enter New Status,Y")
      'Standing Order
      AddFPControl("STO,1,hdr,none,none,100,100,4000,300,Enter Standing Order Details,0,,Y")
      AddFPControl("STO,2,txt,bankers_orders,contact_number,500,100,1200,300,Contact Number,1800,,Y")
      AddFPControl("STO,3,txt,bankers_orders,address_number,850,100,1200,300,Address,1800,,Y")
      AddFPControl("STO,4,meb,contact_accounts,sort_code,1250,100,1200,300,Sort Code:,1800,,Y")
      AddFPControl("STO,5,txt,banks,branch_name,1250,3500,3800,300,Branch:,1300,,Y")
      AddFPControl("STO,6,txt,contact_accounts,account_number,1600,100,1500,300,Account Number:,1800,,Y")
      AddFPControl("STO,7,txt,contact_accounts,bic_code,1950,100,900,300,BIC Code:,1800,,N")
      AddFPControl("STO,8,ibn,contact_accounts,iban_number,1950,3500,2500,300,IBAN Number:,1300,,N")
      AddFPControl("STO,9,txt,contact_accounts,account_name,2300,100,4000,300,Account Name:,1800,,Y")
      AddFPControl("STO,10,txt,bankers_orders,bank_account,2650,100,1200,300,Bank Account:,1800,,Y")
      AddFPControl("STO,11,txt,bankers_orders,reference,3000,100,2400,300,Reference:,1800,,Y")
      AddFPControl("STO,12,txt,bankers_orders,amount,3350,100,1000,300,Amount:,1800,,Y")
      AddFPControl("STO,13,meb,bankers_orders,start_date,3700,100,1200,300,Start Date:,1800,,Y")
      AddFPControl("STO,14,txt,bankers_orders,source,4150,100,1200,300,Source:,1800,,Y")
      AddFPControl("STO,15,opt_B,bankers_orders,standing_order_type,4500,100,2000,300,Bank Standing Order,2000,,N")
      AddFPControl("STO,16,opt_C,bankers_orders,standing_order_type,4500,2100,2000,300,CAF Standing Order,2000,,N")
      'Add Suppression
      AddFPControl("SUP,1,hdr,none,none,100,100,4000,300,Enter Suppression Details,0,,Y")
      AddFPControl("SUP,2,txt,contacts,contact_number,500,100,1200,300,Contact Number:,1900,Enter the Contact Number,Y")
      AddFPControl("SUP,3,txt,contacts,address_number,900,100,1200,300,Address:,1900,,Y")
      AddFPControl("SUP,4,sup,contact_suppressions,mailing_suppression,1300,100,8600,3000,,,,Y")
      'Service Booking
      AddFPControl("SVC,1,hdr,none,none,100,100,4000,300,Enter the Service Booking details, 0,,Y")
      AddFPControl("SVC,2,txt,service_bookings,booking_contact_number,500,100,1200,300,Contact Number:, 1900,,Y")
      AddFPControl("SVC,3,txt,service_bookings,booking_address_number,850,100,1200,300,Address Number:, 1900,,Y")
      AddFPControl("SVC,4,txt,service_controls,contact_group,1200,100,1200,300,Service:, 1900,,Y")
      AddFPControl("SVC,5,txt,service_bookings,related_contact_number,1550,100,1200,300,Modifier Number:, 1900,,Y")
      AddFPControl("SVC,6,txt,contact_categories,quantity,1900,100,1200,300,Modifier Value:, 1900,,Y")
      AddFPControl("SVC,7,dtt,service_bookings,start_date,2250,100,1400,300,From Date:, 1900,,Y")
      AddFPControl("SVC,8,dtt,service_bookings,end_date,2250,4500,1400,300,To Date:, 1000,,Y")
      AddFPControl("SVC,9,txt,service_bookings,service_contact_number,2600,100,1200,300,Service Number:, 1900,,Y")
      AddFPControl("SVC,10,txt,service_products,product,2950,100,1200,300,Product:, 1900,,N")
      AddFPControl("SVC,11,txt,service_products,rate,2950,100,1200,300,Rate:, 1900,,Y")
      AddFPControl("SVC,12,txt,batch_transaction_analysis,amount,3300,100,1000,300,Amount:, 1900,,Y")
      AddFPControl("SVC,13,lbl,product_offers,activity_quantity,3300,3525,400,300,Free Entitlement:, 1900,,Y")
      AddFPControl("SVC,14,txt,product_offers,product_quantity,3300,6150,400,300,Use Entitlement:, 1900,,Y")
      AddFPControl("SVC,15,txt,service_bookings,sales_contact_number,3650,100,1200,300,Sales Contact:, 1900,,Y")
      AddFPControl("SVC,16,txt,batch_transaction_analysis,source,4000,100,1200,300,Source:,1900,,N")
      AddFPControl("SVC,17,txt,batch_transaction_analysis,discount,4350,100,1000,300,Discount:,1900,,N")
      AddFPControl("SVC,18,txt,batch_transaction_analysis,gross_amount,4700,100,1000,300,Gross Amount:,1900,,N")
      'Create Payment Plan on Unbalance Transaction
      AddFPControl("TPP,1,hdr,none,none,100,100,4000,300,Transaction Amount does not match current Line Total,0,,Y")
      AddFPControl("TPP,2,lbl,batch_transactions,amount,500,100,1500,300,Transaction Amount:,2000,,Y")
      AddFPControl("TPP,3,lbl,batch_transactions,line_total,500,3800,1500,300,Line Total:,1900,,Y")
      AddFPControl("TPP,4,cmd_TRAN,none,none,1000,100,4000,400,Change &Transaction Amount,0,,Y")
      AddFPControl("TPP,5,cmd_PLAN,none,none,1500,100,4000,400,&Create Payment Plan,0,,Y")
      'Transaction Analysis choice
      AddFPControl("TRA,1,hdr,none,none,100,100,4000,300,Select Analysis Type,0,,Y")
      AddFPControl("TRA,2,cmd_CMEM,none,none,500,100,4000,400,Create Mem&bership with Covenant,0,,Y")
      AddFPControl("TRA,3,cmd_CSUB,none,none,1000,100,4000,400,Create Subs&cription with Covenant,0,,Y")
      AddFPControl("TRA,4,cmd_CDON,none,none,1500,100,4000,400,Create Re&gular Donation with Covenant,0,,Y")
      AddFPControl("TRA,5,cmd_MEMB,none,none,2000,100,4000,400,Create &Membership,0,,Y")
      AddFPControl("TRA,6,cmd_SUBS,none,none,2500,100,4000,400,Create &Subscription,0,,Y")
      AddFPControl("TRA,7,cmd_DONR,none,none,3000,100,4000,400,Create &Regular Donation,0,,Y")
      AddFPControl("TRA,8,cmd_SALE,none,none,3500,100,4000,400,Pr&oduct Sale,0,,Y")
      AddFPControl("TRA,9,cmd_DONS,none,none,4000,100,4000,400,&Donation,0,,Y")
      AddFPControl("TRA,10,cmd_PAYM,none,none,4500,100,4000,400,Pa&yment,0,,Y")
      AddFPControl("TRA,11,cmd_EVNT,none,none,5000,100,4000,400,&Event Booking,0,,Y")
      AddFPControl("TRA,12,cmd_ACOM,none,none,5500,100,4000,400,&Accommodation Booking,0,,Y")
      AddFPControl("TRA,13,cmd_SRVC,none,none,6000,100,4000,400,Ser&vice Booking,0,,Y")
      AddFPControl("TRA,14,cmd_INVC,none,none,6500,100,4000,400,&Invoice Payment,0,,Y")
      AddFPControl("TRA,15,cmd_CRDN,none,none,7000,100,4000,400,Credit &Note,0,,Y")
      AddFPControl("TRA,16,cmd_MEMC,none,none,7500,100,4000,400,Change Membership &Type,0,,Y")   'CMT
      AddFPControl("TRA,17,cmd_LEGR,none,none,8000,100,4000,400,&Legacy Receipt,0,,Y")
      AddFPControl("TRA,18,cmd_AWAY,none,none,8500,100,4000,400,Gone A&way,0,,Y")
      AddFPControl("TRA,19,cmd_STAT,none,none,9000,100,4000,400,Stat&us,0,,Y")
      AddFPControl("TRA,20,cmd_GIFT,none,none,9500,100,4000,400,Gi&ft Aid Declaration,0,,Y")
      AddFPControl("TRA,21,cmd_ACTV,none,none,10000,100,4000,400,Activity,0,,Y")
      AddFPControl("TRA,22,cmd_SUPP,none,none,10500,100,4000,400,Su&ppression,0,,Y")
      AddFPControl("TRA,23,cmd_CANC,none,none,11000,100,4000,400,Cancel Payment Plan,0,,Y")
      AddFPControl("TRA,24,cmd_GAYE,none,none,11500,100,4000,400,Pre Tax Payroll Giving Pledge,0,,Y")
      AddFPControl("TRA,25,cmd_APAY,none,none,12000,100,4000,400,Auto Payment Maintenance,0,,Y")
      AddFPControl("TRA,26,cmd_ADDR,none,none,12500,100,4000,400,Address Maintenance,0,,Y")
      AddFPControl("TRA,27,cmd_CGAD,none,none,13000,100,4000,400,Cancel Gift Aid Declaration,0,,Y")
      AddFPControl("TRA,28,cmd_CSRT,none,none,13500,100,4000,400,Confirm Sale Or Return Transactions,0,,Y")
      AddFPControl("TRA,29,cmd_COLP,none,none,14000,100,4000,400,C&ollection Payment,0,,Y")
      AddFPControl("TRA,30,cmd_LOAN,none,none,14500,100,4000,400,Create Loan,0,,Y")
      AddFPControl("TRA,31,cmd_EXAM,none,none,15000,100,4000,400,E&xam Booking,0,,Y")
      'Transaction details
      AddFPControl("TRD,1,hdr,none,none,100,100,4000,300,Enter the Transaction Details,0,,Y")
      AddFPControl("TRD,2,txt,batch_transaction_analysis,member_number,500,100,1000,300,Member Number:,1900,,Y")
      AddFPControl("TRD,3,txt,batch_transaction_analysis,covenant_number,500,3450,1100,300,Covenant:,1000,,Y")
      AddFPControl("TRD,4,txt,batch_transaction_analysis,order_number,500,6000,1100,300,Payment Plan:,1300,,Y")
      AddFPControl("TRD,5,txt,batch_transactions,contact_number,850,100,1200,300,Contact Number:,1900,Enter the Contact Number for the Transaction,Y")
      AddFPControl("TRD,6,txt,batch_transactions,address_number,1200,100,1200,300,Address:,1900,,Y")
      AddFPControl("TRD,7,txt,batch_transactions,amount,1550,100,1200,300,Amount:,1900,Enter the transaction amount if known,Y")
      AddFPControl("TRD,8,txt,batch_transactions,reference,1550,3450,2400,300,Reference:,1100,,Y")
      AddFPControl("TRD,9,txt,batch_transaction_analysis,source,1900,100,1200,300,Source:,1900,Enter a valid source code,Y")
      AddFPControl("TRD,10,txt,batch_transactions,mailing,2300,100,1200,300,Mailing:,1900,Enter a mailing code for the Thank you Letter,Y")
      AddFPControl("TRD,11,chk,batch_transactions,receipt,2650,2000,1200,280,Receipt,1900,Select whether a receipt is required,Y")
      AddFPControl("TRD,12,chk,batch_transactions,eligible_for_gift_aid,2650,3300,1200,280,Gift Aid,1900,Select if covered by Gift Aid,Y")
      AddFPControl("TRD,13,meb,batch_transactions,transaction_date,2650,4600,1200,300,Transaction Date:,1800,Enter the date of the transaction,Y")
      AddFPControl("TRD,14,txt,batch_transactions,mailing_contact_number,3000,100,1200,300,Mailing Contact:,1900,Enter the Contact Number for the Mailing,Y")
      AddFPControl("TRD,15,txt,batch_transactions,mailing_address_number,3350,100,1200,300,Mailing Address:,1900,,Y")
      AddFPControl("TRD,16,txt,batch_transaction_analysis,sales_contact_number,3700,100,1200,300,Sales Contact:,1900,Enter the Contact Number of the Sales Person,Y")
      AddFPControl("TRD,17,lbl,members,contact_number,4050,100,6700,300,Member:,1900,,N,,MemberContactNumber")
      AddFPControl("TRD,18,lbl,members,address_number,4400,100,6700,300,Member Address:,1900,,N,,MemberAddressNumber")
      AddFPControl("TRD,19,lbl,membership_types,membership_type_desc,4750,100,6700,300,Member Type:,1900,,N")
      AddFPControl("TRD,20,lbl,statuses,status_desc,5100,100,6700,300,Member Status:,1900,,N")
      AddFPControl("TRD,21,lbl,members,membership_card_expires,5450,100,1200,300,Card Expires:,1900,,N")
      AddFPControl("TRD,22,lbl,orders,renewal_date,5450,3500,1200,300,Renewal Date:,1900,,N")
      AddFPControl("TRD,23,lbl,orders,next_payment_due,5800,100,1200,300,Next Payment Due:,1900,,N")
      AddFPControl("TRD,24,lbl,payment_methods,payment_method_desc,5800,3500,3300,300,Payment Method:,1900,,N")
      AddFPControl("TRD,25,meb,contacts,date_of_birth,6150,100,1200,300,Date Of Birth:,1900,,N")
      AddFPControl("TRD,26,ssc,contact_categories,activity,6500,100,6700,300,|||||Activity|Activity Value|Quantity+1|1|1|1|1|3300|3200|1200,1900,,N")
      If GetFieldLength("fp_controls", "control_caption") > 80 Then
        AddFPControl("TRD,27,ssc,financial_history,transaction_number,6850,100,6700,300,Batch|Trans|Type|Date|Amount|Pay Meth|Ref|Posted+700|700|700|1200|1000|1000|1500|1200,1900,,N")
      End If
      AddFPControl("TRD,28,chk,batches,provisional,7200,2000,1200,280,Provisional,1900,Select whether the transaction is provisional or confirmed,Y")
      AddFPControl("TRD,29,txt,confirmed_transactions,additional_reference_1,7550,100,2400,300,Additional Reference 1:,1900,,N")
      AddFPControl("TRD,30,txt,confirmed_transactions,additional_reference_2,7900,100,2400,300,Additional Reference 2:,1900,,N")
      AddFPControl("TRD,31,ssc,contact_links,relationship,9250,100,6700,300,||Relationship|To|Valid From|Valid To|Historical+1|1|2000|2000|1200|1200|1000,1900,,N")
      AddFPControl("TRD,32,txt,batch_transaction_analysis,product_number,9600,100,1000,300,Product Number:,1900,,N")
      AddFPControl("TRD,33,txt,batch_transactions,transaction_origin,9950,100,1200,300,Transaction Origin:,1900,Enter a valid transaction origin code,N")
      AddFPControl("TRD,34,txt,batch_transactions,notes,4150,100,4000,2500,Comments,1900,,N")
      AddFPControl("TRD,35,txt_ro,contacts,status,10300,100,1200,300,Payer Status:,1900,Enter the status for the Contact if required,N,,ContactStatus")
      AddFPControl("TRD,36,txt_ro,contacts,status_reason,10650,100,4000,900,Payer Status Reason:,1900,,N")

      SetTraderVersionNumber(pOldVersionNumber, pNewVersionNumber)
    End Sub

    Private Sub AddFPAppType(ByVal pData As String)
      Dim vCount As Integer
      Dim vInsertFields As New CDBFields
      Dim vArray(2) As String

      vCount = BuildArrayFromList(vArray, pData)
      With vInsertFields
        .Add("amended_on", CDBField.FieldTypes.cftDate, TodaysDate)
        .Add("amended_by", CDBField.FieldTypes.cftCharacter, If(String.IsNullOrWhiteSpace(mvEnv.User.Logname), "dbinit", mvEnv.User.Logname))
        .Add("fp_application_type", CDBField.FieldTypes.cftCharacter, vArray(0))
        .Add("fp_application_type_desc", CDBField.FieldTypes.cftCharacter, vArray(1))
      End With
      mvEnv.Connection.InsertRecord("fp_application_types", vInsertFields)
    End Sub

    Private Sub AddFPApp(ByVal pData As String)
      Dim vInsertFields As New CDBFields
      Dim vArray() As String

      vArray = Split(pData, ",")
      With vInsertFields
        .Add("amended_on", CDBField.FieldTypes.cftDate, TodaysDate)
        .Add("amended_by", CDBField.FieldTypes.cftCharacter, If(String.IsNullOrWhiteSpace(mvEnv.User.Logname), "dbinit", mvEnv.User.Logname))
        .Add("fp_application", CDBField.FieldTypes.cftCharacter, vArray(0))
        .Add("fp_application_desc", CDBField.FieldTypes.cftCharacter, vArray(1))
        .Add("fp_application_type", CDBField.FieldTypes.cftCharacter, vArray(2))
        .Add("batch_application", CDBField.FieldTypes.cftCharacter, vArray(3))
        .Add("pm_cash", CDBField.FieldTypes.cftCharacter, vArray(4))
        .Add("pm_cheque", CDBField.FieldTypes.cftCharacter, vArray(5))
        .Add("pm_postal_order", CDBField.FieldTypes.cftCharacter, vArray(6))
        .Add("pm_credit_card", CDBField.FieldTypes.cftCharacter, vArray(7))
        .Add("pm_debit_card", CDBField.FieldTypes.cftCharacter, vArray(8))
        .Add("pm_credit", CDBField.FieldTypes.cftCharacter, vArray(9))
        .Add("bank_details", CDBField.FieldTypes.cftCharacter, vArray(10))
        .Add("transaction_comments", CDBField.FieldTypes.cftCharacter, vArray(11))
        .Add("memberships", CDBField.FieldTypes.cftCharacter, vArray(12))
        .Add("subscriptions", CDBField.FieldTypes.cftCharacter, vArray(13))
        .Add("donations_regular", CDBField.FieldTypes.cftCharacter, vArray(14))
        .Add("product_sales", CDBField.FieldTypes.cftCharacter, vArray(15))
        .Add("donations_one_off", CDBField.FieldTypes.cftCharacter, vArray(16))
        .Add("payments", CDBField.FieldTypes.cftCharacter, vArray(17))
        .Add("standing_orders", CDBField.FieldTypes.cftCharacter, vArray(18))
        .Add("direct_debits", CDBField.FieldTypes.cftCharacter, vArray(19))
        .Add("credit_card_authorities", CDBField.FieldTypes.cftCharacter, vArray(20))
        .Add("covenant_membership", CDBField.FieldTypes.cftCharacter, vArray(21))
        .Add("covenant_subscription", CDBField.FieldTypes.cftCharacter, vArray(22))
        .Add("covenant_donation_regular", CDBField.FieldTypes.cftCharacter, vArray(23))
        .Add("event_booking", CDBField.FieldTypes.cftCharacter, vArray(24))
        .Add("accomodation_booking", CDBField.FieldTypes.cftCharacter, vArray(25))
        .Add("product", CDBField.FieldTypes.cftCharacter, vArray(26))
        .Add("rate", CDBField.FieldTypes.cftCharacter, vArray(27))
        .Add("source", CDBField.FieldTypes.cftCharacter, vArray(28))
        .Add("ca_bank_account", CDBField.FieldTypes.cftCharacter, vArray(29))
        .Add("cc_bank_account", CDBField.FieldTypes.cftCharacter, vArray(30))
        .Add("dc_bank_account", CDBField.FieldTypes.cftCharacter, vArray(31))
        .Add("cs_bank_account", CDBField.FieldTypes.cftCharacter, vArray(32))
        .Add("so_bank_account", CDBField.FieldTypes.cftCharacter, vArray(33))
        .Add("dd_bank_account", CDBField.FieldTypes.cftCharacter, vArray(34))
        .Add("cca_bank_account", CDBField.FieldTypes.cftCharacter, vArray(35))
        .Add("read_only", CDBField.FieldTypes.cftCharacter, vArray(36))
        .Add("show_transaction_reference", CDBField.FieldTypes.cftCharacter, vArray(37))
        .Add("confirm_default_product", CDBField.FieldTypes.cftCharacter, vArray(38))
        .Add("confirm_analysis", CDBField.FieldTypes.cftCharacter, vArray(39))
        .Add("carriage", CDBField.FieldTypes.cftCharacter, vArray(40))
        .Add("confirm_carriage", CDBField.FieldTypes.cftCharacter, vArray(41))
        .Add("analysis_comments", CDBField.FieldTypes.cftCharacter, vArray(42))
        .Add("non_paid_payment_plans", CDBField.FieldTypes.cftCharacter, vArray(43))
        .Add("service_bookings", CDBField.FieldTypes.cftCharacter, vArray(44))
        .Add("pay_methods_at_end", CDBField.FieldTypes.cftCharacter, vArray(45))
        .Add("pay_plan_pay_method", CDBField.FieldTypes.cftCharacter, vArray(46))
        .Add("invoice_payments", CDBField.FieldTypes.cftCharacter, vArray(47))
        .Add("sundry_credit_notes", CDBField.FieldTypes.cftCharacter, vArray(48))
        .Add("foreign_currency", CDBField.FieldTypes.cftCharacter, vArray(49))
        .Add("members_only", CDBField.FieldTypes.cftCharacter, vArray(50))
        .Add("change_membership", CDBField.FieldTypes.cftCharacter, vArray(51))
        .Add("auto_set_amount", CDBField.FieldTypes.cftCharacter, vArray(52))
        .Add("service_booking_credits", CDBField.FieldTypes.cftCharacter, vArray(53))
        .Add("legacy_receipts", CDBField.FieldTypes.cftCharacter, vArray(54))
        .Add("set_gone_away", CDBField.FieldTypes.cftCharacter, vArray(55))
        .Add("set_status", CDBField.FieldTypes.cftCharacter, vArray(56))
        .Add("status", CDBField.FieldTypes.cftCharacter, vArray(57))
        .Add("gift_aid_declaration", CDBField.FieldTypes.cftCharacter, vArray(58))
        .Add("add_activity", CDBField.FieldTypes.cftCharacter, vArray(59))
        .Add("activity_group", CDBField.FieldTypes.cftCharacter, vArray(60))
        .Add("add_suppression", CDBField.FieldTypes.cftCharacter, vArray(61))
        .Add("mailing_suppression", CDBField.FieldTypes.cftCharacter, vArray(62))
        .Add("cancel_payment_plan", CDBField.FieldTypes.cftCharacter, vArray(63))
        .Add("cancellation_reason", CDBField.FieldTypes.cftCharacter, vArray(64))
        .Add("confirm_details", CDBField.FieldTypes.cftCharacter, vArray(65))
        .Add("distribution_code_mandatory", CDBField.FieldTypes.cftCharacter, vArray(66))
        .Add("include_provisional_trans", CDBField.FieldTypes.cftCharacter, vArray(67))
        .Add("include_confirmed_trans", CDBField.FieldTypes.cftCharacter, vArray(68))
        .Add("pm_voucher", CDBField.FieldTypes.cftCharacter, vArray(69))
        .Add("pm_caf_card", CDBField.FieldTypes.cftCharacter, vArray(70))
        .Add("pm_gift_in_kind", CDBField.FieldTypes.cftCharacter, vArray(71))
        .Add("cv_bank_account", CDBField.FieldTypes.cftCharacter, vArray(72))
        .Add("payroll_giving", CDBField.FieldTypes.cftCharacter, vArray(73))
        .Add("source_from_last_mailing", CDBField.FieldTypes.cftCharacter, vArray(74))
        .Add("mailing_code_mandatory", CDBField.FieldTypes.cftCharacter, vArray(75))
        .Add("bypass_mailing_paragraphs", CDBField.FieldTypes.cftCharacter, vArray(76))
        .Add("address_maintenance", CDBField.FieldTypes.cftCharacter, vArray(77))
        .Add("auto_payment_maintenance", CDBField.FieldTypes.cftCharacter, vArray(78))
        .Add("gift_aid_cancellation", CDBField.FieldTypes.cftCharacter, vArray(79))
        .Add("non_financial_batch", CDBField.FieldTypes.cftCharacter, vArray(80))
        .Add("pm_sale_or_return", CDBField.FieldTypes.cftCharacter, vArray(81))
        .Add("provisional_payment_plan", CDBField.FieldTypes.cftCharacter, vArray(82))
        .Add("default_member_branch", CDBField.FieldTypes.cftCharacter, vArray(83))
        .Add("prefulfilled_incentives", CDBField.FieldTypes.cftCharacter, vArray(84))
        .Add("display_scheduled_payments", CDBField.FieldTypes.cftCharacter, vArray(85))
        .Add("confirm_sr_transactions", CDBField.FieldTypes.cftCharacter, vArray(86))
        .Add("online_cc_authorisation", CDBField.FieldTypes.cftCharacter, vArray(87))
        .Add("pp_conversion_incl_maintenance", CDBField.FieldTypes.cftCharacter, vArray(88))
        .Add("link_to_communication", CDBField.FieldTypes.cftCharacter, vArray(89))
        .Add("collection_payments", CDBField.FieldTypes.cftCharacter, vArray(90))
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbDataEventMultipleAnalysis) Then .Add("event_multiple_analysis", CDBField.FieldTypes.cftCharacter, vArray(91))
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbDataAlbacsBankDetails) Then .Add("albacs_bank_details", CDBField.FieldTypes.cftCharacter, vArray(92))
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbDataFundraisingPayments) Then .Add("link_to_fundraising_payments", CDBField.FieldTypes.cftCharacter, vArray(93))
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbSalesContactMandatory) Then .Add("sales_contact_mandatory", CDBField.FieldTypes.cftCharacter, vArray(94))
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbTraderInvoicePrintPreview) Then .Add("invoice_print_preview_default", CDBField.FieldTypes.cftCharacter, vArray(95))
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbLoans) Then .Add("loans", CDBField.FieldTypes.cftCharacter, vArray(96))
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbExams) Then .Add("exam_booking", CDBField.FieldTypes.cftCharacter, vArray(97))
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbDataInvoiceWithPayment) Then
          .Add("cheque_with_invoice", CDBField.FieldTypes.cftCharacter, vArray(98))
          .Add("cc_with_invoice", CDBField.FieldTypes.cftCharacter, vArray(99))
        End If
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbAutoCreateCreditCustomer) Then .Add("auto_create_credit_customer", CDBField.FieldTypes.cftCharacter, vArray(100))
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbUnpostedBatchMsgInPrint) Then
          .Add("unposted_batch_msg_in_print", CDBField.FieldTypes.cftCharacter, vArray(101))
          .Add("date_range_msg_in_print", CDBField.FieldTypes.cftCharacter, vArray(102))
        End If
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbDataContactAlerts) Then
          .Add("contact_alerts", CDBField.FieldTypes.cftCharacter, vArray(103))
        End If
        If mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbTraderInvoicePrintUnpostedBatches) Then .Add("invoice_print_unposted_batches", CDBField.FieldTypes.cftCharacter, vArray(104))
        .Add("require_cc_authorisation", CDBField.FieldTypes.cftCharacter, "N")
        .Add("auto_gift_aid_declaration", CDBField.FieldTypes.cftCharacter, "N")
      End With
      mvEnv.Connection.InsertRecord("fp_applications", vInsertFields)
    End Sub

    Private Sub AddFPControl(ByVal pData As String)
      Dim vInsertFields As New CDBFields
      Dim vArray() As String

      vArray = Split(pData, ",")
      With vInsertFields
        .Add("fp_page_type", CDBField.FieldTypes.cftCharacter, vArray(0))
        .Add("sequence_number", CDBField.FieldTypes.cftLong, vArray(1))
        .Add("control_type", CDBField.FieldTypes.cftCharacter, vArray(2))
        .Add("table_name", CDBField.FieldTypes.cftCharacter, vArray(3))
        .Add("attribute_name", CDBField.FieldTypes.cftCharacter, vArray(4))
        .Add("control_top", CDBField.FieldTypes.cftLong, vArray(5))
        .Add("control_left", CDBField.FieldTypes.cftLong, vArray(6))
        .Add("control_width", CDBField.FieldTypes.cftLong, vArray(7))
        .Add("control_height", CDBField.FieldTypes.cftLong, vArray(8))
        .Add("control_caption", CDBField.FieldTypes.cftCharacter, vArray(9))
        .Add("caption_width", CDBField.FieldTypes.cftInteger, vArray(10))
        .Add("help_text", CDBField.FieldTypes.cftCharacter, vArray(11))
        .Add("visible", CDBField.FieldTypes.cftCharacter, vArray(12))
        If UBound(vArray) > 12 Then .Add("resource_id", CDBField.FieldTypes.cftLong, vArray(13))
        If UBound(vArray) > 13 Then .Add("parameter_name", CDBField.FieldTypes.cftCharacter, vArray(14))
      End With
      mvEnv.Connection.InsertRecord("fp_controls", vInsertFields)
    End Sub

    Private Sub AddTraderApp(ByVal pType As NewTraderApp)
      Dim vAppNumber As Integer
      Dim vCount As Integer
      Dim vWhereFields As New CDBFields

      'Fields for AddFPApp
      'fp_application, fp_application_desc, fp_application_type, batch_application
      'pm_cash, pm_cheque, pm_postal_order, pm_credit_card, pm_debit_card, pm_credit
      'bank_details, transaction_comments, memberships, subscriptions, donations_regular
      'product_sales, donations_one_off, payments, standing_orders, direct_debits, credit_card_authorities
      'covenant_membership, covenant_subscription, covenant_donation_regular, event_booking, accomodation_booking
      'product, rate, source, ca_bank_account, cc_bank_account, dc_bank_account, cs_bank_account, so_bank_account
      'dd_bank_account, cca_bank_account, read_only, show_transaction_reference, confirm_default_product
      'confirm_analysis, carriage, confirm_carriage, analysis_comments, non_paid_payment_plans, service_bookings
      'pay_methods_at_end, pay_plan_pay_method, invoice_payments, sundry_credit_notes, foreign_currency
      'members_only, change_membership, auto_set_amount, service_booking_credits, legacy_receipts
      'set_gone_away, set_status, status, gift_aid_declaration, add_activity, activity_group, add_suppression
      'mailing_suppression, cancel_payment_plan, cancellation_reason, confirm_details, distribution_code_mandatory
      'include_provisional_trans,  include_confirmed_trans,  pm_voucher,  pm_caf_card,  pm_gift_in_kind
      'cv_bank_account, contact_alerts, invoice_print_unposted_batches
      '
      Select Case pType
        Case NewTraderApp.ntaCashBatchMaint
          AddFPApp("1,Cash Batch Maintenance,TRANS,Y,Y,Y,Y,N,N,N,Y,Y,Y,Y,Y,Y,Y,Y,N,N,N,N,N,N,Y,Y,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,Y,Y,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
        Case NewTraderApp.ntaCreditSales
          AddFPApp("2,Credit Sales,TRANS,Y,N,N,N,N,N,Y,N,Y,Y,Y,Y,Y,Y,Y,N,N,N,N,N,N,Y,Y,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,Y,Y,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
        Case NewTraderApp.ntaCreditCardSales
          AddFPApp("3,Credit Card Sales,TRANS,Y,N,N,N,Y,N,N,N,Y,Y,Y,Y,Y,Y,Y,N,N,N,N,N,N,Y,Y,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,Y,Y,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
        Case NewTraderApp.ntaDebitCardSales
          AddFPApp("4,Debit Card Sales,TRANS,Y,N,N,N,N,Y,N,N,Y,Y,Y,Y,Y,Y,Y,N,N,N,N,N,N,Y,Y,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,Y,Y,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
        Case NewTraderApp.ntaGeneralTransactions
          AddFPApp("5,General Transactions,TRANS,N,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,Y,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,Y,Y,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
        Case NewTraderApp.ntaPayPlanConversion
          AddFPApp("6,Payment Plan Conversion,CNVRT,N,N,N,N,N,N,N,N,N,Y,Y,Y,N,N,N,Y,Y,Y,Y,Y,Y,N,N,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,N,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
          vWhereFields.Add("config_name", CDBField.FieldTypes.cftCharacter, "trader_application_conversion")
          vCount = mvEnv.Connection.GetCount("config", vWhereFields)
          If vCount = 0 Then
            mvEnv.SetConfig("trader_application_conversion", "6", True)
          End If
        Case NewTraderApp.ntaPayPlanMaint
          'Only add if config does not exist (ie Maint App does not exist)
          vWhereFields.Add("config_name", CDBField.FieldTypes.cftCharacter, "trader_application_maintenance")
          vCount = mvEnv.Connection.GetCount("config", vWhereFields)
          If vCount = 0 Then
            vAppNumber = mvEnv.GetControlNumber("TA")
            AddFPApp(Format$(vAppNumber) & ",Payment Plan Maintenance,MAINT,N,N,N,N,N,N,N,N,N,Y,Y,Y,N,N,N,Y,Y,Y,Y,Y,Y,N,N,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,N,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
            mvEnv.SetConfig("trader_application_maintenance", CStr(vAppNumber), True)
          End If
        Case NewTraderApp.ntaChangeMembership
          'Only add if config does not exist (ie Change Membership App does not exist)
          'CMT SWITCH
          vWhereFields.Add("config_name", CDBField.FieldTypes.cftCharacter, "trader_application_cmt")
          vCount = mvEnv.Connection.GetCount("config", vWhereFields)
          If vCount = 0 Then
            vAppNumber = mvEnv.GetControlNumber("TA")
            AddFPApp(Format$(vAppNumber) & ",Change Membership Type,TRANS,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,Y,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
            mvEnv.SetConfig("trader_application_cmt", vAppNumber.ToString, True)
          End If
        Case NewTraderApp.ntaFinancialAdjustments
          'Only add if config does not exist.  No special app is req'd for this - it uses General Transactions
          vWhereFields.Add("config_name", CDBField.FieldTypes.cftCharacter, "trader_application_fa")
          vCount = mvEnv.Connection.GetCount("config", vWhereFields)
          If vCount = 0 Then mvEnv.SetConfig("trader_application_fa", CStr(NewTraderApp.ntaGeneralTransactions))
        Case NewTraderApp.ntaTransactionConfirmation
          'Only add if config does not exist.  No special app is req'd for this - it uses General Transactions
          vWhereFields.Add("config_name", CDBField.FieldTypes.cftCharacter, "trader_application_conf")
          vCount = mvEnv.Connection.GetCount("config", vWhereFields)
          If vCount = 0 Then mvEnv.SetConfig("trader_application_conf", CStr(NewTraderApp.ntaGeneralTransactions))
        Case NewTraderApp.ntaCreditListReconciliation
          vWhereFields.Add("fp_application_type", CDBField.FieldTypes.cftCharacter, "CLREC")
          vCount = mvEnv.Connection.GetCount("fp_applications", vWhereFields)
          If vCount = 0 Then
            vAppNumber = mvEnv.GetControlNumber("TA")
            AddFPApp(Format$(vAppNumber) & ",Credit List Reconciliation,CLREC,Y,Y,N,N,N,N,N,Y,N,Y,Y,Y,Y,Y,Y,Y,N,N,N,N,N,Y,Y,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,Y,Y,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
          End If
        Case NewTraderApp.ntaBankStatementPosting
          vWhereFields.Add("fp_application_type", CDBField.FieldTypes.cftCharacter, "BSPOS")
          vCount = mvEnv.Connection.GetCount("fp_applications", vWhereFields)
          If vCount = 0 Then
            vAppNumber = mvEnv.GetControlNumber("TA")
            AddFPApp(Format$(vAppNumber) & ",Bank Statement Posting,BSPOS,Y,Y,N,N,N,N,N,Y,N,Y,Y,Y,Y,Y,Y,Y,N,N,N,N,N,Y,Y,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,Y,Y,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
          End If
        Case NewTraderApp.ntaGiveAsYouEarnPayments
          AddFPApp("7,Pre Tax Payroll Giving Payments,GAYEP,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
        Case NewTraderApp.ntaPurchaseOrderMaint
          'Only add if config does not exist (ie Maint App does not exist)
          vWhereFields.Add("config_name", CDBField.FieldTypes.cftCharacter, "trader_application_pom")
          vCount = mvEnv.Connection.GetCount("config", vWhereFields)
          If vCount = 0 Then
            vAppNumber = mvEnv.GetControlNumber("TA")
            AddFPApp(Format$(vAppNumber) & ",Purchase Order Maintenance,PORDE,N,N,N,N,N,N,N,N,N,Y,Y,Y,N,N,N,Y,Y,Y,Y,Y,Y,N,N,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,N,N,N,N,N,N,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,,N,,N,,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
            mvEnv.SetConfig("trader_application_pom", vAppNumber.ToString, True)
          End If
        Case NewTraderApp.ntaPostTaxPGPayments
          AddFPApp("8,Post Tax Payroll Giving Payments,POTPG,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,,,," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & "," & mvDefaultBankAccount & ",Y,Y,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,N,N,Y,N,N,N," & mvDefaultBankAccount & ",N,N,N,N,N,N,N,N,N,N,,N,N,N,N,N,N,N,N,C,N,N,N,N,N,N,N,N,N,Y,N,N")
      End Select
    End Sub

    Private Function BuildArrayFromList(ByRef pAttributeArray() As String, ByVal pAttributes As String) As Integer
      pAttributeArray = Split(pAttributes, ",")
      Return UBound(pAttributeArray) + 1
    End Function

    Private Sub ClearFPApplication(ByVal pApplication As String)
      Dim vApplicationCount As Long
      Dim vWhereFields As New CDBFields
      Dim vUpdateFields As New CDBFields
      Dim vReassignApplication As Long
      Dim vCount As Long

      vWhereFields.Add("fp_application", CDBField.FieldTypes.cftCharacter, pApplication)
      vWhereFields.Add("read_only", CDBField.FieldTypes.cftCharacter, "N")

      vApplicationCount = mvEnv.Connection.GetCount("fp_applications", vWhereFields)
      If vApplicationCount > 0 Then
        vWhereFields.Remove("read_only") 'as vWhereFields will be used for fp_controls table update
        vReassignApplication = mvEnv.GetControlNumber("TA")
        'Move fp_application
        vUpdateFields.Add("fp_application", CDBField.FieldTypes.cftCharacter, Format$(vReassignApplication))
        vUpdateFields.Add("amended_on", CDBField.FieldTypes.cftDate, TodaysDate)
        vUpdateFields.Add("amended_by", CDBField.FieldTypes.cftCharacter, If(String.IsNullOrWhiteSpace(mvEnv.User.Logname), "dbinit", mvEnv.User.Logname))
        vCount = mvEnv.Connection.UpdateRecords("fp_applications", vUpdateFields, vWhereFields, False)
        'Move fp_controls
        vUpdateFields.Remove("amended_on")
        vUpdateFields.Remove("amended_by")
        vCount = mvEnv.Connection.UpdateRecords("fp_controls", vUpdateFields, vWhereFields, False)
        'Move any Trader Menu configs
        vWhereFields.Clear()
        vWhereFields.Add("config_name", CDBField.FieldTypes.cftCharacter, "trader_applications_*", CDBField.FieldWhereOperators.fwoLike)
        vWhereFields.Add("config_value", CDBField.FieldTypes.cftCharacter, pApplication)
        vUpdateFields.Clear()
        vUpdateFields.Add("config_value", CDBField.FieldTypes.cftCharacter, Format$(vReassignApplication))
        vCount = mvEnv.Connection.UpdateRecords("config", vUpdateFields, vWhereFields, False)
        'Move any trader application configs
        vWhereFields.Remove("config_name")
        vWhereFields.Add("config_name", CDBField.FieldTypes.cftCharacter, "trader_application_*", CDBField.FieldWhereOperators.fwoLike)
        vCount = mvEnv.Connection.UpdateRecords("config", vUpdateFields, vWhereFields, False)
      End If
    End Sub

    Private Function GetFieldLength(ByVal pTable As String, ByVal pAttr As String) As Integer
      Return mvEnv.GetAttributeLength(pTable, pAttr)
    End Function

    Private Sub SetTraderVersionNumber(ByVal pOldVersionNumber As Integer, ByVal pNewVersionNumber As Integer)
      Dim vFields As New CDBFields(New CDBField("config_value", CDBField.FieldTypes.cftCharacter, pNewVersionNumber.ToString))
      Dim vUserID As String = mvEnv.User.UserID
      If String.IsNullOrWhiteSpace(vUserID) Then vUserID = "dbinit"
      vFields.AddAmendedOnBy(vUserID, TodaysDate)

      If pOldVersionNumber < 1 Then
        'Add the config
        vFields.Add("config_name", "fp_application_version")
        mvEnv.Connection.InsertRecord("config", vFields)
      ElseIf pOldVersionNumber.Equals(pNewVersionNumber) = False Then
        'Update the config
        Dim vWherefields As New CDBFields(New CDBField("config_name", "fp_application_version"))
        mvEnv.Connection.UpdateRecords("config", vFields, vWhereFields, False)
      End If
    End Sub

  End Class

End Namespace
