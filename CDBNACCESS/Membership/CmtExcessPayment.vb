Namespace Access

  Public Class CmtExcessPayment
    Inherits CARERecord

#Region "AutoGenerated Code"

'--------------------------------------------------
'Enum defining all the fields in the table
'--------------------------------------------------
    Private Enum CmtExcessPaymentFields
      AllFields = 0
      CmtExcessPayment
      CmtExcessPaymentDesc
      CmtExcessPaymentType
      AmendedBy
      AmendedOn
    End Enum

'--------------------------------------------------
'Required overrides for the class
'--------------------------------------------------
    Protected Overrides Sub AddFields()
      With mvClassFields
        .Add("cmt_excess_payment")
        .Add("cmt_excess_payment_desc")
        .Add("cmt_excess_payment_type")

        .Item(CmtExcessPaymentFields.CmtExcessPayment).PrimaryKey = True
        .Item(CmtExcessPaymentFields.CmtExcessPayment).PrefixRequired = True

      End With
    End Sub

    Protected Overrides ReadOnly Property SupportsAmendedOnAndBy() As Boolean
      Get
        Return True
      End Get
    End Property
    Protected Overrides ReadOnly Property TableAlias() As String
      Get
        Return "cep"
      End Get
    End Property
    Protected Overrides ReadOnly Property DatabaseTableName() As String
      Get
        Return "cmt_excess_payments"
      End Get
    End Property

'--------------------------------------------------
'Default constructor
'--------------------------------------------------
    Public Sub New(ByVal pEnv As CDBEnvironment)
      MyBase.New(pEnv)
    End Sub

'--------------------------------------------------
'Public property procedures
'--------------------------------------------------
    Public ReadOnly Property CmtExcessPaymentCode() As String
      Get
        Return mvClassFields(CmtExcessPaymentFields.CmtExcessPayment).Value
      End Get
    End Property
    Public ReadOnly Property CmtExcessPaymentDesc() As String
      Get
        Return mvClassFields(CmtExcessPaymentFields.CmtExcessPaymentDesc).Value
      End Get
    End Property
    Public ReadOnly Property CmtExcessPaymentTypeCode() As String
      Get
        Return mvClassFields(CmtExcessPaymentFields.CmtExcessPaymentType).Value
      End Get
    End Property
    Public ReadOnly Property AmendedBy() As String
      Get
        Return mvClassFields(CmtExcessPaymentFields.AmendedBy).Value
      End Get
    End Property
    Public ReadOnly Property AmendedOn() As String
      Get
        Return mvClassFields(CmtExcessPaymentFields.AmendedOn).Value
      End Get
    End Property
#End Region

#Region "Non AutoGenerated Code"

    Public Enum CMTExcessPaymentTypes
      CarryForward
      Refund
      Retain
      ReAnalyse
    End Enum

    Public ReadOnly Property CMTExcessPaymentType() As CMTExcessPaymentTypes
      Get
        Return GetCMTExcessPaymentType(CmtExcessPaymentTypeCode)
      End Get
    End Property

    Public Shared Function GetCMTExcessPaymentType(ByVal pCMTExcessPaymentTypeCode As String) As CMTExcessPaymentTypes
      Select Case pCMTExcessPaymentTypeCode
        Case "C"
          Return CMTExcessPaymentTypes.CarryForward
        Case "F"
          Return CMTExcessPaymentTypes.Refund
        Case "T"
          Return CMTExcessPaymentTypes.Retain
        Case Else
          Return CMTExcessPaymentTypes.ReAnalyse
      End Select
    End Function

#End Region

  End Class
End Namespace
