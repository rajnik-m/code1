Namespace Access

  Public Class OrganisationCategory
    Inherits ContactCategory

    '--------------------------------------------------
    'Required overrides for the class
    '--------------------------------------------------
    Protected Overrides Sub AddFields()
      mvClassFields.Add("organisation_category_number", CDBField.FieldTypes.cftInteger).PrimaryKey = True
      mvClassFields.Add("organisation_number", CDBField.FieldTypes.cftLong)
      MyBase.AddFields()
      mvClassFields.RemoveAt(2)   'Remove contact_category_number
      mvClassFields.RemoveAt(2)   'Remove contact_number
      mvClassFields.Item(ContactCategoryFields.ActivityValue).PrefixRequired = True
      mvClassFields.SetControlNumberField(ContactCategoryFields.ContactCategoryNumber, "CCG")
    End Sub

    Protected Overrides ReadOnly Property DatabaseTableName() As String
      Get
        Return "organisation_categories"
      End Get
    End Property

    '--------------------------------------------------
    'Default constructor
    '--------------------------------------------------
    Public Sub New(ByVal pEnv As CDBEnvironment)
      MyBase.New(pEnv)
    End Sub

    '--------------------------------------------------
    'Public property procedures
    '--------------------------------------------------

#Region "Non-AutoGenerated Code"
    Public Sub AmalgamateOrganisationCategory(ByVal pRecord As OrganisationCategory, ByVal pNewValidFrom As String, ByVal pNewValidTo As String)
      CopyValues(pRecord)
      With mvClassFields
        .Item(ContactCategoryFields.ValidFrom).Value = pNewValidFrom
        .Item(ContactCategoryFields.ValidTo).Value = pNewValidTo
      End With
    End Sub
#End Region
  End Class
End Namespace
