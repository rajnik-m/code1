Public Class CustomFinderControl
  Inherits CARERecord

#Region "AutoGenerated Code"

  '--------------------------------------------------
  'Enum defining all the fields in the table
  '--------------------------------------------------
  Private Enum CustomFinderControlFields
    AllFields = 0
    CustomFinder
    SequenceNumber
    AttributeName
    DataType
    ToCase
    Mandatory
    MaxLength
    ControlTop
    ControlLeft
    ControlWidth
    ControlHeight
    ControlCaption
    TableName
    AutomaticWildcards
    AllowUserWildcards
    AmendedBy
    AmendedOn
  End Enum

  Public Enum UserWildcardOptions
    None
    WildcardAtStart
    WildcardAtEnd
    WildcardAtStartAndEnd
  End Enum

  '--------------------------------------------------
  'Required overrides for the class
  '--------------------------------------------------
  Protected Overrides Sub AddFields()
    With mvClassFields
      .Add("custom_finder", CDBField.FieldTypes.cftInteger)
      .Add("sequence_number", CDBField.FieldTypes.cftInteger)
      .Add("attribute_name")
      .Add("data_type")
      .Add("case").SpecialColumn = True
      .Add("mandatory")
      .Add("max_length", CDBField.FieldTypes.cftInteger)
      .Add("control_top", CDBField.FieldTypes.cftInteger)
      .Add("control_left", CDBField.FieldTypes.cftInteger)
      .Add("control_width", CDBField.FieldTypes.cftInteger)
      .Add("control_height", CDBField.FieldTypes.cftInteger)
      .Add("control_caption")
      .Add("table_name")
      Dim vInDatabase As Boolean = mvEnv.GetDataStructureInfo(CDBEnvironment.cdbDataStructureConstants.cdbDataCustomFinderWildcards)
      .Add("automatic_wildcards").InDatabase = vInDatabase
      .Add("allow_user_wildcards").InDatabase = vInDatabase

      .Item(CustomFinderControlFields.CustomFinder).PrimaryKey = True
      .Item(CustomFinderControlFields.SequenceNumber).PrimaryKey = True

      For Each vClassField As ClassField In mvClassFields
        vClassField.PrefixRequired = True
      Next
    End With
  End Sub

  Protected Overrides ReadOnly Property SupportsAmendedOnAndBy() As Boolean
    Get
      Return True
    End Get
  End Property
  Protected Overrides ReadOnly Property TableAlias() As String
    Get
      Return "cfc"
    End Get
  End Property
  Protected Overrides ReadOnly Property DatabaseTableName() As String
    Get
      Return "custom_finder_controls"
    End Get
  End Property

  '--------------------------------------------------
  'Default constructor
  '--------------------------------------------------
  Public Sub New(ByVal pEnv As CDBEnvironment)
    MyBase.New(pEnv)
  End Sub

  '--------------------------------------------------
  'Public property procedures
  '--------------------------------------------------
  Public ReadOnly Property CustomFinder() As Integer
    Get
      Return mvClassFields(CustomFinderControlFields.CustomFinder).IntegerValue
    End Get
  End Property
  Public ReadOnly Property SequenceNumber() As Integer
    Get
      Return mvClassFields(CustomFinderControlFields.SequenceNumber).IntegerValue
    End Get
  End Property
  Public ReadOnly Property AttributeName() As String
    Get
      Return mvClassFields(CustomFinderControlFields.AttributeName).Value
    End Get
  End Property
  Public ReadOnly Property DataType() As String
    Get
      Return mvClassFields(CustomFinderControlFields.DataType).Value
    End Get
  End Property
  Public ReadOnly Property ToCase() As String
    Get
      Return mvClassFields(CustomFinderControlFields.ToCase).Value
    End Get
  End Property
  Public ReadOnly Property Mandatory() As String
    Get
      Return mvClassFields(CustomFinderControlFields.Mandatory).Value
    End Get
  End Property
  Public ReadOnly Property MaxLength() As Integer
    Get
      Return mvClassFields(CustomFinderControlFields.MaxLength).IntegerValue
    End Get
  End Property
  Public ReadOnly Property ControlTop() As Integer
    Get
      Return mvClassFields(CustomFinderControlFields.ControlTop).IntegerValue
    End Get
  End Property
  Public ReadOnly Property ControlLeft() As Integer
    Get
      Return mvClassFields(CustomFinderControlFields.ControlLeft).IntegerValue
    End Get
  End Property
  Public ReadOnly Property ControlWidth() As Integer
    Get
      Return mvClassFields(CustomFinderControlFields.ControlWidth).IntegerValue
    End Get
  End Property
  Public ReadOnly Property ControlHeight() As Integer
    Get
      Return mvClassFields(CustomFinderControlFields.ControlHeight).IntegerValue
    End Get
  End Property
  Public ReadOnly Property ControlCaption() As String
    Get
      Return mvClassFields(CustomFinderControlFields.ControlCaption).Value
    End Get
  End Property
  Public ReadOnly Property AmendedBy() As String
    Get
      Return mvClassFields(CustomFinderControlFields.AmendedBy).Value
    End Get
  End Property
  Public ReadOnly Property AmendedOn() As String
    Get
      Return mvClassFields(CustomFinderControlFields.AmendedOn).Value
    End Get
  End Property
  Public ReadOnly Property TableName() As String
    Get
      Return mvClassFields(CustomFinderControlFields.TableName).Value
    End Get
  End Property
  Public ReadOnly Property AutomaticWildcards() As UserWildcardOptions
    Get
      Select Case mvClassFields(CustomFinderControlFields.AutomaticWildcards).Value
        Case "S"
          Return UserWildcardOptions.WildcardAtStart
        Case "E"
          Return UserWildcardOptions.WildcardAtEnd
        Case "B"
          Return UserWildcardOptions.WildcardAtStartAndEnd
        Case Else
          Return UserWildcardOptions.None
      End Select
    End Get
  End Property
  Public ReadOnly Property AllowUserWildcards() As Boolean
    Get
      Return mvClassFields(CustomFinderControlFields.AllowUserWildcards).Bool
    End Get
  End Property

#End Region

#Region "Non AutoGenerated Code"

  Private mvParameterName As String = ""
  Private mvControlType As String = ""
  Private mvContactGroup As String = ""
  Private mvCustomFinderDesc As String = ""
  Private mvMaintenanceAttribute As MaintenanceAttribute
  Private mvTabNumber As Integer
  Private mvCaptionWidth As Integer

  Protected Overrides Sub ClearFields()
    MyBase.ClearFields()
    mvParameterName = ""
    mvControlType = ""
    mvContactGroup = ""
    mvCustomFinderDesc = ""
    mvMaintenanceAttribute = Nothing
    mvTabNumber = 0
    mvCaptionWidth = 0
  End Sub

  Public Property ParameterName() As String
    Get
      Return mvParameterName
    End Get
    Set(ByVal value As String)
      mvParameterName = value
    End Set
  End Property

  Public ReadOnly Property TabNumber() As Integer
    Get
      Return mvTabNumber
    End Get
  End Property

  Public ReadOnly Property CaptionWidth() As Integer
    Get
      Return mvCaptionWidth
    End Get
  End Property

  Public ReadOnly Property ContactGroupCode() As String
    Get
      Return mvContactGroup
    End Get
  End Property

  Public ReadOnly Property ControlType() As String
    Get
      Return mvControlType
    End Get
  End Property

  Public ReadOnly Property CustomFinderDesc() As String
    Get
      Return mvCustomFinderDesc
    End Get
  End Property

  Public ReadOnly Property MaintenanceAttribute() As MaintenanceAttribute
    Get
      Return mvMaintenanceAttribute
    End Get
  End Property

  Public Overrides Sub InitFromRecordSet(ByVal pRecordSet As Data.CDBRecordSet)
    MyBase.InitFromRecordSet(pRecordSet)
    Select Case Type
      Case CDBField.FieldTypes.cftDate, CDBField.FieldTypes.cftTime
        mvControlType = "dtp"
      Case Else
        mvControlType = "txt"
    End Select
    mvContactGroup = pRecordSet.Fields("contact_group").Value
    mvTabNumber = pRecordSet.Fields("tab_number").IntegerValue
    mvCustomFinderDesc = pRecordSet.Fields("custom_finder_desc").Value
    mvCaptionWidth = pRecordSet.Fields("tag_width").IntegerValue

    mvMaintenanceAttribute = New MaintenanceAttribute(mvEnv)
    mvMaintenanceAttribute.InitForAdditionalInfo(False)
    mvMaintenanceAttribute.InitFromRecordSet(pRecordSet)
  End Sub

  Public ReadOnly Property Type() As CDBField.FieldTypes
    Get
      Return CDBField.GetFieldType(mvClassFields(CustomFinderControlFields.DataType).Value)
    End Get
  End Property

#End Region

End Class
